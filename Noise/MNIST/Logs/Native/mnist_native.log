We are using Tensorflow version 1.15.2
Keras API version: 2.3.1
=====================Iteration========================== 1
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
Downloading data from https://s3.amazonaws.com/img-datasets/mnist.npz

    8192/11490434 [..............................] - ETA: 0s
   24576/11490434 [..............................] - ETA: 48s
   57344/11490434 [..............................] - ETA: 41s
   90112/11490434 [..............................] - ETA: 40s
  163840/11490434 [..............................] - ETA: 29s
  278528/11490434 [..............................] - ETA: 21s
  540672/11490434 [>.............................] - ETA: 12s
 1015808/11490434 [=>............................] - ETA: 7s 
 1982464/11490434 [====>.........................] - ETA: 4s
 2719744/11490434 [======>.......................] - ETA: 3s
 5718016/11490434 [=============>................] - ETA: 1s
 6438912/11490434 [===============>..............] - ETA: 1s
 7602176/11490434 [==================>...........] - ETA: 0s
 9601024/11490434 [========================>.....] - ETA: 0s
10944512/11490434 [===========================>..] - ETA: 0s
11493376/11490434 [==============================] - 2s 0us/step
in grads Tensor("loss/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3035 - accuracy: 0.0920
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2869 - accuracy: 0.1347
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2669 - accuracy: 0.1792
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2445 - accuracy: 0.2137
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2309 - accuracy: 0.2071
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.2290 - accuracy: 0.2165
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.1862 - accuracy: 0.2338
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1666 - accuracy: 0.2421
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1563 - accuracy: 0.2431
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1284 - accuracy: 0.2547
10000/10000 [==============================] - 1s 66us/step - loss: 2.1157 - accuracy: 0.2579 - val_loss: 2.0303 - val_accuracy: 0.3960
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 2.0343 - accuracy: 0.3840
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.8518 - accuracy: 0.3727
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.6803 - accuracy: 0.4380
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.8493 - accuracy: 0.3954
 4500/10000 [============>.................] - ETA: 0s - loss: 1.8288 - accuracy: 0.4144
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.7209 - accuracy: 0.4515
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.8104 - accuracy: 0.4374
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7506 - accuracy: 0.4564
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6896 - accuracy: 0.4729
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6200 - accuracy: 0.4942
10000/10000 [==============================] - 1s 59us/step - loss: 1.5935 - accuracy: 0.5012 - val_loss: 1.1243 - val_accuracy: 0.6556
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.9714 - accuracy: 0.6940
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.9108 - accuracy: 0.6933
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.9738 - accuracy: 0.6820
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.0433 - accuracy: 0.6591
 4500/10000 [============>.................] - ETA: 0s - loss: 1.1346 - accuracy: 0.6498
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.1054 - accuracy: 0.6573
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.0320 - accuracy: 0.6831
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9667 - accuracy: 0.7040
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9853 - accuracy: 0.6979
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9616 - accuracy: 0.7049
10000/10000 [==============================] - 1s 58us/step - loss: 0.9417 - accuracy: 0.7108 - val_loss: 0.5775 - val_accuracy: 0.8096
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.5470 - accuracy: 0.8240
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.5431 - accuracy: 0.8240
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.5193 - accuracy: 0.8292
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.5492 - accuracy: 0.8163
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5382 - accuracy: 0.8213
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.5000 - accuracy: 0.8333
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.4679 - accuracy: 0.8452
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4571 - accuracy: 0.8496
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5417 - accuracy: 0.8315
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5718 - accuracy: 0.8266
10000/10000 [==============================] - 1s 60us/step - loss: 0.5687 - accuracy: 0.8286 - val_loss: 0.5035 - val_accuracy: 0.8516
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.3356 - accuracy: 0.9040
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.3166 - accuracy: 0.9107
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.3047 - accuracy: 0.9116
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.3068 - accuracy: 0.9129
 4500/10000 [============>.................] - ETA: 0s - loss: 0.2981 - accuracy: 0.9138
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.3050 - accuracy: 0.9087
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.3019 - accuracy: 0.9085
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2981 - accuracy: 0.9099
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2873 - accuracy: 0.9128
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2784 - accuracy: 0.9155
10000/10000 [==============================] - 1s 59us/step - loss: 0.2783 - accuracy: 0.9157 - val_loss: 0.2731 - val_accuracy: 0.9188
Latency --- 3.203732967376709 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0 and present is 0.9157000184059143
Saved model to disk
=====================Iteration========================== 2
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_1/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3002 - accuracy: 0.0580
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2811 - accuracy: 0.1300
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2568 - accuracy: 0.1616
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2229 - accuracy: 0.2014
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2256 - accuracy: 0.1818
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.2231 - accuracy: 0.1964
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2048 - accuracy: 0.2235
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1973 - accuracy: 0.2232
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1693 - accuracy: 0.2342
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1441 - accuracy: 0.2488
10000/10000 [==============================] - 1s 64us/step - loss: 2.1299 - accuracy: 0.2531 - val_loss: 1.5540 - val_accuracy: 0.5116
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.5646 - accuracy: 0.5340
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.3387 - accuracy: 0.3433
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2755 - accuracy: 0.3080
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.1753 - accuracy: 0.3206
 4500/10000 [============>.................] - ETA: 0s - loss: 2.0495 - accuracy: 0.3516
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.0319 - accuracy: 0.3458
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.9913 - accuracy: 0.3535
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.0001 - accuracy: 0.3560
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9388 - accuracy: 0.3768
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8923 - accuracy: 0.3862
10000/10000 [==============================] - 1s 58us/step - loss: 1.8606 - accuracy: 0.3949 - val_loss: 1.1394 - val_accuracy: 0.6048
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.0673 - accuracy: 0.6180
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.0253 - accuracy: 0.6633
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.0505 - accuracy: 0.6652
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.1042 - accuracy: 0.6580
 4500/10000 [============>.................] - ETA: 0s - loss: 1.0311 - accuracy: 0.6818
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.0176 - accuracy: 0.6807
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.9816 - accuracy: 0.6932
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9335 - accuracy: 0.7076
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8902 - accuracy: 0.7198
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8609 - accuracy: 0.7278
10000/10000 [==============================] - 1s 58us/step - loss: 0.8752 - accuracy: 0.7237 - val_loss: 0.8143 - val_accuracy: 0.7240
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.7121 - accuracy: 0.7600
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.5627 - accuracy: 0.8287
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.5006 - accuracy: 0.8476
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.4864 - accuracy: 0.8500
 4500/10000 [============>.................] - ETA: 0s - loss: 0.4785 - accuracy: 0.8507
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.4533 - accuracy: 0.8598
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.4330 - accuracy: 0.8666
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4214 - accuracy: 0.8699
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4141 - accuracy: 0.8721
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4134 - accuracy: 0.8723
10000/10000 [==============================] - 1s 58us/step - loss: 0.4160 - accuracy: 0.8716 - val_loss: 0.5671 - val_accuracy: 0.8268
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.4786 - accuracy: 0.8580
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.3462 - accuracy: 0.8993
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.3160 - accuracy: 0.9060
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.3005 - accuracy: 0.9091
 4500/10000 [============>.................] - ETA: 0s - loss: 0.3040 - accuracy: 0.9076
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.3103 - accuracy: 0.9053
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.3056 - accuracy: 0.9065
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2928 - accuracy: 0.9103
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2852 - accuracy: 0.9121
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2778 - accuracy: 0.9148
10000/10000 [==============================] - 1s 58us/step - loss: 0.2730 - accuracy: 0.9165 - val_loss: 0.2868 - val_accuracy: 0.9076
Latency --- 3.1274986267089844 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9157000184059143 and present is 0.9164999723434448
Saved model to disk
=====================Iteration========================== 3
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_2/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3452 - accuracy: 0.0920
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.3089 - accuracy: 0.1020
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2877 - accuracy: 0.1500
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2637 - accuracy: 0.1823
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2346 - accuracy: 0.2051
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.2199 - accuracy: 0.2216
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2060 - accuracy: 0.2345
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1610 - accuracy: 0.2592
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1646 - accuracy: 0.2611
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1630 - accuracy: 0.2607
10000/10000 [==============================] - 1s 65us/step - loss: 2.1499 - accuracy: 0.2646 - val_loss: 1.7641 - val_accuracy: 0.4900
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.7055 - accuracy: 0.4960
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.5731 - accuracy: 0.5133
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.6207 - accuracy: 0.4896
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.5813 - accuracy: 0.4920
 4500/10000 [============>.................] - ETA: 0s - loss: 1.8689 - accuracy: 0.4491
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.8603 - accuracy: 0.4598
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.8421 - accuracy: 0.4652
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.0746 - accuracy: 0.4269
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0941 - accuracy: 0.4019
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0989 - accuracy: 0.3878
10000/10000 [==============================] - 1s 58us/step - loss: 2.0940 - accuracy: 0.3837 - val_loss: 1.9888 - val_accuracy: 0.2440
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.9234 - accuracy: 0.2880
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.9665 - accuracy: 0.2840
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.9943 - accuracy: 0.3052
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.9375 - accuracy: 0.3454
 4500/10000 [============>.................] - ETA: 0s - loss: 1.8649 - accuracy: 0.3818
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.8209 - accuracy: 0.4031
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.7932 - accuracy: 0.4114
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7566 - accuracy: 0.4307
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6758 - accuracy: 0.4585
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6246 - accuracy: 0.4733
10000/10000 [==============================] - 1s 57us/step - loss: 1.6136 - accuracy: 0.4749 - val_loss: 1.3133 - val_accuracy: 0.5284
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.1769 - accuracy: 0.5640
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.9954 - accuracy: 0.6573
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.0880 - accuracy: 0.6100
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.1298 - accuracy: 0.6254
 4500/10000 [============>.................] - ETA: 0s - loss: 1.0780 - accuracy: 0.6500
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.0389 - accuracy: 0.6609
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.9829 - accuracy: 0.6786
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9555 - accuracy: 0.6856
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9690 - accuracy: 0.6802
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9513 - accuracy: 0.6875
10000/10000 [==============================] - 1s 57us/step - loss: 0.9380 - accuracy: 0.6922 - val_loss: 0.6360 - val_accuracy: 0.8240
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.4754 - accuracy: 0.8760
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.4398 - accuracy: 0.8707
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.4468 - accuracy: 0.8696
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.5107 - accuracy: 0.8474
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5088 - accuracy: 0.8484
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.4833 - accuracy: 0.8571
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.4878 - accuracy: 0.8520
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.6381 - accuracy: 0.8059
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7441 - accuracy: 0.7715
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8121 - accuracy: 0.7453
10000/10000 [==============================] - 1s 57us/step - loss: 0.8150 - accuracy: 0.7444 - val_loss: 0.8445 - val_accuracy: 0.7032
Latency --- 3.1018335819244385 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 4
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_3/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3111 - accuracy: 0.0920
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2913 - accuracy: 0.1673
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2713 - accuracy: 0.2020
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2535 - accuracy: 0.2011
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2339 - accuracy: 0.1947
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.1986 - accuracy: 0.2173
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2399 - accuracy: 0.2138
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2175 - accuracy: 0.2412
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1630 - accuracy: 0.2687
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2137 - accuracy: 0.2727
10000/10000 [==============================] - 1s 64us/step - loss: 2.2002 - accuracy: 0.2807 - val_loss: 1.8349 - val_accuracy: 0.4264
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.7446 - accuracy: 0.4680
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.7574 - accuracy: 0.4033
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.7170 - accuracy: 0.3952
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.5896 - accuracy: 0.4540
 4500/10000 [============>.................] - ETA: 0s - loss: 1.5979 - accuracy: 0.4416
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.6082 - accuracy: 0.4336
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.5850 - accuracy: 0.4485
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.5834 - accuracy: 0.4385
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5446 - accuracy: 0.4607
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.4821 - accuracy: 0.4871
10000/10000 [==============================] - 1s 58us/step - loss: 1.4479 - accuracy: 0.5010 - val_loss: 0.9200 - val_accuracy: 0.7080
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.8164 - accuracy: 0.7460
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2597 - accuracy: 0.4587
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2159 - accuracy: 0.3920
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.1447 - accuracy: 0.3691
 4500/10000 [============>.................] - ETA: 0s - loss: 2.0416 - accuracy: 0.4022
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.9476 - accuracy: 0.4196
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.8674 - accuracy: 0.4462
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7692 - accuracy: 0.4748
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6765 - accuracy: 0.5006
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6480 - accuracy: 0.5047
10000/10000 [==============================] - 1s 58us/step - loss: 1.6253 - accuracy: 0.5091 - val_loss: 1.2621 - val_accuracy: 0.5868
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.2102 - accuracy: 0.6400
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.2685 - accuracy: 0.6073
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.1021 - accuracy: 0.6732
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.9725 - accuracy: 0.7131
 4500/10000 [============>.................] - ETA: 0s - loss: 0.8748 - accuracy: 0.7371
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.8572 - accuracy: 0.7411
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.8464 - accuracy: 0.7411
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.7950 - accuracy: 0.7596
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7443 - accuracy: 0.7751
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.7079 - accuracy: 0.7864
10000/10000 [==============================] - 1s 58us/step - loss: 0.6918 - accuracy: 0.7904 - val_loss: 0.7190 - val_accuracy: 0.7620
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.5650 - accuracy: 0.8080
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.7336 - accuracy: 0.7533
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.7133 - accuracy: 0.7648
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.6308 - accuracy: 0.7960
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5845 - accuracy: 0.8173
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.5599 - accuracy: 0.8255
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.5188 - accuracy: 0.8391
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4899 - accuracy: 0.8485
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4721 - accuracy: 0.8545
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4546 - accuracy: 0.8593
10000/10000 [==============================] - 1s 58us/step - loss: 0.4421 - accuracy: 0.8636 - val_loss: 0.3279 - val_accuracy: 0.9016
Latency --- 3.1555843353271484 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 5
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_4/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3164 - accuracy: 0.0940
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2903 - accuracy: 0.1247
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2623 - accuracy: 0.1540
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2387 - accuracy: 0.1703
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2297 - accuracy: 0.1778
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.1971 - accuracy: 0.2045
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.1609 - accuracy: 0.2246
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1688 - accuracy: 0.2236
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1541 - accuracy: 0.2328
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1117 - accuracy: 0.2591
10000/10000 [==============================] - 1s 64us/step - loss: 2.1101 - accuracy: 0.2550 - val_loss: 1.8263 - val_accuracy: 0.3892
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.8010 - accuracy: 0.3980
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.6537 - accuracy: 0.4647
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.6812 - accuracy: 0.4480
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.7622 - accuracy: 0.4466
 4500/10000 [============>.................] - ETA: 0s - loss: 1.6369 - accuracy: 0.4864
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.9396 - accuracy: 0.4431
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.9532 - accuracy: 0.4165
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.9094 - accuracy: 0.4233
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9033 - accuracy: 0.4218
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8617 - accuracy: 0.4414
10000/10000 [==============================] - 1s 58us/step - loss: 1.8336 - accuracy: 0.4502 - val_loss: 1.2424 - val_accuracy: 0.6160
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.1786 - accuracy: 0.6020
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.5609 - accuracy: 0.5453
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.3293 - accuracy: 0.6136
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.3646 - accuracy: 0.6026
 4500/10000 [============>.................] - ETA: 0s - loss: 1.2707 - accuracy: 0.6369
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.2376 - accuracy: 0.6455
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.2053 - accuracy: 0.6552
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.1433 - accuracy: 0.6736
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.0966 - accuracy: 0.6835
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0835 - accuracy: 0.6839
10000/10000 [==============================] - 1s 58us/step - loss: 1.0615 - accuracy: 0.6919 - val_loss: 0.6293 - val_accuracy: 0.8164
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.5017 - accuracy: 0.8460
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.5462 - accuracy: 0.8273
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.6646 - accuracy: 0.7920
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.6244 - accuracy: 0.8100
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5674 - accuracy: 0.8311
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.5350 - accuracy: 0.8395
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.5037 - accuracy: 0.8491
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4722 - accuracy: 0.8603
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4551 - accuracy: 0.8635
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4691 - accuracy: 0.8580
10000/10000 [==============================] - 1s 58us/step - loss: 0.4806 - accuracy: 0.8544 - val_loss: 0.7539 - val_accuracy: 0.7736
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.7571 - accuracy: 0.7660
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.5435 - accuracy: 0.8480
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.4513 - accuracy: 0.8720
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.3968 - accuracy: 0.8854
 4500/10000 [============>.................] - ETA: 0s - loss: 0.3735 - accuracy: 0.8902
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.3527 - accuracy: 0.8958
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.3364 - accuracy: 0.9011
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.3208 - accuracy: 0.9068
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3067 - accuracy: 0.9105
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2941 - accuracy: 0.9139
10000/10000 [==============================] - 1s 58us/step - loss: 0.2878 - accuracy: 0.9156 - val_loss: 0.2904 - val_accuracy: 0.9104
Latency --- 3.1525983810424805 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 6
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_5/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3176 - accuracy: 0.0820
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2953 - accuracy: 0.0933
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2745 - accuracy: 0.1436
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2551 - accuracy: 0.1623
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2577 - accuracy: 0.1587
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.2352 - accuracy: 0.1804
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2071 - accuracy: 0.2089
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2060 - accuracy: 0.2137
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2161 - accuracy: 0.2055
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2031 - accuracy: 0.2149
10000/10000 [==============================] - 1s 66us/step - loss: 2.1858 - accuracy: 0.2234 - val_loss: 1.7057 - val_accuracy: 0.4384
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.6218 - accuracy: 0.4780
 1500/10000 [===>..........................] - ETA: 0s - loss: 3.4118 - accuracy: 0.3453
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.9134 - accuracy: 0.3052
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.6547 - accuracy: 0.2969
 4500/10000 [============>.................] - ETA: 0s - loss: 2.4655 - accuracy: 0.3084
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.3210 - accuracy: 0.3267
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2168 - accuracy: 0.3434
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1166 - accuracy: 0.3680
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0437 - accuracy: 0.3893
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9750 - accuracy: 0.4101
10000/10000 [==============================] - 1s 57us/step - loss: 1.9431 - accuracy: 0.4213 - val_loss: 1.3260 - val_accuracy: 0.5756
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.2252 - accuracy: 0.5980
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.3568 - accuracy: 0.6167
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.4172 - accuracy: 0.5988
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.4091 - accuracy: 0.6157
 4500/10000 [============>.................] - ETA: 0s - loss: 1.3907 - accuracy: 0.6093
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.3417 - accuracy: 0.6269
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.3115 - accuracy: 0.6352
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.2604 - accuracy: 0.6513
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.2349 - accuracy: 0.6587
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.2222 - accuracy: 0.6599
10000/10000 [==============================] - 1s 57us/step - loss: 1.2248 - accuracy: 0.6583 - val_loss: 1.4344 - val_accuracy: 0.5996
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.3384 - accuracy: 0.6400
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.1300 - accuracy: 0.6933
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.0593 - accuracy: 0.7068
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.9801 - accuracy: 0.7257
 4500/10000 [============>.................] - ETA: 0s - loss: 0.8802 - accuracy: 0.7558
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.8527 - accuracy: 0.7580
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.9004 - accuracy: 0.7417
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.8735 - accuracy: 0.7508
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8450 - accuracy: 0.7593
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8320 - accuracy: 0.7626
10000/10000 [==============================] - 1s 57us/step - loss: 0.8205 - accuracy: 0.7657 - val_loss: 0.6814 - val_accuracy: 0.8032
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.6164 - accuracy: 0.8160
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.6450 - accuracy: 0.8000
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.5918 - accuracy: 0.8192
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.5785 - accuracy: 0.8240
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5292 - accuracy: 0.8402
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.4911 - accuracy: 0.8522
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.4800 - accuracy: 0.8572
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4875 - accuracy: 0.8544
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4826 - accuracy: 0.8554
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4684 - accuracy: 0.8607
10000/10000 [==============================] - 1s 57us/step - loss: 0.4612 - accuracy: 0.8632 - val_loss: 0.3720 - val_accuracy: 0.8880
Latency --- 3.21006178855896 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 7
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_6/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3355 - accuracy: 0.1040
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.3008 - accuracy: 0.1367
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2745 - accuracy: 0.1960
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2542 - accuracy: 0.2071
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2336 - accuracy: 0.2216
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.1877 - accuracy: 0.2355
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.1625 - accuracy: 0.2365
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1791 - accuracy: 0.2251
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1504 - accuracy: 0.2562
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0801 - accuracy: 0.2899
10000/10000 [==============================] - 1s 66us/step - loss: 2.1531 - accuracy: 0.2857 - val_loss: 2.1892 - val_accuracy: 0.2676
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 2.1623 - accuracy: 0.2780
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.0521 - accuracy: 0.2880
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.9770 - accuracy: 0.3016
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.8621 - accuracy: 0.3611
 4500/10000 [============>.................] - ETA: 0s - loss: 1.7917 - accuracy: 0.3933
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.7875 - accuracy: 0.3905
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.7001 - accuracy: 0.4289
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.6738 - accuracy: 0.4417
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6988 - accuracy: 0.4281
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7462 - accuracy: 0.4243
10000/10000 [==============================] - 1s 58us/step - loss: 1.7378 - accuracy: 0.4240 - val_loss: 1.4729 - val_accuracy: 0.4788
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.3957 - accuracy: 0.5040
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.2762 - accuracy: 0.5373
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.4141 - accuracy: 0.5132
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.3349 - accuracy: 0.5477
 4500/10000 [============>.................] - ETA: 0s - loss: 1.2894 - accuracy: 0.5653
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.4135 - accuracy: 0.5275
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.3869 - accuracy: 0.5455
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.2976 - accuracy: 0.5772
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.3275 - accuracy: 0.5713
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.3746 - accuracy: 0.5537
10000/10000 [==============================] - 1s 58us/step - loss: 1.3644 - accuracy: 0.5544 - val_loss: 1.0886 - val_accuracy: 0.5908
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.0461 - accuracy: 0.6080
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.9486 - accuracy: 0.6867
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.8417 - accuracy: 0.7384
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.7921 - accuracy: 0.7500
 4500/10000 [============>.................] - ETA: 0s - loss: 0.9073 - accuracy: 0.7298
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.8652 - accuracy: 0.7449
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.8051 - accuracy: 0.7626
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.7574 - accuracy: 0.7763
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7194 - accuracy: 0.7859
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.6940 - accuracy: 0.7932
10000/10000 [==============================] - 1s 58us/step - loss: 0.6757 - accuracy: 0.7986 - val_loss: 0.3945 - val_accuracy: 0.8900
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.3087 - accuracy: 0.9100
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.3204 - accuracy: 0.9067
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.3221 - accuracy: 0.9040
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.3030 - accuracy: 0.9057
 4500/10000 [============>.................] - ETA: 0s - loss: 0.2970 - accuracy: 0.9087
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.2868 - accuracy: 0.9113
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.2779 - accuracy: 0.9143
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2720 - accuracy: 0.9159
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2778 - accuracy: 0.9152
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2843 - accuracy: 0.9139
10000/10000 [==============================] - 1s 58us/step - loss: 0.2821 - accuracy: 0.9151 - val_loss: 0.2820 - val_accuracy: 0.9128
Latency --- 3.193714141845703 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 8
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_7/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3029 - accuracy: 0.1420
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2839 - accuracy: 0.1820
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2648 - accuracy: 0.2076
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2305 - accuracy: 0.2354
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2142 - accuracy: 0.2289
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.1874 - accuracy: 0.2351
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.1260 - accuracy: 0.2546
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1016 - accuracy: 0.2627
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1168 - accuracy: 0.2526
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0920 - accuracy: 0.2637
10000/10000 [==============================] - 1s 66us/step - loss: 2.0656 - accuracy: 0.2809 - val_loss: 1.4625 - val_accuracy: 0.5400
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.4726 - accuracy: 0.5480
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.7801 - accuracy: 0.4307
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.5967 - accuracy: 0.4968
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.6452 - accuracy: 0.4791
 4500/10000 [============>.................] - ETA: 0s - loss: 1.5581 - accuracy: 0.5196
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.4495 - accuracy: 0.5504
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.4741 - accuracy: 0.5483
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.4973 - accuracy: 0.5305
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.4559 - accuracy: 0.5444
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.4123 - accuracy: 0.5563
10000/10000 [==============================] - 1s 58us/step - loss: 1.3758 - accuracy: 0.5696 - val_loss: 0.6543 - val_accuracy: 0.8088
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.4947 - accuracy: 0.8560
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.5183 - accuracy: 0.8413
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.6203 - accuracy: 0.8024
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.6057 - accuracy: 0.8086
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5657 - accuracy: 0.8224
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.5666 - accuracy: 0.8195
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.5980 - accuracy: 0.8112
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.5752 - accuracy: 0.8217
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5483 - accuracy: 0.8304
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5255 - accuracy: 0.8376
10000/10000 [==============================] - 1s 58us/step - loss: 0.5135 - accuracy: 0.8417 - val_loss: 0.4550 - val_accuracy: 0.8568
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.3264 - accuracy: 0.9000
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.3485 - accuracy: 0.8953
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.3905 - accuracy: 0.8844
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.3774 - accuracy: 0.8880
 4500/10000 [============>.................] - ETA: 0s - loss: 0.3803 - accuracy: 0.8864
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.3752 - accuracy: 0.8847
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.3690 - accuracy: 0.8871
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.3533 - accuracy: 0.8929
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3388 - accuracy: 0.8973
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3284 - accuracy: 0.9007
10000/10000 [==============================] - 1s 58us/step - loss: 0.3232 - accuracy: 0.9018 - val_loss: 0.3139 - val_accuracy: 0.9064
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.2543 - accuracy: 0.9200
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.2336 - accuracy: 0.9267
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.2333 - accuracy: 0.9248
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.2695 - accuracy: 0.9134
 4500/10000 [============>.................] - ETA: 0s - loss: 0.3115 - accuracy: 0.9073
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.2934 - accuracy: 0.9129
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.2864 - accuracy: 0.9151
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2798 - accuracy: 0.9169
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2719 - accuracy: 0.9187
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2646 - accuracy: 0.9202
10000/10000 [==============================] - 1s 59us/step - loss: 0.2615 - accuracy: 0.9212 - val_loss: 0.2867 - val_accuracy: 0.9172
Latency --- 3.237826108932495 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9164999723434448 and present is 0.9211999773979187
Saved model to disk
=====================Iteration========================== 9
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_8/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3230 - accuracy: 0.0800
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.3012 - accuracy: 0.1100
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2876 - accuracy: 0.1136
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2708 - accuracy: 0.1680
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2488 - accuracy: 0.1953
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.2538 - accuracy: 0.1871
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2397 - accuracy: 0.2055
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2150 - accuracy: 0.2260
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2463 - accuracy: 0.2188
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2395 - accuracy: 0.2295
10000/10000 [==============================] - 1s 66us/step - loss: 2.2300 - accuracy: 0.2430 - val_loss: 1.9454 - val_accuracy: 0.3932
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.9167 - accuracy: 0.3980
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.8055 - accuracy: 0.4407
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.8809 - accuracy: 0.4072
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.9172 - accuracy: 0.3663
 4500/10000 [============>.................] - ETA: 0s - loss: 1.8297 - accuracy: 0.4071
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.7301 - accuracy: 0.4438
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.7855 - accuracy: 0.4278
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7947 - accuracy: 0.4233
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.7901 - accuracy: 0.4119
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7387 - accuracy: 0.4257
10000/10000 [==============================] - 1s 58us/step - loss: 1.7039 - accuracy: 0.4400 - val_loss: 1.0793 - val_accuracy: 0.6476
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.9141 - accuracy: 0.7400
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.0947 - accuracy: 0.6607
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.1905 - accuracy: 0.5888
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.1249 - accuracy: 0.6074
 4500/10000 [============>.................] - ETA: 0s - loss: 1.1007 - accuracy: 0.6289
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.0402 - accuracy: 0.6580
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.0547 - accuracy: 0.6598
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.0253 - accuracy: 0.6716
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9793 - accuracy: 0.6886
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9371 - accuracy: 0.7045
10000/10000 [==============================] - 1s 58us/step - loss: 0.9150 - accuracy: 0.7121 - val_loss: 0.7212 - val_accuracy: 0.7432
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.5030 - accuracy: 0.8140
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.4539 - accuracy: 0.8540
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.4393 - accuracy: 0.8612
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.4652 - accuracy: 0.8494
 4500/10000 [============>.................] - ETA: 0s - loss: 0.4808 - accuracy: 0.8442
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.4695 - accuracy: 0.8524
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.4470 - accuracy: 0.8595
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4347 - accuracy: 0.8640
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4324 - accuracy: 0.8645
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4314 - accuracy: 0.8638
10000/10000 [==============================] - 1s 58us/step - loss: 0.4320 - accuracy: 0.8636 - val_loss: 0.4966 - val_accuracy: 0.8500
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.4517 - accuracy: 0.8780
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.3506 - accuracy: 0.8960
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.3140 - accuracy: 0.9084
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.3130 - accuracy: 0.9069
 4500/10000 [============>.................] - ETA: 0s - loss: 0.3049 - accuracy: 0.9073
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.2898 - accuracy: 0.9129
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.2785 - accuracy: 0.9166
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2653 - accuracy: 0.9200
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2682 - accuracy: 0.9199
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2652 - accuracy: 0.9205
10000/10000 [==============================] - 1s 58us/step - loss: 0.2648 - accuracy: 0.9208 - val_loss: 0.3022 - val_accuracy: 0.9096
Latency --- 3.245654821395874 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 10
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_9/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 1s - loss: 2.3028 - accuracy: 0.1180
 1500/10000 [===>..........................] - ETA: 0s - loss: 2.2815 - accuracy: 0.1560
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.2557 - accuracy: 0.1928
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.2356 - accuracy: 0.2009
 4500/10000 [============>.................] - ETA: 0s - loss: 2.2598 - accuracy: 0.1869
 5500/10000 [===============>..............] - ETA: 0s - loss: 2.2537 - accuracy: 0.2091
 6500/10000 [==================>...........] - ETA: 0s - loss: 2.2269 - accuracy: 0.2365
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2066 - accuracy: 0.2409
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1721 - accuracy: 0.2539
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1909 - accuracy: 0.2598
10000/10000 [==============================] - 1s 67us/step - loss: 2.1898 - accuracy: 0.2592 - val_loss: 2.0561 - val_accuracy: 0.4028
Epoch 2/5

  500/10000 [>.............................] - ETA: 0s - loss: 2.0593 - accuracy: 0.4180
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.9397 - accuracy: 0.4660
 2500/10000 [======>.......................] - ETA: 0s - loss: 2.0757 - accuracy: 0.3784
 3500/10000 [=========>....................] - ETA: 0s - loss: 2.0561 - accuracy: 0.3589
 4500/10000 [============>.................] - ETA: 0s - loss: 2.0045 - accuracy: 0.3676
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.9500 - accuracy: 0.3862
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.9557 - accuracy: 0.3748
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.9165 - accuracy: 0.3833
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8428 - accuracy: 0.4104
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8109 - accuracy: 0.4283
10000/10000 [==============================] - 1s 58us/step - loss: 1.8260 - accuracy: 0.4178 - val_loss: 1.8613 - val_accuracy: 0.2484
Epoch 3/5

  500/10000 [>.............................] - ETA: 0s - loss: 1.8129 - accuracy: 0.2580
 1500/10000 [===>..........................] - ETA: 0s - loss: 1.8212 - accuracy: 0.3273
 2500/10000 [======>.......................] - ETA: 0s - loss: 1.6766 - accuracy: 0.3952
 3500/10000 [=========>....................] - ETA: 0s - loss: 1.6902 - accuracy: 0.3860
 4500/10000 [============>.................] - ETA: 0s - loss: 1.7417 - accuracy: 0.3840
 5500/10000 [===============>..............] - ETA: 0s - loss: 1.6337 - accuracy: 0.4385
 6500/10000 [==================>...........] - ETA: 0s - loss: 1.5159 - accuracy: 0.4814
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.4583 - accuracy: 0.5057
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.3882 - accuracy: 0.5296
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.3054 - accuracy: 0.5600
10000/10000 [==============================] - 1s 57us/step - loss: 1.2688 - accuracy: 0.5719 - val_loss: 0.6679 - val_accuracy: 0.7696
Epoch 4/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.5141 - accuracy: 0.8200
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.6117 - accuracy: 0.7913
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.5874 - accuracy: 0.7984
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.5414 - accuracy: 0.8206
 4500/10000 [============>.................] - ETA: 0s - loss: 0.6052 - accuracy: 0.7938
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.8253 - accuracy: 0.7456
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.9203 - accuracy: 0.7120
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9363 - accuracy: 0.7073
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9196 - accuracy: 0.7114
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8868 - accuracy: 0.7259
10000/10000 [==============================] - 1s 58us/step - loss: 0.8664 - accuracy: 0.7324 - val_loss: 0.6105 - val_accuracy: 0.8188
Epoch 5/5

  500/10000 [>.............................] - ETA: 0s - loss: 0.4450 - accuracy: 0.8820
 1500/10000 [===>..........................] - ETA: 0s - loss: 0.5373 - accuracy: 0.8347
 2500/10000 [======>.......................] - ETA: 0s - loss: 0.6370 - accuracy: 0.8140
 3500/10000 [=========>....................] - ETA: 0s - loss: 0.5681 - accuracy: 0.8371
 4500/10000 [============>.................] - ETA: 0s - loss: 0.5155 - accuracy: 0.8540
 5500/10000 [===============>..............] - ETA: 0s - loss: 0.4679 - accuracy: 0.8665
 6500/10000 [==================>...........] - ETA: 0s - loss: 0.4459 - accuracy: 0.8745
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4331 - accuracy: 0.8783
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4314 - accuracy: 0.8759
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4239 - accuracy: 0.8772
10000/10000 [==============================] - 1s 58us/step - loss: 0.4130 - accuracy: 0.8803 - val_loss: 0.3262 - val_accuracy: 0.9032
Latency --- 3.240764856338501 seconds ---
Trained with vanilla non-private SGD optimizer
