We are using Tensorflow version 1.15.2
Keras API version: 2.3.1
=====================Iteration========================== 1
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 12s - loss: 2.3337 - accuracy: 0.0580
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.3152 - accuracy: 0.0910 
 1500/10000 [===>..........................] - ETA: 6s - loss: 2.3020 - accuracy: 0.1247
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2918 - accuracy: 0.1490
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2806 - accuracy: 0.1604
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.2682 - accuracy: 0.1673
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2545 - accuracy: 0.1746
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.2423 - accuracy: 0.1810
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2397 - accuracy: 0.1747
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2289 - accuracy: 0.1768
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2078 - accuracy: 0.1898
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1934 - accuracy: 0.1973
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1946 - accuracy: 0.2034
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1893 - accuracy: 0.2080
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1720 - accuracy: 0.2213
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1481 - accuracy: 0.2295
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1468 - accuracy: 0.2275
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1328 - accuracy: 0.2379
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1063 - accuracy: 0.2495
10000/10000 [==============================] - 7s 657us/step - loss: 2.0776 - accuracy: 0.2633 - val_loss: 2.2530 - val_accuracy: 0.2396
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 2.1935 - accuracy: 0.2400
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.1345 - accuracy: 0.2190
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.0733 - accuracy: 0.2553
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.0071 - accuracy: 0.2865
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.9754 - accuracy: 0.3068
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9083 - accuracy: 0.3350
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.8523 - accuracy: 0.3460
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8513 - accuracy: 0.3470
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8385 - accuracy: 0.3636
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.7828 - accuracy: 0.3842
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7170 - accuracy: 0.4173
 6000/10000 [=================>............] - ETA: 2s - loss: 1.6727 - accuracy: 0.4297
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.7361 - accuracy: 0.4298
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.7591 - accuracy: 0.4146
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.7583 - accuracy: 0.4201
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.7446 - accuracy: 0.4250
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.7275 - accuracy: 0.4333
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.6835 - accuracy: 0.4501
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6367 - accuracy: 0.4632
10000/10000 [==============================] - 6s 618us/step - loss: 1.6156 - accuracy: 0.4703 - val_loss: 1.4858 - val_accuracy: 0.5860
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.4803 - accuracy: 0.6280
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.4449 - accuracy: 0.5690
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.3431 - accuracy: 0.5960
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.2227 - accuracy: 0.6375
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.1011 - accuracy: 0.6684
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.0133 - accuracy: 0.6987
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.9449 - accuracy: 0.7211
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.8975 - accuracy: 0.7355
 4500/10000 [============>.................] - ETA: 3s - loss: 0.8906 - accuracy: 0.7340
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.8708 - accuracy: 0.7376
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.8485 - accuracy: 0.7447
 6000/10000 [=================>............] - ETA: 2s - loss: 0.8179 - accuracy: 0.7548
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.7838 - accuracy: 0.7651
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.7563 - accuracy: 0.7724
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.7359 - accuracy: 0.7792
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.7202 - accuracy: 0.7834
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7143 - accuracy: 0.7862
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.7185 - accuracy: 0.7858
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.7094 - accuracy: 0.7884
10000/10000 [==============================] - 6s 623us/step - loss: 0.7088 - accuracy: 0.7895 - val_loss: 0.5986 - val_accuracy: 0.8152
Epoch 4/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.5317 - accuracy: 0.8300
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.4730 - accuracy: 0.8480
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.4145 - accuracy: 0.8700
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.3905 - accuracy: 0.8810
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3727 - accuracy: 0.8864
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3637 - accuracy: 0.8870
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.3478 - accuracy: 0.8926
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3410 - accuracy: 0.8942
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3355 - accuracy: 0.8951
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.3309 - accuracy: 0.8966
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3288 - accuracy: 0.8973
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3257 - accuracy: 0.8973
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3242 - accuracy: 0.8978
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3229 - accuracy: 0.8991
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3258 - accuracy: 0.8996
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3252 - accuracy: 0.8996
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3219 - accuracy: 0.9005
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3205 - accuracy: 0.9013
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3181 - accuracy: 0.9025
10000/10000 [==============================] - 6s 629us/step - loss: 0.3142 - accuracy: 0.9038 - val_loss: 0.3425 - val_accuracy: 0.8972
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.2450 - accuracy: 0.9120
 1000/10000 [==>...........................] - ETA: 5s - loss: 0.2778 - accuracy: 0.9080
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.3161 - accuracy: 0.8973
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.3598 - accuracy: 0.8870
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3795 - accuracy: 0.8780
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3648 - accuracy: 0.8847
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.3454 - accuracy: 0.8914
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3322 - accuracy: 0.8960
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3188 - accuracy: 0.9002
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.3041 - accuracy: 0.9054
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2920 - accuracy: 0.9091
 6000/10000 [=================>............] - ETA: 2s - loss: 0.2814 - accuracy: 0.9123
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.2775 - accuracy: 0.9143
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2766 - accuracy: 0.9140
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2801 - accuracy: 0.9132
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2832 - accuracy: 0.9129
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2790 - accuracy: 0.9145
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2771 - accuracy: 0.9144
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2740 - accuracy: 0.9163
10000/10000 [==============================] - 6s 626us/step - loss: 0.2698 - accuracy: 0.9177 - val_loss: 0.2645 - val_accuracy: 0.9160
Latency --- 32.3518967628479 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0 and present is 0.9176999926567078
Saved model to disk
=====================Iteration========================== 2
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_1/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 12s - loss: 2.3128 - accuracy: 0.1240
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.3008 - accuracy: 0.1410 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2924 - accuracy: 0.1740
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2832 - accuracy: 0.2020
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2755 - accuracy: 0.2208
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2675 - accuracy: 0.2243
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2577 - accuracy: 0.2391
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2455 - accuracy: 0.2410
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2313 - accuracy: 0.2596
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2217 - accuracy: 0.2578
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2246 - accuracy: 0.2516
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2231 - accuracy: 0.2397
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2148 - accuracy: 0.2486
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2020 - accuracy: 0.2583
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1844 - accuracy: 0.2731
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1781 - accuracy: 0.2710
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1676 - accuracy: 0.2735
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1495 - accuracy: 0.2828
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1500 - accuracy: 0.2818
10000/10000 [==============================] - 7s 658us/step - loss: 2.2178 - accuracy: 0.2734 - val_loss: 2.9060 - val_accuracy: 0.0876
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 2.8575 - accuracy: 0.1120
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.5771 - accuracy: 0.0980
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.4853 - accuracy: 0.0953
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.4380 - accuracy: 0.1025
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.4089 - accuracy: 0.1140
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.3895 - accuracy: 0.1217
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.3738 - accuracy: 0.1266
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.3619 - accuracy: 0.1330
 4500/10000 [============>.................] - ETA: 3s - loss: 2.3515 - accuracy: 0.1484
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.3425 - accuracy: 0.1552
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.3362 - accuracy: 0.1602
 6000/10000 [=================>............] - ETA: 2s - loss: 2.3301 - accuracy: 0.1578
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.3223 - accuracy: 0.1648
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.3142 - accuracy: 0.1724
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.3075 - accuracy: 0.1729
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2967 - accuracy: 0.1834
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2838 - accuracy: 0.1947
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2702 - accuracy: 0.1996
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.3009 - accuracy: 0.2004
10000/10000 [==============================] - 6s 607us/step - loss: 2.2979 - accuracy: 0.2024 - val_loss: 2.2031 - val_accuracy: 0.3172
Epoch 3/5

  500/10000 [>.............................] - ETA: 5s - loss: 2.1705 - accuracy: 0.3720
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.1438 - accuracy: 0.3460
 1500/10000 [===>..........................] - ETA: 4s - loss: 2.1144 - accuracy: 0.3553
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.0771 - accuracy: 0.3860
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.0644 - accuracy: 0.3652
 3000/10000 [========>.....................] - ETA: 3s - loss: 2.1154 - accuracy: 0.3520
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.1317 - accuracy: 0.3300
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.1261 - accuracy: 0.3298
 4500/10000 [============>.................] - ETA: 3s - loss: 2.1075 - accuracy: 0.3318
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.0781 - accuracy: 0.3426
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.0536 - accuracy: 0.3464
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0718 - accuracy: 0.3278
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.0571 - accuracy: 0.3231
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0209 - accuracy: 0.3330
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9782 - accuracy: 0.3463
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9418 - accuracy: 0.3582
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9587 - accuracy: 0.3604
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9794 - accuracy: 0.3466
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9879 - accuracy: 0.3377
10000/10000 [==============================] - 6s 597us/step - loss: 1.9919 - accuracy: 0.3397 - val_loss: 1.9237 - val_accuracy: 0.3988
Epoch 4/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.8773 - accuracy: 0.4180
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.8969 - accuracy: 0.4040
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.0480 - accuracy: 0.3200
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.0735 - accuracy: 0.3140
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.0624 - accuracy: 0.3360
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.0132 - accuracy: 0.3680
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.9440 - accuracy: 0.3960
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8664 - accuracy: 0.4250
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8725 - accuracy: 0.4327
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.9941 - accuracy: 0.4186
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.0115 - accuracy: 0.4085
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0155 - accuracy: 0.4063
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.0071 - accuracy: 0.4049
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9831 - accuracy: 0.4109
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9370 - accuracy: 0.4245
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.8906 - accuracy: 0.4363
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8372 - accuracy: 0.4512
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.8031 - accuracy: 0.4577
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8214 - accuracy: 0.4535
10000/10000 [==============================] - 6s 612us/step - loss: 1.8238 - accuracy: 0.4471 - val_loss: 1.5091 - val_accuracy: 0.5632
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.3995 - accuracy: 0.6040
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.2804 - accuracy: 0.6160
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.1938 - accuracy: 0.6453
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.1040 - accuracy: 0.6745
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.0357 - accuracy: 0.6984
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.9884 - accuracy: 0.7103
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.9507 - accuracy: 0.7189
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.9636 - accuracy: 0.7088
 4500/10000 [============>.................] - ETA: 3s - loss: 1.0613 - accuracy: 0.6789
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.1473 - accuracy: 0.6490
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.2088 - accuracy: 0.6235
 6000/10000 [=================>............] - ETA: 2s - loss: 1.2127 - accuracy: 0.6237
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.1898 - accuracy: 0.6282
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1607 - accuracy: 0.6381
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1393 - accuracy: 0.6448
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.1334 - accuracy: 0.6464
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.1309 - accuracy: 0.6454
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.1169 - accuracy: 0.6479
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0942 - accuracy: 0.6545
10000/10000 [==============================] - 6s 598us/step - loss: 1.0661 - accuracy: 0.6640 - val_loss: 0.6748 - val_accuracy: 0.7996
Latency --- 31.5736186504364 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 3
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_2/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 11s - loss: 2.3173 - accuracy: 0.0840
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.3066 - accuracy: 0.0980 
 1500/10000 [===>..........................] - ETA: 6s - loss: 2.2962 - accuracy: 0.1240
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2886 - accuracy: 0.1410
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2785 - accuracy: 0.1608
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.2715 - accuracy: 0.1773
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2672 - accuracy: 0.1817
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.2579 - accuracy: 0.1895
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2485 - accuracy: 0.2022
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2583 - accuracy: 0.2020
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2566 - accuracy: 0.1920
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2503 - accuracy: 0.2017
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2417 - accuracy: 0.2091
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2307 - accuracy: 0.2174
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2170 - accuracy: 0.2287
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2074 - accuracy: 0.2334
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1981 - accuracy: 0.2371
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2038 - accuracy: 0.2360
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2044 - accuracy: 0.2294
10000/10000 [==============================] - 7s 652us/step - loss: 2.2004 - accuracy: 0.2377 - val_loss: 1.9885 - val_accuracy: 0.5300
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 1.9461 - accuracy: 0.6040
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.7900 - accuracy: 0.6010
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.6855 - accuracy: 0.5900
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.6688 - accuracy: 0.5475
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.9615 - accuracy: 0.4752
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.0667 - accuracy: 0.4143
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.0866 - accuracy: 0.3917
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.0909 - accuracy: 0.3862
 4500/10000 [============>.................] - ETA: 3s - loss: 2.0775 - accuracy: 0.3980
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.0468 - accuracy: 0.4134
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.0028 - accuracy: 0.4296
 6000/10000 [=================>............] - ETA: 2s - loss: 1.9513 - accuracy: 0.4412
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.9317 - accuracy: 0.4388
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9439 - accuracy: 0.4184
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9405 - accuracy: 0.4119
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9387 - accuracy: 0.4038
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9466 - accuracy: 0.3927
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9332 - accuracy: 0.3931
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9044 - accuracy: 0.4002
10000/10000 [==============================] - 6s 608us/step - loss: 1.8722 - accuracy: 0.4112 - val_loss: 1.2913 - val_accuracy: 0.5816
Epoch 3/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.2143 - accuracy: 0.6100
 1000/10000 [==>...........................] - ETA: 4s - loss: 1.5306 - accuracy: 0.5070
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.5979 - accuracy: 0.4840
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.5066 - accuracy: 0.5180
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.4312 - accuracy: 0.5400
 3000/10000 [========>.....................] - ETA: 3s - loss: 1.3381 - accuracy: 0.5733
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.3062 - accuracy: 0.5843
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.3084 - accuracy: 0.5832
 4500/10000 [============>.................] - ETA: 3s - loss: 1.2692 - accuracy: 0.5947
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.2326 - accuracy: 0.6050
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.1923 - accuracy: 0.6162
 6000/10000 [=================>............] - ETA: 2s - loss: 1.1489 - accuracy: 0.6317
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.1140 - accuracy: 0.6417
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1084 - accuracy: 0.6406
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1097 - accuracy: 0.6375
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.1128 - accuracy: 0.6310
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.1034 - accuracy: 0.6329
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.0783 - accuracy: 0.6440
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0493 - accuracy: 0.6557
10000/10000 [==============================] - 6s 597us/step - loss: 1.0241 - accuracy: 0.6632 - val_loss: 0.7573 - val_accuracy: 0.7564
Epoch 4/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.6629 - accuracy: 0.8040
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.7065 - accuracy: 0.7620
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.6618 - accuracy: 0.7773
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.6009 - accuracy: 0.8075
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.5635 - accuracy: 0.8236
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.5445 - accuracy: 0.8280
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.5259 - accuracy: 0.8300
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.5108 - accuracy: 0.8322
 4500/10000 [============>.................] - ETA: 3s - loss: 0.5346 - accuracy: 0.8249
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.5550 - accuracy: 0.8158
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.5447 - accuracy: 0.8227
 6000/10000 [=================>............] - ETA: 2s - loss: 0.5269 - accuracy: 0.8285
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.5125 - accuracy: 0.8348
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4969 - accuracy: 0.8414
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.4890 - accuracy: 0.8445
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.4832 - accuracy: 0.8461
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4831 - accuracy: 0.8451
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4776 - accuracy: 0.8468
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4699 - accuracy: 0.8488
10000/10000 [==============================] - 6s 598us/step - loss: 0.4599 - accuracy: 0.8527 - val_loss: 0.3440 - val_accuracy: 0.8960
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.2420 - accuracy: 0.9360
 1000/10000 [==>...........................] - ETA: 5s - loss: 0.2531 - accuracy: 0.9260
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.2472 - accuracy: 0.9273
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.2542 - accuracy: 0.9250
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.2635 - accuracy: 0.9232
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.2977 - accuracy: 0.9133
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.3091 - accuracy: 0.9066
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3136 - accuracy: 0.9045
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3042 - accuracy: 0.9100
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.2947 - accuracy: 0.9130
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2849 - accuracy: 0.9160
 6000/10000 [=================>............] - ETA: 2s - loss: 0.2775 - accuracy: 0.9178
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.2727 - accuracy: 0.9197
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2674 - accuracy: 0.9209
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2676 - accuracy: 0.9212
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2640 - accuracy: 0.9222
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2626 - accuracy: 0.9231
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2582 - accuracy: 0.9242
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2563 - accuracy: 0.9246
10000/10000 [==============================] - 6s 599us/step - loss: 0.2552 - accuracy: 0.9248 - val_loss: 0.2840 - val_accuracy: 0.9152
Latency --- 31.509896993637085 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9176999926567078 and present is 0.9247999787330627
Saved model to disk
=====================Iteration========================== 4
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_3/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 13s - loss: 2.3092 - accuracy: 0.1380
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.3013 - accuracy: 0.1770 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2952 - accuracy: 0.1673
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2882 - accuracy: 0.1805
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2806 - accuracy: 0.1752
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2731 - accuracy: 0.2017
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2662 - accuracy: 0.1951
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2562 - accuracy: 0.2050
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2418 - accuracy: 0.2151
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2379 - accuracy: 0.2122
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2426 - accuracy: 0.2073
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2391 - accuracy: 0.2093
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2250 - accuracy: 0.2302
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2018 - accuracy: 0.2390
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1744 - accuracy: 0.2585
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2255 - accuracy: 0.2499
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.3119 - accuracy: 0.2408
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.3116 - accuracy: 0.2327
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.3114 - accuracy: 0.2252
10000/10000 [==============================] - 7s 676us/step - loss: 2.3108 - accuracy: 0.2193 - val_loss: 2.2982 - val_accuracy: 0.1056
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 2.3009 - accuracy: 0.1220
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.2977 - accuracy: 0.1170
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.2978 - accuracy: 0.1087
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.2952 - accuracy: 0.1165
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2919 - accuracy: 0.1292
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.2892 - accuracy: 0.1367
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2850 - accuracy: 0.1486
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.2795 - accuracy: 0.1605
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2727 - accuracy: 0.1736
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2610 - accuracy: 0.1960
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2468 - accuracy: 0.2180
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2290 - accuracy: 0.2242
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2358 - accuracy: 0.2177
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2358 - accuracy: 0.2171
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2286 - accuracy: 0.2228
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2172 - accuracy: 0.2284
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2019 - accuracy: 0.2367
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1887 - accuracy: 0.2399
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1819 - accuracy: 0.2369
10000/10000 [==============================] - 6s 635us/step - loss: 2.1698 - accuracy: 0.2478 - val_loss: 1.7177 - val_accuracy: 0.4140
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.5925 - accuracy: 0.4780
 1000/10000 [==>...........................] - ETA: 7s - loss: 1.5338 - accuracy: 0.4780
 1500/10000 [===>..........................] - ETA: 6s - loss: 1.5256 - accuracy: 0.4640
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.8444 - accuracy: 0.4100
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.8736 - accuracy: 0.3944
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.8691 - accuracy: 0.3833
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.8641 - accuracy: 0.3683
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8718 - accuracy: 0.3720
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8879 - accuracy: 0.3669
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.8655 - accuracy: 0.3646
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.8210 - accuracy: 0.3807
 6000/10000 [=================>............] - ETA: 2s - loss: 1.7702 - accuracy: 0.4018
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.7347 - accuracy: 0.4114
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.7219 - accuracy: 0.4169
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.6982 - accuracy: 0.4253
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.6646 - accuracy: 0.4369
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6182 - accuracy: 0.4559
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.5759 - accuracy: 0.4713
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5471 - accuracy: 0.4798
10000/10000 [==============================] - 6s 621us/step - loss: 1.5444 - accuracy: 0.4844 - val_loss: 3.1490 - val_accuracy: 0.2144
Epoch 4/5

  500/10000 [>.............................] - ETA: 7s - loss: 3.1508 - accuracy: 0.2200
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.4779 - accuracy: 0.3300
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.1892 - accuracy: 0.3673
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.9809 - accuracy: 0.4105
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.9985 - accuracy: 0.3756
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9982 - accuracy: 0.3650
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.9433 - accuracy: 0.3837
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8913 - accuracy: 0.3977
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8454 - accuracy: 0.4100
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.7933 - accuracy: 0.4226
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7403 - accuracy: 0.4358
 6000/10000 [=================>............] - ETA: 2s - loss: 1.6966 - accuracy: 0.4483
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.6668 - accuracy: 0.4545
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6476 - accuracy: 0.4586
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.6174 - accuracy: 0.4709
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.5830 - accuracy: 0.4794
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5466 - accuracy: 0.4920
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.5281 - accuracy: 0.4929
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5441 - accuracy: 0.4873
10000/10000 [==============================] - 6s 618us/step - loss: 1.5398 - accuracy: 0.4903 - val_loss: 1.2438 - val_accuracy: 0.6140
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.1863 - accuracy: 0.6400
 1000/10000 [==>...........................] - ETA: 7s - loss: 1.1434 - accuracy: 0.6480
 1500/10000 [===>..........................] - ETA: 6s - loss: 1.0711 - accuracy: 0.6700
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.0234 - accuracy: 0.6870
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.9985 - accuracy: 0.6892
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.0493 - accuracy: 0.6660
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.0714 - accuracy: 0.6623
 4000/10000 [===========>..................] - ETA: 4s - loss: 1.0606 - accuracy: 0.6690
 4500/10000 [============>.................] - ETA: 3s - loss: 1.0363 - accuracy: 0.6813
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.0108 - accuracy: 0.6924
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.9786 - accuracy: 0.7040
 6000/10000 [=================>............] - ETA: 2s - loss: 0.9493 - accuracy: 0.7147
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.9280 - accuracy: 0.7223
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.9108 - accuracy: 0.7283
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.9083 - accuracy: 0.7288
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.9066 - accuracy: 0.7283
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8867 - accuracy: 0.7359
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8685 - accuracy: 0.7428
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8567 - accuracy: 0.7456
10000/10000 [==============================] - 6s 639us/step - loss: 0.8431 - accuracy: 0.7497 - val_loss: 0.9097 - val_accuracy: 0.7240
Latency --- 33.08359146118164 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 5
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_4/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 13s - loss: 2.3145 - accuracy: 0.1040
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.3035 - accuracy: 0.0920 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2928 - accuracy: 0.1013
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2885 - accuracy: 0.1200
 2500/10000 [======>.......................] - ETA: 6s - loss: 2.2826 - accuracy: 0.1524
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2731 - accuracy: 0.1663
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2680 - accuracy: 0.1594
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2585 - accuracy: 0.1558
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2464 - accuracy: 0.1747
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2397 - accuracy: 0.1712
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2278 - accuracy: 0.1742
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2134 - accuracy: 0.1883
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1975 - accuracy: 0.2075
 7000/10000 [====================>.........] - ETA: 2s - loss: 2.1645 - accuracy: 0.2271
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1445 - accuracy: 0.2383
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2840 - accuracy: 0.2344
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2850 - accuracy: 0.2332
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2846 - accuracy: 0.2362
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2842 - accuracy: 0.2371
10000/10000 [==============================] - 7s 703us/step - loss: 2.2832 - accuracy: 0.2379 - val_loss: 2.2502 - val_accuracy: 0.2864
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 2.2455 - accuracy: 0.3160
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.2411 - accuracy: 0.2840
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.2234 - accuracy: 0.3100
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.2039 - accuracy: 0.2870
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.1872 - accuracy: 0.2924
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.1667 - accuracy: 0.2963
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.1610 - accuracy: 0.2826
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.1454 - accuracy: 0.2842
 4500/10000 [============>.................] - ETA: 3s - loss: 2.1268 - accuracy: 0.2847
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.0942 - accuracy: 0.2998
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.0722 - accuracy: 0.3002
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0569 - accuracy: 0.2993
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.0389 - accuracy: 0.3132
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9995 - accuracy: 0.3270
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9579 - accuracy: 0.3424
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9174 - accuracy: 0.3523
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9300 - accuracy: 0.3511
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9449 - accuracy: 0.3442
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9611 - accuracy: 0.3387
10000/10000 [==============================] - 6s 620us/step - loss: 1.9733 - accuracy: 0.3340 - val_loss: 2.1289 - val_accuracy: 0.3552
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 2.1476 - accuracy: 0.3200
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.0892 - accuracy: 0.3980
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.9914 - accuracy: 0.4133
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.8806 - accuracy: 0.4315
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.8247 - accuracy: 0.4324
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9602 - accuracy: 0.3997
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.9815 - accuracy: 0.3926
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.9756 - accuracy: 0.3965
 4500/10000 [============>.................] - ETA: 3s - loss: 1.9377 - accuracy: 0.4076
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.8821 - accuracy: 0.4252
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.8136 - accuracy: 0.4476
 6000/10000 [=================>............] - ETA: 2s - loss: 1.7643 - accuracy: 0.4553
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.8354 - accuracy: 0.4457
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.8448 - accuracy: 0.4376
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.8476 - accuracy: 0.4349
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.8416 - accuracy: 0.4344
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8227 - accuracy: 0.4366
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.7982 - accuracy: 0.4416
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7648 - accuracy: 0.4508
10000/10000 [==============================] - 6s 615us/step - loss: 1.7252 - accuracy: 0.4640 - val_loss: 1.0091 - val_accuracy: 0.7076
Epoch 4/5

  500/10000 [>.............................] - ETA: 6s - loss: 0.7516 - accuracy: 0.7680
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.7854 - accuracy: 0.7500
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.9307 - accuracy: 0.6987
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.1865 - accuracy: 0.6525
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.2961 - accuracy: 0.6156
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.3111 - accuracy: 0.6050
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.2860 - accuracy: 0.5991
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.2448 - accuracy: 0.6083
 4500/10000 [============>.................] - ETA: 3s - loss: 1.2138 - accuracy: 0.6144
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.1963 - accuracy: 0.6206
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.1938 - accuracy: 0.6185
 6000/10000 [=================>............] - ETA: 2s - loss: 1.1816 - accuracy: 0.6183
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.1517 - accuracy: 0.6332
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1126 - accuracy: 0.6484
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.0793 - accuracy: 0.6611
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.0442 - accuracy: 0.6725
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.0179 - accuracy: 0.6814
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.9903 - accuracy: 0.6908
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9662 - accuracy: 0.6994
10000/10000 [==============================] - 6s 615us/step - loss: 0.9476 - accuracy: 0.7042 - val_loss: 0.9047 - val_accuracy: 0.7400
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.8419 - accuracy: 0.7560
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.8150 - accuracy: 0.7630
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.7202 - accuracy: 0.7927
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.6560 - accuracy: 0.8140
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.6162 - accuracy: 0.8228
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.5763 - accuracy: 0.8353
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.5562 - accuracy: 0.8409
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.5581 - accuracy: 0.8367
 4500/10000 [============>.................] - ETA: 3s - loss: 0.5605 - accuracy: 0.8344
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.5869 - accuracy: 0.8278
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.5845 - accuracy: 0.8265
 6000/10000 [=================>............] - ETA: 2s - loss: 0.5680 - accuracy: 0.8325
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.5498 - accuracy: 0.8386
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5354 - accuracy: 0.8424
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.5226 - accuracy: 0.8469
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5157 - accuracy: 0.8485
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5032 - accuracy: 0.8521
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4938 - accuracy: 0.8542
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4880 - accuracy: 0.8563
10000/10000 [==============================] - 6s 617us/step - loss: 0.4813 - accuracy: 0.8582 - val_loss: 0.4341 - val_accuracy: 0.8724
Latency --- 32.91840648651123 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 6
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_5/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3050 - accuracy: 0.1260
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.2980 - accuracy: 0.1270 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2918 - accuracy: 0.1233
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2839 - accuracy: 0.1350
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2733 - accuracy: 0.1556
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2614 - accuracy: 0.1610
 3500/10000 [=========>....................] - ETA: 5s - loss: 2.2462 - accuracy: 0.1960
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2288 - accuracy: 0.2208
 4500/10000 [============>.................] - ETA: 4s - loss: 2.2088 - accuracy: 0.2404
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2017 - accuracy: 0.2358
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2069 - accuracy: 0.2307
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2033 - accuracy: 0.2297
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1893 - accuracy: 0.2420
 7000/10000 [====================>.........] - ETA: 2s - loss: 2.1621 - accuracy: 0.2566
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1561 - accuracy: 0.2531
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1942 - accuracy: 0.2446
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2043 - accuracy: 0.2407
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2077 - accuracy: 0.2337
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2091 - accuracy: 0.2312
10000/10000 [==============================] - 7s 709us/step - loss: 2.2083 - accuracy: 0.2311 - val_loss: 2.1232 - val_accuracy: 0.2992
Epoch 2/5

  500/10000 [>.............................] - ETA: 8s - loss: 2.1424 - accuracy: 0.2620
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.0828 - accuracy: 0.3180
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.0186 - accuracy: 0.3447
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.9276 - accuracy: 0.3995
 2500/10000 [======>.......................] - ETA: 5s - loss: 1.8368 - accuracy: 0.4272
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9867 - accuracy: 0.4110
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.0121 - accuracy: 0.3891
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.0072 - accuracy: 0.4038
 4500/10000 [============>.................] - ETA: 3s - loss: 1.9736 - accuracy: 0.4171
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.9108 - accuracy: 0.4452
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.8445 - accuracy: 0.4682
 6000/10000 [=================>............] - ETA: 2s - loss: 1.8847 - accuracy: 0.4530
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.8814 - accuracy: 0.4378
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.8584 - accuracy: 0.4421
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.8172 - accuracy: 0.4505
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.8140 - accuracy: 0.4564
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8293 - accuracy: 0.4505
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.8266 - accuracy: 0.4422
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8034 - accuracy: 0.4525
10000/10000 [==============================] - 6s 642us/step - loss: 1.7628 - accuracy: 0.4686 - val_loss: 0.9269 - val_accuracy: 0.7184
Epoch 3/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.8773 - accuracy: 0.7320
 1000/10000 [==>...........................] - ETA: 7s - loss: 0.9393 - accuracy: 0.7000
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.9420 - accuracy: 0.7020
 2000/10000 [=====>........................] - ETA: 6s - loss: 0.9117 - accuracy: 0.7105
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.8384 - accuracy: 0.7384
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.7760 - accuracy: 0.7577
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.7443 - accuracy: 0.7663
 4000/10000 [===========>..................] - ETA: 4s - loss: 0.7917 - accuracy: 0.7487
 4500/10000 [============>.................] - ETA: 3s - loss: 0.8847 - accuracy: 0.7187
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.0164 - accuracy: 0.6882
 5500/10000 [===============>..............] - ETA: 3s - loss: 1.1456 - accuracy: 0.6545
 6000/10000 [=================>............] - ETA: 2s - loss: 1.1886 - accuracy: 0.6428
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.2038 - accuracy: 0.6414
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1965 - accuracy: 0.6459
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1817 - accuracy: 0.6508
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.1650 - accuracy: 0.6553
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.1516 - accuracy: 0.6573
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.1575 - accuracy: 0.6532
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.1372 - accuracy: 0.6602
10000/10000 [==============================] - 7s 662us/step - loss: 1.1104 - accuracy: 0.6687 - val_loss: 0.5796 - val_accuracy: 0.8136
Epoch 4/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.5615 - accuracy: 0.8300
 1000/10000 [==>...........................] - ETA: 7s - loss: 0.5571 - accuracy: 0.8350
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.5742 - accuracy: 0.8187
 2000/10000 [=====>........................] - ETA: 6s - loss: 0.5762 - accuracy: 0.8180
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.5381 - accuracy: 0.8344
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.5144 - accuracy: 0.8440
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.4865 - accuracy: 0.8520
 4000/10000 [===========>..................] - ETA: 4s - loss: 0.4699 - accuracy: 0.8562
 4500/10000 [============>.................] - ETA: 3s - loss: 0.4706 - accuracy: 0.8549
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.4747 - accuracy: 0.8534
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4847 - accuracy: 0.8478
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4801 - accuracy: 0.8488
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.4676 - accuracy: 0.8537
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4536 - accuracy: 0.8584
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.4395 - accuracy: 0.8629
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.4291 - accuracy: 0.8666
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4171 - accuracy: 0.8707
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4090 - accuracy: 0.8737
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3980 - accuracy: 0.8774
10000/10000 [==============================] - 6s 648us/step - loss: 0.3894 - accuracy: 0.8800 - val_loss: 0.3226 - val_accuracy: 0.8984
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.2930 - accuracy: 0.9020
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.2715 - accuracy: 0.9150
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.2610 - accuracy: 0.9180
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.2633 - accuracy: 0.9195
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.2560 - accuracy: 0.9216
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.2481 - accuracy: 0.9250
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.2393 - accuracy: 0.9271
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.2321 - accuracy: 0.9285
 4500/10000 [============>.................] - ETA: 3s - loss: 0.2291 - accuracy: 0.9298
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.2246 - accuracy: 0.9310
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2226 - accuracy: 0.9318
 6000/10000 [=================>............] - ETA: 2s - loss: 0.2184 - accuracy: 0.9327
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.2150 - accuracy: 0.9332
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2150 - accuracy: 0.9334
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2143 - accuracy: 0.9333
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2103 - accuracy: 0.9342
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2133 - accuracy: 0.9336
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2146 - accuracy: 0.9331
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2141 - accuracy: 0.9338
10000/10000 [==============================] - 6s 630us/step - loss: 0.2115 - accuracy: 0.9348 - val_loss: 0.2278 - val_accuracy: 0.9316
Latency --- 34.24798536300659 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9247999787330627 and present is 0.9348000288009644
Saved model to disk
=====================Iteration========================== 7
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_6/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 15s - loss: 2.3076 - accuracy: 0.1400
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.3020 - accuracy: 0.1430 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2937 - accuracy: 0.1973
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2850 - accuracy: 0.2100
 2500/10000 [======>.......................] - ETA: 6s - loss: 2.2764 - accuracy: 0.2264
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2624 - accuracy: 0.2467
 3500/10000 [=========>....................] - ETA: 5s - loss: 2.2486 - accuracy: 0.2617
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2506 - accuracy: 0.2612
 4500/10000 [============>.................] - ETA: 4s - loss: 2.2618 - accuracy: 0.2518
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2568 - accuracy: 0.2496
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2460 - accuracy: 0.2607
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2282 - accuracy: 0.2717
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2027 - accuracy: 0.2855
 7000/10000 [====================>.........] - ETA: 2s - loss: 2.1805 - accuracy: 0.2839
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1906 - accuracy: 0.2805
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1875 - accuracy: 0.2736
 8500/10000 [========================>.....] - ETA: 1s - loss: 2.1728 - accuracy: 0.2853
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1509 - accuracy: 0.2871
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1312 - accuracy: 0.2934
10000/10000 [==============================] - 7s 726us/step - loss: 2.1014 - accuracy: 0.3068 - val_loss: 1.9942 - val_accuracy: 0.3364
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 1.9562 - accuracy: 0.3420
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.2258 - accuracy: 0.3020
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.2257 - accuracy: 0.2793
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.1867 - accuracy: 0.3195
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.1339 - accuracy: 0.3408
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.0769 - accuracy: 0.3793
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.0117 - accuracy: 0.4020
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.9762 - accuracy: 0.3977
 4500/10000 [============>.................] - ETA: 3s - loss: 2.0804 - accuracy: 0.3911
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.0954 - accuracy: 0.3830
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.0990 - accuracy: 0.3789
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0912 - accuracy: 0.3740
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.0759 - accuracy: 0.3742
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0494 - accuracy: 0.3873
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.0185 - accuracy: 0.3872
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.0512 - accuracy: 0.3771
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0478 - accuracy: 0.3736
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0313 - accuracy: 0.3750
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0060 - accuracy: 0.3827
10000/10000 [==============================] - 6s 612us/step - loss: 1.9669 - accuracy: 0.3944 - val_loss: 1.1697 - val_accuracy: 0.6404
Epoch 3/5

  500/10000 [>.............................] - ETA: 6s - loss: 1.0965 - accuracy: 0.6580
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.0752 - accuracy: 0.6570
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.2134 - accuracy: 0.5887
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.4076 - accuracy: 0.5380
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.4928 - accuracy: 0.4904
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.5207 - accuracy: 0.4823
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.5191 - accuracy: 0.4914
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.4893 - accuracy: 0.5063
 4500/10000 [============>.................] - ETA: 3s - loss: 1.4367 - accuracy: 0.5287
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.3764 - accuracy: 0.5514
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.3171 - accuracy: 0.5725
 6000/10000 [=================>............] - ETA: 2s - loss: 1.2689 - accuracy: 0.5888
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.2864 - accuracy: 0.5852
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.3117 - accuracy: 0.5793
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.3213 - accuracy: 0.5751
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.3130 - accuracy: 0.5764
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.2933 - accuracy: 0.5852
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.2596 - accuracy: 0.5981
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.2233 - accuracy: 0.6109
10000/10000 [==============================] - 6s 620us/step - loss: 1.1908 - accuracy: 0.6209 - val_loss: 0.6457 - val_accuracy: 0.8004
Epoch 4/5

  500/10000 [>.............................] - ETA: 6s - loss: 0.5148 - accuracy: 0.8340
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.5284 - accuracy: 0.8330
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.5355 - accuracy: 0.8247
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.5832 - accuracy: 0.8105
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.6420 - accuracy: 0.7868
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.6771 - accuracy: 0.7707
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.6575 - accuracy: 0.7820
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.6298 - accuracy: 0.7930
 4500/10000 [============>.................] - ETA: 3s - loss: 0.6036 - accuracy: 0.8049
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.5901 - accuracy: 0.8112
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.5765 - accuracy: 0.8164
 6000/10000 [=================>............] - ETA: 2s - loss: 0.5574 - accuracy: 0.8230
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.5445 - accuracy: 0.8286
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5269 - accuracy: 0.8341
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.5116 - accuracy: 0.8387
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5018 - accuracy: 0.8411
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5039 - accuracy: 0.8401
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5055 - accuracy: 0.8382
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4983 - accuracy: 0.8406
10000/10000 [==============================] - 6s 619us/step - loss: 0.4881 - accuracy: 0.8447 - val_loss: 0.4150 - val_accuracy: 0.8780
Epoch 5/5

  500/10000 [>.............................] - ETA: 6s - loss: 0.2347 - accuracy: 0.9260
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.2723 - accuracy: 0.9180
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.2746 - accuracy: 0.9140
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.2860 - accuracy: 0.9160
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.2890 - accuracy: 0.9172
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.2855 - accuracy: 0.9193
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.2851 - accuracy: 0.9200
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.2870 - accuracy: 0.9185
 4500/10000 [============>.................] - ETA: 3s - loss: 0.2875 - accuracy: 0.9176
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.2889 - accuracy: 0.9152
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2894 - accuracy: 0.9156
 6000/10000 [=================>............] - ETA: 2s - loss: 0.2951 - accuracy: 0.9143
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.2925 - accuracy: 0.9149
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2883 - accuracy: 0.9160
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2857 - accuracy: 0.9169
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2829 - accuracy: 0.9183
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2860 - accuracy: 0.9169
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2870 - accuracy: 0.9161
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2888 - accuracy: 0.9152
10000/10000 [==============================] - 6s 621us/step - loss: 0.2904 - accuracy: 0.9145 - val_loss: 0.4689 - val_accuracy: 0.8528
Latency --- 34.99829292297363 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 8
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_7/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 15s - loss: 2.3053 - accuracy: 0.0900
 1000/10000 [==>...........................] - ETA: 10s - loss: 2.2928 - accuracy: 0.1050
 1500/10000 [===>..........................] - ETA: 8s - loss: 2.2825 - accuracy: 0.1393 
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2775 - accuracy: 0.1310
 2500/10000 [======>.......................] - ETA: 6s - loss: 2.2728 - accuracy: 0.1388
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2670 - accuracy: 0.1557
 3500/10000 [=========>....................] - ETA: 5s - loss: 2.2584 - accuracy: 0.1737
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2473 - accuracy: 0.2025
 4500/10000 [============>.................] - ETA: 4s - loss: 2.2440 - accuracy: 0.1887
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2442 - accuracy: 0.1838
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2372 - accuracy: 0.1922
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2244 - accuracy: 0.2148
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2012 - accuracy: 0.2443
 7000/10000 [====================>.........] - ETA: 2s - loss: 2.1792 - accuracy: 0.2567
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2382 - accuracy: 0.2473
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2482 - accuracy: 0.2416
 8500/10000 [========================>.....] - ETA: 1s - loss: 2.2501 - accuracy: 0.2354
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2498 - accuracy: 0.2361
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2479 - accuracy: 0.2363
10000/10000 [==============================] - 7s 733us/step - loss: 2.2444 - accuracy: 0.2406 - val_loss: 2.1236 - val_accuracy: 0.4148
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 2.1011 - accuracy: 0.4380
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.0587 - accuracy: 0.4040
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.0233 - accuracy: 0.4100
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.0098 - accuracy: 0.3820
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.0739 - accuracy: 0.3420
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.0937 - accuracy: 0.3330
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.0939 - accuracy: 0.3449
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.0754 - accuracy: 0.3573
 4500/10000 [============>.................] - ETA: 3s - loss: 2.0358 - accuracy: 0.3733
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.9874 - accuracy: 0.3872
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.9523 - accuracy: 0.3900
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0160 - accuracy: 0.3770
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.0264 - accuracy: 0.3692
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0198 - accuracy: 0.3759
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9969 - accuracy: 0.3844
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9601 - accuracy: 0.4014
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9233 - accuracy: 0.4104
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9129 - accuracy: 0.4142
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9108 - accuracy: 0.4124
10000/10000 [==============================] - 6s 614us/step - loss: 1.8941 - accuracy: 0.4178 - val_loss: 1.1980 - val_accuracy: 0.6036
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.1674 - accuracy: 0.6060
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.1726 - accuracy: 0.6030
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.1352 - accuracy: 0.6220
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.0730 - accuracy: 0.6490
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.0052 - accuracy: 0.6764
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.9870 - accuracy: 0.6790
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.0241 - accuracy: 0.6723
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.0378 - accuracy: 0.6662
 4500/10000 [============>.................] - ETA: 3s - loss: 1.0084 - accuracy: 0.6776
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.9972 - accuracy: 0.6796
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.9933 - accuracy: 0.6831
 6000/10000 [=================>............] - ETA: 2s - loss: 0.9753 - accuracy: 0.6902
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.9516 - accuracy: 0.6948
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.9397 - accuracy: 0.6976
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.9410 - accuracy: 0.6953
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.9417 - accuracy: 0.6929
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9269 - accuracy: 0.6981
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.9109 - accuracy: 0.7028
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8928 - accuracy: 0.7095
10000/10000 [==============================] - 6s 625us/step - loss: 0.8764 - accuracy: 0.7150 - val_loss: 0.7026 - val_accuracy: 0.7696
Epoch 4/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.5323 - accuracy: 0.8380
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.4689 - accuracy: 0.8630
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.4636 - accuracy: 0.8620
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.4432 - accuracy: 0.8630
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.4322 - accuracy: 0.8652
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.4461 - accuracy: 0.8640
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.4510 - accuracy: 0.8623
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.4723 - accuracy: 0.8537
 4500/10000 [============>.................] - ETA: 3s - loss: 0.4784 - accuracy: 0.8496
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.4927 - accuracy: 0.8446
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.5004 - accuracy: 0.8415
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4925 - accuracy: 0.8445
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.4793 - accuracy: 0.8497
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4659 - accuracy: 0.8536
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.4604 - accuracy: 0.8560
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.4534 - accuracy: 0.8584
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4526 - accuracy: 0.8587
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4497 - accuracy: 0.8597
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4625 - accuracy: 0.8546
10000/10000 [==============================] - 6s 629us/step - loss: 0.4695 - accuracy: 0.8526 - val_loss: 0.5185 - val_accuracy: 0.8492
Epoch 5/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.4745 - accuracy: 0.8620
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.4137 - accuracy: 0.8780
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.3699 - accuracy: 0.8900
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.3531 - accuracy: 0.8930
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3405 - accuracy: 0.8988
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3242 - accuracy: 0.9053
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.3159 - accuracy: 0.9066
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3218 - accuracy: 0.9055
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3189 - accuracy: 0.9049
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.3119 - accuracy: 0.9072
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3128 - accuracy: 0.9060
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3176 - accuracy: 0.9048
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3358 - accuracy: 0.8982
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3312 - accuracy: 0.9000
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3277 - accuracy: 0.9023
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3229 - accuracy: 0.9032
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3173 - accuracy: 0.9049
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3169 - accuracy: 0.9051
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3123 - accuracy: 0.9060
10000/10000 [==============================] - 6s 629us/step - loss: 0.3071 - accuracy: 0.9066 - val_loss: 0.3151 - val_accuracy: 0.9032
Latency --- 33.92681002616882 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 9
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_8/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3023 - accuracy: 0.1040
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.2879 - accuracy: 0.1570 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2771 - accuracy: 0.1707
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2641 - accuracy: 0.1770
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2508 - accuracy: 0.1784
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2385 - accuracy: 0.1853
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2220 - accuracy: 0.2074
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2037 - accuracy: 0.2030
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2122 - accuracy: 0.1980
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2127 - accuracy: 0.2002
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2019 - accuracy: 0.2167
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1836 - accuracy: 0.2255
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1855 - accuracy: 0.2168
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1778 - accuracy: 0.2320
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1664 - accuracy: 0.2463
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1387 - accuracy: 0.2592
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1083 - accuracy: 0.2746
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1169 - accuracy: 0.2778
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1794 - accuracy: 0.2718
10000/10000 [==============================] - 7s 703us/step - loss: 2.1833 - accuracy: 0.2673 - val_loss: 2.2637 - val_accuracy: 0.1132
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 2.2305 - accuracy: 0.1280
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.2079 - accuracy: 0.1520
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.1985 - accuracy: 0.1727
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.1824 - accuracy: 0.1955
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.1750 - accuracy: 0.1908
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.1430 - accuracy: 0.2200
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.1080 - accuracy: 0.2474
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.0814 - accuracy: 0.2673
 4500/10000 [============>.................] - ETA: 3s - loss: 2.1294 - accuracy: 0.2538
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.1403 - accuracy: 0.2368
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.1420 - accuracy: 0.2351
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1342 - accuracy: 0.2477
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1163 - accuracy: 0.2740
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0927 - accuracy: 0.2826
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.0677 - accuracy: 0.2952
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.0236 - accuracy: 0.3122
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0174 - accuracy: 0.3195
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0047 - accuracy: 0.3170
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9757 - accuracy: 0.3300
10000/10000 [==============================] - 6s 612us/step - loss: 1.9335 - accuracy: 0.3483 - val_loss: 1.1135 - val_accuracy: 0.6912
Epoch 3/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.0208 - accuracy: 0.7480
 1000/10000 [==>...........................] - ETA: 4s - loss: 1.1296 - accuracy: 0.6630
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.5443 - accuracy: 0.5173
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.5754 - accuracy: 0.5220
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.5290 - accuracy: 0.5412
 3000/10000 [========>.....................] - ETA: 3s - loss: 1.4608 - accuracy: 0.5597
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.3993 - accuracy: 0.5734
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.4769 - accuracy: 0.5530
 4500/10000 [============>.................] - ETA: 3s - loss: 1.5255 - accuracy: 0.5356
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.5485 - accuracy: 0.5270
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.5355 - accuracy: 0.5342
 6000/10000 [=================>............] - ETA: 2s - loss: 1.5147 - accuracy: 0.5400
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.4883 - accuracy: 0.5455
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.4584 - accuracy: 0.5547
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.4386 - accuracy: 0.5561
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.4247 - accuracy: 0.5619
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.3922 - accuracy: 0.5708
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.3583 - accuracy: 0.5813
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.3291 - accuracy: 0.5891
10000/10000 [==============================] - 6s 603us/step - loss: 1.3068 - accuracy: 0.5950 - val_loss: 1.0958 - val_accuracy: 0.6384
Epoch 4/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.9539 - accuracy: 0.6660
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.8507 - accuracy: 0.7080
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.7714 - accuracy: 0.7413
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.7245 - accuracy: 0.7625
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.6835 - accuracy: 0.7736
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.6421 - accuracy: 0.7883
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.6125 - accuracy: 0.7991
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.5952 - accuracy: 0.8045
 4500/10000 [============>.................] - ETA: 3s - loss: 0.5795 - accuracy: 0.8104
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.5868 - accuracy: 0.8054
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.6432 - accuracy: 0.7956
 6000/10000 [=================>............] - ETA: 2s - loss: 0.6464 - accuracy: 0.7950
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.6347 - accuracy: 0.7995
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.6211 - accuracy: 0.8053
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.6081 - accuracy: 0.8107
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5921 - accuracy: 0.8171
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5806 - accuracy: 0.8213
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5664 - accuracy: 0.8260
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5581 - accuracy: 0.8283
10000/10000 [==============================] - 6s 603us/step - loss: 0.5517 - accuracy: 0.8304 - val_loss: 0.5843 - val_accuracy: 0.8104
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.4668 - accuracy: 0.8600
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.4667 - accuracy: 0.8640
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.4631 - accuracy: 0.8593
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.4360 - accuracy: 0.8685
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.4155 - accuracy: 0.8748
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.3861 - accuracy: 0.8837
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.3712 - accuracy: 0.8889
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3707 - accuracy: 0.8907
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3584 - accuracy: 0.8936
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.3582 - accuracy: 0.8932
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3545 - accuracy: 0.8929
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3467 - accuracy: 0.8948
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3438 - accuracy: 0.8952
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3373 - accuracy: 0.8977
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3314 - accuracy: 0.9001
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3250 - accuracy: 0.9026
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3180 - accuracy: 0.9052
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3109 - accuracy: 0.9072
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3071 - accuracy: 0.9087
10000/10000 [==============================] - 6s 603us/step - loss: 0.3029 - accuracy: 0.9104 - val_loss: 0.3209 - val_accuracy: 0.9020
Latency --- 32.958805084228516 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 10
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_9/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3307 - accuracy: 0.0800
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.3149 - accuracy: 0.0850 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.3020 - accuracy: 0.1200
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2911 - accuracy: 0.1570
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2817 - accuracy: 0.1760
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2647 - accuracy: 0.2127
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2524 - accuracy: 0.2063
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2473 - accuracy: 0.2033
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2510 - accuracy: 0.1929
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2482 - accuracy: 0.1940
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2380 - accuracy: 0.2056
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2181 - accuracy: 0.2223
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1941 - accuracy: 0.2342
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1727 - accuracy: 0.2387
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1941 - accuracy: 0.2388
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1900 - accuracy: 0.2376
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1797 - accuracy: 0.2393
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1632 - accuracy: 0.2474
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1557 - accuracy: 0.2468
10000/10000 [==============================] - 8s 783us/step - loss: 2.2009 - accuracy: 0.2416 - val_loss: 2.3332 - val_accuracy: 0.0996
Epoch 2/5

  500/10000 [>.............................] - ETA: 8s - loss: 2.3164 - accuracy: 0.0740
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.2556 - accuracy: 0.1060
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.1963 - accuracy: 0.2173
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.1257 - accuracy: 0.2505
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.0748 - accuracy: 0.2740
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.1718 - accuracy: 0.2650
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.1689 - accuracy: 0.2671
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.1448 - accuracy: 0.2730
 4500/10000 [============>.................] - ETA: 3s - loss: 2.1126 - accuracy: 0.2902
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.0665 - accuracy: 0.2968
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.0401 - accuracy: 0.3016
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0484 - accuracy: 0.2997
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.0538 - accuracy: 0.3038
 7000/10000 [====================>.........] - ETA: 2s - loss: 2.0467 - accuracy: 0.3143
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.0257 - accuracy: 0.3257
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9842 - accuracy: 0.3464
 8500/10000 [========================>.....] - ETA: 1s - loss: 1.9517 - accuracy: 0.3540
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0586 - accuracy: 0.3468
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0650 - accuracy: 0.3438
10000/10000 [==============================] - 8s 756us/step - loss: 2.0640 - accuracy: 0.3477 - val_loss: 1.7450 - val_accuracy: 0.5772
Epoch 3/5

  500/10000 [>.............................] - ETA: 8s - loss: 1.7293 - accuracy: 0.6140
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.5782 - accuracy: 0.6190
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.4755 - accuracy: 0.6173
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.4715 - accuracy: 0.5920
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.5336 - accuracy: 0.5608
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.6885 - accuracy: 0.5087
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.7405 - accuracy: 0.4871
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.7504 - accuracy: 0.4787
 4500/10000 [============>.................] - ETA: 3s - loss: 1.7289 - accuracy: 0.4829
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.6684 - accuracy: 0.5022
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.6049 - accuracy: 0.5155
 6000/10000 [=================>............] - ETA: 2s - loss: 1.6162 - accuracy: 0.5112
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.6317 - accuracy: 0.5008
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6535 - accuracy: 0.4913
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.6588 - accuracy: 0.4872
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.6361 - accuracy: 0.4942
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6047 - accuracy: 0.5046
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.5684 - accuracy: 0.5176
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5307 - accuracy: 0.5283
10000/10000 [==============================] - 6s 630us/step - loss: 1.5027 - accuracy: 0.5365 - val_loss: 0.9689 - val_accuracy: 0.6628
Epoch 4/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.8523 - accuracy: 0.7100
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.8287 - accuracy: 0.7160
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.7500 - accuracy: 0.7553
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.7164 - accuracy: 0.7560
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.6975 - accuracy: 0.7632
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.6781 - accuracy: 0.7683
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.6617 - accuracy: 0.7734
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.6463 - accuracy: 0.7772
 4500/10000 [============>.................] - ETA: 3s - loss: 0.6266 - accuracy: 0.7856
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.6167 - accuracy: 0.7922
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.6045 - accuracy: 0.7980
 6000/10000 [=================>............] - ETA: 2s - loss: 0.6027 - accuracy: 0.7998
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.6150 - accuracy: 0.7968
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.6257 - accuracy: 0.7929
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.6227 - accuracy: 0.7952
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.6080 - accuracy: 0.8016
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5954 - accuracy: 0.8062
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5828 - accuracy: 0.8110
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5760 - accuracy: 0.8141
10000/10000 [==============================] - 6s 630us/step - loss: 0.5669 - accuracy: 0.8165 - val_loss: 0.6707 - val_accuracy: 0.8160
Epoch 5/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.5931 - accuracy: 0.8260
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.4756 - accuracy: 0.8680
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.4340 - accuracy: 0.8807
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.4062 - accuracy: 0.8890
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3902 - accuracy: 0.8908
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3812 - accuracy: 0.8937
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.3739 - accuracy: 0.8940
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3690 - accuracy: 0.8955
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3733 - accuracy: 0.8924
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.3730 - accuracy: 0.8924
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3812 - accuracy: 0.8884
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3843 - accuracy: 0.8892
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3766 - accuracy: 0.8908
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3690 - accuracy: 0.8934
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3607 - accuracy: 0.8953
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3554 - accuracy: 0.8970
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3500 - accuracy: 0.8986
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3464 - accuracy: 0.8993
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3426 - accuracy: 0.9005
10000/10000 [==============================] - 6s 626us/step - loss: 0.3383 - accuracy: 0.9011 - val_loss: 0.3123 - val_accuracy: 0.9128
Latency --- 36.56690001487732 seconds ---
Trained with vanilla non-private SGD optimizer
