We are using Tensorflow version 1.15.2
Keras API version: 2.3.1
=====================Iteration========================== 1
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 13s - loss: 2.3144 - accuracy: 0.1080
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.3056 - accuracy: 0.1280 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2981 - accuracy: 0.1480
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2927 - accuracy: 0.1725
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2836 - accuracy: 0.2028
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2757 - accuracy: 0.2227
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2681 - accuracy: 0.2340
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2592 - accuracy: 0.2500
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2478 - accuracy: 0.2738
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2336 - accuracy: 0.2910
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2152 - accuracy: 0.3073
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2112 - accuracy: 0.2927
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2170 - accuracy: 0.2854
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2181 - accuracy: 0.2783
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2127 - accuracy: 0.2752
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2008 - accuracy: 0.2800
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1830 - accuracy: 0.2846
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1593 - accuracy: 0.2976
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1472 - accuracy: 0.3018
10000/10000 [==============================] - 7s 659us/step - loss: 2.1507 - accuracy: 0.2975 - val_loss: 2.1416 - val_accuracy: 0.1908
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 2.1374 - accuracy: 0.2200
 1000/10000 [==>...........................] - ETA: 7s - loss: 2.0258 - accuracy: 0.3280
 1500/10000 [===>..........................] - ETA: 6s - loss: 1.8609 - accuracy: 0.4260
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.7142 - accuracy: 0.4680
 2500/10000 [======>.......................] - ETA: 5s - loss: 1.7179 - accuracy: 0.4588
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.8306 - accuracy: 0.4210
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.8814 - accuracy: 0.4020
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8752 - accuracy: 0.4115
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8355 - accuracy: 0.4278
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.7822 - accuracy: 0.4460
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7322 - accuracy: 0.4660
 6000/10000 [=================>............] - ETA: 2s - loss: 1.7067 - accuracy: 0.4672
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.7001 - accuracy: 0.4674
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.7616 - accuracy: 0.4561
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.7873 - accuracy: 0.4339
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.8046 - accuracy: 0.4236
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8131 - accuracy: 0.4139
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.8137 - accuracy: 0.4163
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8211 - accuracy: 0.4092
10000/10000 [==============================] - 6s 633us/step - loss: 1.8332 - accuracy: 0.4008 - val_loss: 1.8738 - val_accuracy: 0.4524
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.8371 - accuracy: 0.5060
 1000/10000 [==>...........................] - ETA: 7s - loss: 1.6774 - accuracy: 0.5360
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.5692 - accuracy: 0.5413
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.6357 - accuracy: 0.4920
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.9134 - accuracy: 0.4460
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9428 - accuracy: 0.4367
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.9347 - accuracy: 0.4400
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.9038 - accuracy: 0.4560
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8411 - accuracy: 0.4827
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.7922 - accuracy: 0.4994
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7692 - accuracy: 0.4962
 6000/10000 [=================>............] - ETA: 2s - loss: 1.7581 - accuracy: 0.4958
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.7286 - accuracy: 0.5037
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6918 - accuracy: 0.5114
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.6387 - accuracy: 0.5277
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.5854 - accuracy: 0.5428
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5326 - accuracy: 0.5573
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.4952 - accuracy: 0.5649
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.4666 - accuracy: 0.5714
10000/10000 [==============================] - 6s 625us/step - loss: 1.4383 - accuracy: 0.5782 - val_loss: 0.6838 - val_accuracy: 0.7872
Epoch 4/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.5960 - accuracy: 0.8240
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.6207 - accuracy: 0.8090
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.6472 - accuracy: 0.7973
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.8622 - accuracy: 0.7445
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.0989 - accuracy: 0.6796
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.1318 - accuracy: 0.6587
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.1244 - accuracy: 0.6463
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.1011 - accuracy: 0.6482
 4500/10000 [============>.................] - ETA: 3s - loss: 1.0742 - accuracy: 0.6607
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.0463 - accuracy: 0.6728
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.0044 - accuracy: 0.6867
 6000/10000 [=================>............] - ETA: 2s - loss: 0.9667 - accuracy: 0.6997
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.9299 - accuracy: 0.7128
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.8968 - accuracy: 0.7233
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.8666 - accuracy: 0.7332
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.8397 - accuracy: 0.7409
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8150 - accuracy: 0.7484
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.7940 - accuracy: 0.7550
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.7713 - accuracy: 0.7622
10000/10000 [==============================] - 6s 626us/step - loss: 0.7510 - accuracy: 0.7688 - val_loss: 0.4419 - val_accuracy: 0.8740
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.3279 - accuracy: 0.8960
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.3519 - accuracy: 0.8850
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.3865 - accuracy: 0.8773
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.4019 - accuracy: 0.8720
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.4025 - accuracy: 0.8676
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.4313 - accuracy: 0.8623
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.4605 - accuracy: 0.8543
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.4733 - accuracy: 0.8505
 4500/10000 [============>.................] - ETA: 3s - loss: 0.4728 - accuracy: 0.8516
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.4536 - accuracy: 0.8584
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4381 - accuracy: 0.8642
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4273 - accuracy: 0.8678
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.4182 - accuracy: 0.8720
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4079 - accuracy: 0.8754
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3952 - accuracy: 0.8793
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3855 - accuracy: 0.8829
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3793 - accuracy: 0.8848
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3771 - accuracy: 0.8854
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3719 - accuracy: 0.8868
10000/10000 [==============================] - 6s 624us/step - loss: 0.3717 - accuracy: 0.8874 - val_loss: 0.4236 - val_accuracy: 0.8748
Latency --- 32.56498432159424 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0 and present is 0.8873999714851379
Saved model to disk
=====================Iteration========================== 2
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_1/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 11s - loss: 2.3257 - accuracy: 0.1000
 1000/10000 [==>...........................] - ETA: 7s - loss: 2.3135 - accuracy: 0.1290 
 1500/10000 [===>..........................] - ETA: 6s - loss: 2.3024 - accuracy: 0.1593
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.2921 - accuracy: 0.1830
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2833 - accuracy: 0.1992
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.2767 - accuracy: 0.2010
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2665 - accuracy: 0.2280
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.2537 - accuracy: 0.2460
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2392 - accuracy: 0.2567
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2244 - accuracy: 0.2644
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2161 - accuracy: 0.2622
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2099 - accuracy: 0.2648
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2077 - accuracy: 0.2597
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2009 - accuracy: 0.2550
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1844 - accuracy: 0.2593
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1755 - accuracy: 0.2594
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1635 - accuracy: 0.2619
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1446 - accuracy: 0.2714
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1200 - accuracy: 0.2757
10000/10000 [==============================] - 6s 644us/step - loss: 2.1165 - accuracy: 0.2763 - val_loss: 1.7178 - val_accuracy: 0.5860
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.6569 - accuracy: 0.6220
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.4326 - accuracy: 0.6450
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.5200 - accuracy: 0.5413
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.0090 - accuracy: 0.5100
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.0587 - accuracy: 0.4396
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.0840 - accuracy: 0.4017
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.0939 - accuracy: 0.3969
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.0897 - accuracy: 0.4000
 4500/10000 [============>.................] - ETA: 3s - loss: 2.0746 - accuracy: 0.4027
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.0410 - accuracy: 0.4128
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.9920 - accuracy: 0.4189
 6000/10000 [=================>............] - ETA: 2s - loss: 1.9782 - accuracy: 0.4160
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.9904 - accuracy: 0.4000
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0009 - accuracy: 0.3923
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9910 - accuracy: 0.3987
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9634 - accuracy: 0.4054
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9192 - accuracy: 0.4207
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.8744 - accuracy: 0.4310
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9147 - accuracy: 0.4200
10000/10000 [==============================] - 6s 614us/step - loss: 1.9195 - accuracy: 0.4118 - val_loss: 1.8584 - val_accuracy: 0.4244
Epoch 3/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.8455 - accuracy: 0.4620
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.8053 - accuracy: 0.4500
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.6628 - accuracy: 0.4960
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.5524 - accuracy: 0.5345
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.4991 - accuracy: 0.5440
 3000/10000 [========>.....................] - ETA: 3s - loss: 1.4785 - accuracy: 0.5423
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.4266 - accuracy: 0.5549
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.3831 - accuracy: 0.5698
 4500/10000 [============>.................] - ETA: 3s - loss: 1.3367 - accuracy: 0.5787
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.3081 - accuracy: 0.5900
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.2880 - accuracy: 0.5918
 6000/10000 [=================>............] - ETA: 2s - loss: 1.2580 - accuracy: 0.5990
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.2275 - accuracy: 0.6072
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1826 - accuracy: 0.6216
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1459 - accuracy: 0.6332
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.1205 - accuracy: 0.6392
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.1091 - accuracy: 0.6424
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.0927 - accuracy: 0.6481
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0627 - accuracy: 0.6555
10000/10000 [==============================] - 6s 599us/step - loss: 1.0416 - accuracy: 0.6624 - val_loss: 0.8731 - val_accuracy: 0.7216
Epoch 4/5

  500/10000 [>.............................] - ETA: 4s - loss: 0.8866 - accuracy: 0.7260
 1000/10000 [==>...........................] - ETA: 4s - loss: 1.0657 - accuracy: 0.6870
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.0658 - accuracy: 0.6873
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.9444 - accuracy: 0.7220
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.8530 - accuracy: 0.7480
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.7887 - accuracy: 0.7670
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.7419 - accuracy: 0.7811
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.7002 - accuracy: 0.7928
 4500/10000 [============>.................] - ETA: 3s - loss: 0.6673 - accuracy: 0.8007
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.6616 - accuracy: 0.8042
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.6434 - accuracy: 0.8100
 6000/10000 [=================>............] - ETA: 2s - loss: 0.6260 - accuracy: 0.8150
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.6085 - accuracy: 0.8200
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5907 - accuracy: 0.8254
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.5735 - accuracy: 0.8300
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5576 - accuracy: 0.8345
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5408 - accuracy: 0.8387
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5301 - accuracy: 0.8416
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5156 - accuracy: 0.8461
10000/10000 [==============================] - 6s 600us/step - loss: 0.5087 - accuracy: 0.8475 - val_loss: 0.3671 - val_accuracy: 0.8952
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.2512 - accuracy: 0.9240
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.2663 - accuracy: 0.9270
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.2732 - accuracy: 0.9247
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.2685 - accuracy: 0.9180
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.2932 - accuracy: 0.9128
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.2953 - accuracy: 0.9107
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.2967 - accuracy: 0.9089
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.2887 - accuracy: 0.9110
 4500/10000 [============>.................] - ETA: 3s - loss: 0.2803 - accuracy: 0.9138
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.2773 - accuracy: 0.9156
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2749 - accuracy: 0.9156
 6000/10000 [=================>............] - ETA: 2s - loss: 0.2756 - accuracy: 0.9145
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.2765 - accuracy: 0.9140
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2787 - accuracy: 0.9141
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2831 - accuracy: 0.9140
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2802 - accuracy: 0.9149
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2803 - accuracy: 0.9149
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2800 - accuracy: 0.9153
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2776 - accuracy: 0.9158
10000/10000 [==============================] - 6s 600us/step - loss: 0.2757 - accuracy: 0.9159 - val_loss: 0.3299 - val_accuracy: 0.9048
Latency --- 31.418939113616943 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.8873999714851379 and present is 0.9158999919891357
Saved model to disk
=====================Iteration========================== 3
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_2/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 13s - loss: 2.3085 - accuracy: 0.1100
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.2991 - accuracy: 0.1110 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2904 - accuracy: 0.1307
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2801 - accuracy: 0.1455
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2631 - accuracy: 0.1568
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2517 - accuracy: 0.1497
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2481 - accuracy: 0.1606
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2405 - accuracy: 0.1682
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2198 - accuracy: 0.2024
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.1959 - accuracy: 0.2102
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2375 - accuracy: 0.1998
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2412 - accuracy: 0.1908
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2406 - accuracy: 0.1988
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2353 - accuracy: 0.2093
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2239 - accuracy: 0.2224
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.2099 - accuracy: 0.2325
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1947 - accuracy: 0.2434
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1839 - accuracy: 0.2476
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1706 - accuracy: 0.2542
10000/10000 [==============================] - 7s 686us/step - loss: 2.1576 - accuracy: 0.2610 - val_loss: 1.7771 - val_accuracy: 0.3884
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.7015 - accuracy: 0.4400
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.1033 - accuracy: 0.3180
 1500/10000 [===>..........................] - ETA: 5s - loss: 2.4253 - accuracy: 0.2500
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.3859 - accuracy: 0.2135
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.3556 - accuracy: 0.2112
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.3296 - accuracy: 0.2053
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.3026 - accuracy: 0.2054
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.2776 - accuracy: 0.2055
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2484 - accuracy: 0.2087
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2224 - accuracy: 0.2064
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2030 - accuracy: 0.2171
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1697 - accuracy: 0.2403
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1303 - accuracy: 0.2505
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0989 - accuracy: 0.2601
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.0729 - accuracy: 0.2665
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.0584 - accuracy: 0.2719
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0405 - accuracy: 0.2912
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0034 - accuracy: 0.3059
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9811 - accuracy: 0.3117
10000/10000 [==============================] - 6s 619us/step - loss: 1.9751 - accuracy: 0.3169 - val_loss: 1.8076 - val_accuracy: 0.4644
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.7948 - accuracy: 0.4680
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.5927 - accuracy: 0.5020
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.4449 - accuracy: 0.5593
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.3306 - accuracy: 0.5995
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.2529 - accuracy: 0.6212
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.2592 - accuracy: 0.6120
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.3584 - accuracy: 0.5914
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.3994 - accuracy: 0.5695
 4500/10000 [============>.................] - ETA: 3s - loss: 1.3975 - accuracy: 0.5696
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.3730 - accuracy: 0.5802
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.3316 - accuracy: 0.5951
 6000/10000 [=================>............] - ETA: 2s - loss: 1.2827 - accuracy: 0.6110
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.2364 - accuracy: 0.6245
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.2156 - accuracy: 0.6306
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.2315 - accuracy: 0.6301
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.2363 - accuracy: 0.6295
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.2236 - accuracy: 0.6344
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.1990 - accuracy: 0.6418
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.1745 - accuracy: 0.6477
10000/10000 [==============================] - 6s 617us/step - loss: 1.1500 - accuracy: 0.6548 - val_loss: 0.7042 - val_accuracy: 0.7628
Epoch 4/5

  500/10000 [>.............................] - ETA: 6s - loss: 0.6620 - accuracy: 0.7820
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.5888 - accuracy: 0.8150
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.5562 - accuracy: 0.8227
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.5426 - accuracy: 0.8250
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.5307 - accuracy: 0.8268
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.5413 - accuracy: 0.8293
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.5957 - accuracy: 0.8117
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.6600 - accuracy: 0.7918
 4500/10000 [============>.................] - ETA: 3s - loss: 0.6791 - accuracy: 0.7887
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.6621 - accuracy: 0.7978
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.6369 - accuracy: 0.8078
 6000/10000 [=================>............] - ETA: 2s - loss: 0.6217 - accuracy: 0.8117
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.5986 - accuracy: 0.8192
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5821 - accuracy: 0.8251
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.5608 - accuracy: 0.8317
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5461 - accuracy: 0.8371
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5348 - accuracy: 0.8407
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5273 - accuracy: 0.8423
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5187 - accuracy: 0.8449
10000/10000 [==============================] - 6s 634us/step - loss: 0.5189 - accuracy: 0.8446 - val_loss: 0.4584 - val_accuracy: 0.8536
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.3975 - accuracy: 0.8720
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.4022 - accuracy: 0.8750
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.3904 - accuracy: 0.8793
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.3808 - accuracy: 0.8860
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3725 - accuracy: 0.8896
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3547 - accuracy: 0.8933
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.3483 - accuracy: 0.8954
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3385 - accuracy: 0.8972
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3349 - accuracy: 0.8987
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.3361 - accuracy: 0.8978
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3337 - accuracy: 0.8976
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3331 - accuracy: 0.8987
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3320 - accuracy: 0.8997
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3258 - accuracy: 0.9026
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3193 - accuracy: 0.9044
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3112 - accuracy: 0.9069
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3084 - accuracy: 0.9074
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3059 - accuracy: 0.9079
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3045 - accuracy: 0.9083
10000/10000 [==============================] - 6s 619us/step - loss: 0.3019 - accuracy: 0.9085 - val_loss: 0.3147 - val_accuracy: 0.8968
Latency --- 32.826730489730835 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 4
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_3/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 12s - loss: 2.2994 - accuracy: 0.1920
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.2904 - accuracy: 0.2100 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2771 - accuracy: 0.2513
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2671 - accuracy: 0.2265
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2507 - accuracy: 0.2492
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.2367 - accuracy: 0.2520
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2345 - accuracy: 0.2446
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2305 - accuracy: 0.2457
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2213 - accuracy: 0.2542
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.1994 - accuracy: 0.2556
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.1770 - accuracy: 0.2702
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1595 - accuracy: 0.2762
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1541 - accuracy: 0.2795
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1334 - accuracy: 0.2956
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1149 - accuracy: 0.2983
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1680 - accuracy: 0.2909
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1708 - accuracy: 0.2853
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1686 - accuracy: 0.2830
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1635 - accuracy: 0.2798
10000/10000 [==============================] - 7s 673us/step - loss: 2.1506 - accuracy: 0.2860 - val_loss: 1.9436 - val_accuracy: 0.2296
Epoch 2/5

  500/10000 [>.............................] - ETA: 8s - loss: 1.8966 - accuracy: 0.2140
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.9657 - accuracy: 0.3180
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.8881 - accuracy: 0.3360
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.7989 - accuracy: 0.3730
 2500/10000 [======>.......................] - ETA: 5s - loss: 1.7648 - accuracy: 0.3776
 3000/10000 [========>.....................] - ETA: 5s - loss: 1.8057 - accuracy: 0.3817
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.7818 - accuracy: 0.3989
 4000/10000 [===========>..................] - ETA: 4s - loss: 1.7042 - accuracy: 0.4308
 4500/10000 [============>.................] - ETA: 3s - loss: 1.6154 - accuracy: 0.4636
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.5860 - accuracy: 0.4780
 5500/10000 [===============>..............] - ETA: 3s - loss: 1.6277 - accuracy: 0.4636
 6000/10000 [=================>............] - ETA: 2s - loss: 1.6109 - accuracy: 0.4745
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.5754 - accuracy: 0.4826
 7000/10000 [====================>.........] - ETA: 2s - loss: 1.5339 - accuracy: 0.4974
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.5212 - accuracy: 0.5016
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.5725 - accuracy: 0.4940
 8500/10000 [========================>.....] - ETA: 1s - loss: 1.6110 - accuracy: 0.4789
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.6136 - accuracy: 0.4867
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5923 - accuracy: 0.4919
10000/10000 [==============================] - 7s 696us/step - loss: 1.5655 - accuracy: 0.5000 - val_loss: 1.0640 - val_accuracy: 0.6520
Epoch 3/5

  500/10000 [>.............................] - ETA: 9s - loss: 0.9649 - accuracy: 0.6900
 1000/10000 [==>...........................] - ETA: 7s - loss: 1.0332 - accuracy: 0.6760
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.9684 - accuracy: 0.6960
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.9450 - accuracy: 0.6995
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.8937 - accuracy: 0.7088
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.8626 - accuracy: 0.7193
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.8306 - accuracy: 0.7289
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.8160 - accuracy: 0.7337
 4500/10000 [============>.................] - ETA: 3s - loss: 0.8175 - accuracy: 0.7344
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.8106 - accuracy: 0.7374
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.7959 - accuracy: 0.7424
 6000/10000 [=================>............] - ETA: 2s - loss: 0.7773 - accuracy: 0.7492
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.7700 - accuracy: 0.7503
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.7613 - accuracy: 0.7543
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.7458 - accuracy: 0.7605
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.7232 - accuracy: 0.7689
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7063 - accuracy: 0.7752
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.6878 - accuracy: 0.7819
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.6730 - accuracy: 0.7857
10000/10000 [==============================] - 6s 634us/step - loss: 0.6762 - accuracy: 0.7862 - val_loss: 0.8222 - val_accuracy: 0.7440
Epoch 4/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.8235 - accuracy: 0.7360
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.7014 - accuracy: 0.7720
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.6298 - accuracy: 0.7947
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.6102 - accuracy: 0.8060
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.5851 - accuracy: 0.8128
 3000/10000 [========>.....................] - ETA: 5s - loss: 0.5890 - accuracy: 0.8133
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.5512 - accuracy: 0.8269
 4000/10000 [===========>..................] - ETA: 4s - loss: 0.5292 - accuracy: 0.8353
 4500/10000 [============>.................] - ETA: 3s - loss: 0.5115 - accuracy: 0.8413
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.4967 - accuracy: 0.8468
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4785 - accuracy: 0.8525
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4670 - accuracy: 0.8560
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.4570 - accuracy: 0.8600
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4501 - accuracy: 0.8620
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.4394 - accuracy: 0.8657
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.4318 - accuracy: 0.8690
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4215 - accuracy: 0.8724
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4084 - accuracy: 0.8761
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4004 - accuracy: 0.8784
10000/10000 [==============================] - 7s 654us/step - loss: 0.3977 - accuracy: 0.8793 - val_loss: 0.4891 - val_accuracy: 0.8572
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.3952 - accuracy: 0.8840
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.3684 - accuracy: 0.8920
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.3507 - accuracy: 0.8967
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.3473 - accuracy: 0.8960
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3511 - accuracy: 0.8936
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3659 - accuracy: 0.8900
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.3481 - accuracy: 0.8954
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3342 - accuracy: 0.8978
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3286 - accuracy: 0.8991
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.3264 - accuracy: 0.9000
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3154 - accuracy: 0.9045
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3109 - accuracy: 0.9070
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3029 - accuracy: 0.9098
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2938 - accuracy: 0.9127
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2906 - accuracy: 0.9141
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2851 - accuracy: 0.9151
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2804 - accuracy: 0.9168
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2735 - accuracy: 0.9192
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2730 - accuracy: 0.9188
10000/10000 [==============================] - 6s 624us/step - loss: 0.2676 - accuracy: 0.9200 - val_loss: 0.3154 - val_accuracy: 0.9060
Latency --- 33.90741324424744 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9158999919891357 and present is 0.9200000166893005
Saved model to disk
=====================Iteration========================== 5
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_4/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3128 - accuracy: 0.1420
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.2991 - accuracy: 0.1660 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2868 - accuracy: 0.1940
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2747 - accuracy: 0.2145
 2500/10000 [======>.......................] - ETA: 6s - loss: 2.2640 - accuracy: 0.2352
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2498 - accuracy: 0.2397
 3500/10000 [=========>....................] - ETA: 5s - loss: 2.2366 - accuracy: 0.2357
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2236 - accuracy: 0.2247
 4500/10000 [============>.................] - ETA: 4s - loss: 2.2225 - accuracy: 0.2233
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2113 - accuracy: 0.2222
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.1881 - accuracy: 0.2362
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1918 - accuracy: 0.2343
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1925 - accuracy: 0.2343
 7000/10000 [====================>.........] - ETA: 2s - loss: 2.1810 - accuracy: 0.2424
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1602 - accuracy: 0.2520
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1317 - accuracy: 0.2645
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1421 - accuracy: 0.2658
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1437 - accuracy: 0.2583
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1457 - accuracy: 0.2515
10000/10000 [==============================] - 7s 707us/step - loss: 2.1360 - accuracy: 0.2639 - val_loss: 1.7322 - val_accuracy: 0.4460
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.6878 - accuracy: 0.4760
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.6044 - accuracy: 0.4930
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.8448 - accuracy: 0.3667
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.8785 - accuracy: 0.3590
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.9398 - accuracy: 0.3356
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9240 - accuracy: 0.3663
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.8617 - accuracy: 0.3917
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.7945 - accuracy: 0.4120
 4500/10000 [============>.................] - ETA: 3s - loss: 1.7416 - accuracy: 0.4296
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.7386 - accuracy: 0.4206
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7115 - accuracy: 0.4409
 6000/10000 [=================>............] - ETA: 2s - loss: 1.6593 - accuracy: 0.4537
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.6380 - accuracy: 0.4574
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6485 - accuracy: 0.4566
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.6564 - accuracy: 0.4620
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.6231 - accuracy: 0.4749
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5818 - accuracy: 0.4898
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.5474 - accuracy: 0.5019
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5403 - accuracy: 0.5017
10000/10000 [==============================] - 6s 622us/step - loss: 1.5344 - accuracy: 0.5050 - val_loss: 1.1351 - val_accuracy: 0.6576
Epoch 3/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.9935 - accuracy: 0.6940
 1000/10000 [==>...........................] - ETA: 7s - loss: 0.9024 - accuracy: 0.7320
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.8044 - accuracy: 0.7627
 2000/10000 [=====>........................] - ETA: 6s - loss: 0.7619 - accuracy: 0.7735
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.7298 - accuracy: 0.7788
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.7840 - accuracy: 0.7557
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.0852 - accuracy: 0.6760
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.1465 - accuracy: 0.6485
 4500/10000 [============>.................] - ETA: 3s - loss: 1.1567 - accuracy: 0.6460
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.1582 - accuracy: 0.6462
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.1702 - accuracy: 0.6396
 6000/10000 [=================>............] - ETA: 2s - loss: 1.1632 - accuracy: 0.6368
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.1505 - accuracy: 0.6368
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1446 - accuracy: 0.6341
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1274 - accuracy: 0.6384
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.1161 - accuracy: 0.6417
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.1028 - accuracy: 0.6476
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.0886 - accuracy: 0.6527
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0730 - accuracy: 0.6587
10000/10000 [==============================] - 6s 641us/step - loss: 1.0643 - accuracy: 0.6618 - val_loss: 1.1518 - val_accuracy: 0.6136
Epoch 4/5

  500/10000 [>.............................] - ETA: 8s - loss: 1.0545 - accuracy: 0.6120
 1000/10000 [==>...........................] - ETA: 7s - loss: 1.0021 - accuracy: 0.6780
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.8773 - accuracy: 0.7213
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.8129 - accuracy: 0.7445
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.7655 - accuracy: 0.7568
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.7332 - accuracy: 0.7727
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.7122 - accuracy: 0.7820
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.6966 - accuracy: 0.7868
 4500/10000 [============>.................] - ETA: 3s - loss: 0.6852 - accuracy: 0.7902
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.6524 - accuracy: 0.8018
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.6238 - accuracy: 0.8113
 6000/10000 [=================>............] - ETA: 2s - loss: 0.5964 - accuracy: 0.8195
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.5768 - accuracy: 0.8260
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5594 - accuracy: 0.8299
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.5492 - accuracy: 0.8337
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5400 - accuracy: 0.8363
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5320 - accuracy: 0.8385
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5219 - accuracy: 0.8422
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5139 - accuracy: 0.8454
10000/10000 [==============================] - 6s 628us/step - loss: 0.5036 - accuracy: 0.8480 - val_loss: 0.3968 - val_accuracy: 0.8760
Epoch 5/5

  500/10000 [>.............................] - ETA: 8s - loss: 0.3236 - accuracy: 0.9060
 1000/10000 [==>...........................] - ETA: 7s - loss: 0.3181 - accuracy: 0.9050
 1500/10000 [===>..........................] - ETA: 6s - loss: 0.3042 - accuracy: 0.9067
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.3157 - accuracy: 0.9025
 2500/10000 [======>.......................] - ETA: 5s - loss: 0.3162 - accuracy: 0.9016
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.3067 - accuracy: 0.9047
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.2992 - accuracy: 0.9071
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.2916 - accuracy: 0.9105
 4500/10000 [============>.................] - ETA: 3s - loss: 0.2857 - accuracy: 0.9113
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.2848 - accuracy: 0.9118
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2881 - accuracy: 0.9111
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3028 - accuracy: 0.9077
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3041 - accuracy: 0.9074
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3135 - accuracy: 0.9051
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3105 - accuracy: 0.9059
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3106 - accuracy: 0.9050
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3075 - accuracy: 0.9061
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3040 - accuracy: 0.9080
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3000 - accuracy: 0.9096
10000/10000 [==============================] - 6s 642us/step - loss: 0.2958 - accuracy: 0.9103 - val_loss: 0.2916 - val_accuracy: 0.9120
Latency --- 33.645068883895874 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 6
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_5/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 13s - loss: 2.3350 - accuracy: 0.0580
 1000/10000 [==>...........................] - ETA: 8s - loss: 2.3152 - accuracy: 0.0870 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.3030 - accuracy: 0.1000
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2930 - accuracy: 0.1095
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2866 - accuracy: 0.1252
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2791 - accuracy: 0.1577
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2698 - accuracy: 0.1729
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2603 - accuracy: 0.1817
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2535 - accuracy: 0.1811
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2460 - accuracy: 0.1836
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2318 - accuracy: 0.1971
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2111 - accuracy: 0.2105
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1893 - accuracy: 0.2272
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1986 - accuracy: 0.2216
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2036 - accuracy: 0.2153
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1992 - accuracy: 0.2171
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1891 - accuracy: 0.2206
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1738 - accuracy: 0.2327
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1505 - accuracy: 0.2415
10000/10000 [==============================] - 7s 672us/step - loss: 2.1269 - accuracy: 0.2547 - val_loss: 3.2503 - val_accuracy: 0.1564
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 3.4275 - accuracy: 0.1420
 1000/10000 [==>...........................] - ETA: 6s - loss: 3.4399 - accuracy: 0.1180
 1500/10000 [===>..........................] - ETA: 5s - loss: 3.0858 - accuracy: 0.1213
 2000/10000 [=====>........................] - ETA: 5s - loss: 2.8868 - accuracy: 0.1205
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.7632 - accuracy: 0.1252
 3000/10000 [========>.....................] - ETA: 4s - loss: 2.6793 - accuracy: 0.1280
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.6226 - accuracy: 0.1226
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.5770 - accuracy: 0.1420
 4500/10000 [============>.................] - ETA: 3s - loss: 2.5366 - accuracy: 0.1473
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.5148 - accuracy: 0.1466
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.5066 - accuracy: 0.1424
 6000/10000 [=================>............] - ETA: 2s - loss: 2.4869 - accuracy: 0.1428
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.4690 - accuracy: 0.1488
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.4531 - accuracy: 0.1506
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.4377 - accuracy: 0.1584
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.4224 - accuracy: 0.1641
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.4073 - accuracy: 0.1691
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.3955 - accuracy: 0.1691
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.3871 - accuracy: 0.1652
10000/10000 [==============================] - 6s 613us/step - loss: 2.3781 - accuracy: 0.1656 - val_loss: 2.1093 - val_accuracy: 0.2260
Epoch 3/5

  500/10000 [>.............................] - ETA: 5s - loss: 2.0783 - accuracy: 0.2460
 1000/10000 [==>...........................] - ETA: 4s - loss: 2.0238 - accuracy: 0.2880
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.9635 - accuracy: 0.3227
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.9093 - accuracy: 0.3475
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.9984 - accuracy: 0.3368
 3000/10000 [========>.....................] - ETA: 3s - loss: 2.1330 - accuracy: 0.3093
 3500/10000 [=========>....................] - ETA: 3s - loss: 2.1521 - accuracy: 0.2954
 4000/10000 [===========>..................] - ETA: 3s - loss: 2.1609 - accuracy: 0.2920
 4500/10000 [============>.................] - ETA: 3s - loss: 2.1639 - accuracy: 0.2876
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.1597 - accuracy: 0.2864
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.1472 - accuracy: 0.2887
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1320 - accuracy: 0.2882
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.1230 - accuracy: 0.2862
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1018 - accuracy: 0.2961
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.0700 - accuracy: 0.3017
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.0340 - accuracy: 0.3121
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9955 - accuracy: 0.3211
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9751 - accuracy: 0.3240
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9909 - accuracy: 0.3212
10000/10000 [==============================] - 6s 597us/step - loss: 2.0438 - accuracy: 0.3190 - val_loss: 2.2399 - val_accuracy: 0.1488
Epoch 4/5

  500/10000 [>.............................] - ETA: 5s - loss: 2.2295 - accuracy: 0.1740
 1000/10000 [==>...........................] - ETA: 5s - loss: 2.1897 - accuracy: 0.2780
 1500/10000 [===>..........................] - ETA: 4s - loss: 2.1408 - accuracy: 0.3347
 2000/10000 [=====>........................] - ETA: 4s - loss: 2.0770 - accuracy: 0.3680
 2500/10000 [======>.......................] - ETA: 4s - loss: 2.0089 - accuracy: 0.3768
 3000/10000 [========>.....................] - ETA: 3s - loss: 1.9318 - accuracy: 0.4023
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.8632 - accuracy: 0.4123
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.9295 - accuracy: 0.3845
 4500/10000 [============>.................] - ETA: 3s - loss: 2.0198 - accuracy: 0.3602
 5000/10000 [==============>...............] - ETA: 2s - loss: 2.0338 - accuracy: 0.3488
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.0468 - accuracy: 0.3356
 6000/10000 [=================>............] - ETA: 2s - loss: 2.0482 - accuracy: 0.3363
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.0433 - accuracy: 0.3349
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0266 - accuracy: 0.3437
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9971 - accuracy: 0.3577
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9639 - accuracy: 0.3684
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9356 - accuracy: 0.3762
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9379 - accuracy: 0.3763
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9114 - accuracy: 0.3877
10000/10000 [==============================] - 6s 597us/step - loss: 1.8782 - accuracy: 0.4005 - val_loss: 1.1924 - val_accuracy: 0.6320
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.1519 - accuracy: 0.6420
 1000/10000 [==>...........................] - ETA: 4s - loss: 1.1164 - accuracy: 0.6580
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.1633 - accuracy: 0.6420
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.1644 - accuracy: 0.6300
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.1858 - accuracy: 0.6216
 3000/10000 [========>.....................] - ETA: 3s - loss: 1.1765 - accuracy: 0.6197
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.1524 - accuracy: 0.6317
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.1211 - accuracy: 0.6428
 4500/10000 [============>.................] - ETA: 3s - loss: 1.0923 - accuracy: 0.6527
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.0773 - accuracy: 0.6580
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.0867 - accuracy: 0.6564
 6000/10000 [=================>............] - ETA: 2s - loss: 1.0651 - accuracy: 0.6660
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.0396 - accuracy: 0.6762
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.0210 - accuracy: 0.6820
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.0213 - accuracy: 0.6837
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.0188 - accuracy: 0.6806
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.0011 - accuracy: 0.6864
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.9820 - accuracy: 0.6921
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9713 - accuracy: 0.6948
10000/10000 [==============================] - 6s 597us/step - loss: 0.9721 - accuracy: 0.6953 - val_loss: 0.9018 - val_accuracy: 0.7176
Latency --- 32.09197974205017 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 7
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_6/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3124 - accuracy: 0.1160
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.3012 - accuracy: 0.1220 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2905 - accuracy: 0.1440
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2849 - accuracy: 0.1655
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2777 - accuracy: 0.1792
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2692 - accuracy: 0.1920
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2585 - accuracy: 0.2031
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2488 - accuracy: 0.1935
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2467 - accuracy: 0.1864
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2458 - accuracy: 0.1796
 5500/10000 [===============>..............] - ETA: 2s - loss: 2.2366 - accuracy: 0.1807
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2208 - accuracy: 0.2077
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2044 - accuracy: 0.2142
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2004 - accuracy: 0.2197
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1952 - accuracy: 0.2241
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1918 - accuracy: 0.2180
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1816 - accuracy: 0.2274
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1611 - accuracy: 0.2410
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1329 - accuracy: 0.2572
10000/10000 [==============================] - 7s 687us/step - loss: 2.1092 - accuracy: 0.2689 - val_loss: 2.3801 - val_accuracy: 0.3408
Epoch 2/5

  500/10000 [>.............................] - ETA: 7s - loss: 2.2739 - accuracy: 0.3800
 1000/10000 [==>...........................] - ETA: 6s - loss: 2.1197 - accuracy: 0.4190
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.9628 - accuracy: 0.4193
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.8818 - accuracy: 0.4125
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.8925 - accuracy: 0.4036
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.9177 - accuracy: 0.3803
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.9299 - accuracy: 0.3717
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8977 - accuracy: 0.3915
 4500/10000 [============>.................] - ETA: 3s - loss: 1.8237 - accuracy: 0.4120
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.7556 - accuracy: 0.4368
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7923 - accuracy: 0.4324
 6000/10000 [=================>............] - ETA: 2s - loss: 1.8920 - accuracy: 0.4178
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.9192 - accuracy: 0.4002
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9368 - accuracy: 0.3977
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.9428 - accuracy: 0.3975
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.9366 - accuracy: 0.4049
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9228 - accuracy: 0.4109
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9092 - accuracy: 0.4149
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8851 - accuracy: 0.4215
10000/10000 [==============================] - 6s 614us/step - loss: 1.8573 - accuracy: 0.4284 - val_loss: 1.5898 - val_accuracy: 0.4232
Epoch 3/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.5370 - accuracy: 0.4560
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.7868 - accuracy: 0.3930
 1500/10000 [===>..........................] - ETA: 4s - loss: 1.7240 - accuracy: 0.4193
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.6385 - accuracy: 0.4455
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.5731 - accuracy: 0.4664
 3000/10000 [========>.....................] - ETA: 3s - loss: 1.4864 - accuracy: 0.5010
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.4463 - accuracy: 0.5123
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.4469 - accuracy: 0.5105
 4500/10000 [============>.................] - ETA: 3s - loss: 1.3984 - accuracy: 0.5316
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.3336 - accuracy: 0.5576
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.2736 - accuracy: 0.5798
 6000/10000 [=================>............] - ETA: 2s - loss: 1.2117 - accuracy: 0.6013
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.1571 - accuracy: 0.6220
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1274 - accuracy: 0.6333
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1145 - accuracy: 0.6364
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.2111 - accuracy: 0.6275
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.2333 - accuracy: 0.6182
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.2414 - accuracy: 0.6134
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.2533 - accuracy: 0.6086
10000/10000 [==============================] - 6s 601us/step - loss: 1.2445 - accuracy: 0.6128 - val_loss: 1.1005 - val_accuracy: 0.6712
Epoch 4/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.0010 - accuracy: 0.7240
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.9271 - accuracy: 0.7420
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.8649 - accuracy: 0.7513
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.8384 - accuracy: 0.7505
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.8634 - accuracy: 0.7436
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.8699 - accuracy: 0.7380
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.8317 - accuracy: 0.7531
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.7880 - accuracy: 0.7685
 4500/10000 [============>.................] - ETA: 3s - loss: 0.7516 - accuracy: 0.7782
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.7284 - accuracy: 0.7836
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.7247 - accuracy: 0.7831
 6000/10000 [=================>............] - ETA: 2s - loss: 0.7522 - accuracy: 0.7693
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.7600 - accuracy: 0.7669
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.7567 - accuracy: 0.7681
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.7362 - accuracy: 0.7739
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.7144 - accuracy: 0.7818
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.6955 - accuracy: 0.7878
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.6772 - accuracy: 0.7932
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.6606 - accuracy: 0.7979
10000/10000 [==============================] - 6s 601us/step - loss: 0.6454 - accuracy: 0.8031 - val_loss: 0.4763 - val_accuracy: 0.8464
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.3130 - accuracy: 0.9000
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.3445 - accuracy: 0.8970
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.3660 - accuracy: 0.8853
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.3903 - accuracy: 0.8735
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.3851 - accuracy: 0.8780
 3000/10000 [========>.....................] - ETA: 3s - loss: 0.3778 - accuracy: 0.8817
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.3653 - accuracy: 0.8860
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.3605 - accuracy: 0.8865
 4500/10000 [============>.................] - ETA: 3s - loss: 0.3549 - accuracy: 0.8884
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.3488 - accuracy: 0.8898
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.3497 - accuracy: 0.8909
 6000/10000 [=================>............] - ETA: 2s - loss: 0.3507 - accuracy: 0.8903
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.3514 - accuracy: 0.8909
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3443 - accuracy: 0.8931
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3399 - accuracy: 0.8956
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3365 - accuracy: 0.8974
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3291 - accuracy: 0.8999
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3259 - accuracy: 0.9012
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3203 - accuracy: 0.9028
10000/10000 [==============================] - 6s 601us/step - loss: 0.3157 - accuracy: 0.9045 - val_loss: 0.3354 - val_accuracy: 0.9008
Latency --- 32.512237548828125 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 8
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_7/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3191 - accuracy: 0.0920
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.3028 - accuracy: 0.0970 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2937 - accuracy: 0.1167
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2844 - accuracy: 0.1520
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2732 - accuracy: 0.1708
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2635 - accuracy: 0.1863
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2538 - accuracy: 0.1854
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2553 - accuracy: 0.1735
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2568 - accuracy: 0.1644
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2555 - accuracy: 0.1634
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2457 - accuracy: 0.1744
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2270 - accuracy: 0.1945
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2033 - accuracy: 0.2057
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2064 - accuracy: 0.2041
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.2024 - accuracy: 0.2063
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1816 - accuracy: 0.2196
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1493 - accuracy: 0.2389
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1596 - accuracy: 0.2350
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1775 - accuracy: 0.2294
10000/10000 [==============================] - 7s 695us/step - loss: 2.1754 - accuracy: 0.2368 - val_loss: 2.0659 - val_accuracy: 0.4084
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 2.0185 - accuracy: 0.3760
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.9653 - accuracy: 0.3940
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.9099 - accuracy: 0.4473
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.8431 - accuracy: 0.4730
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.8668 - accuracy: 0.4648
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.8626 - accuracy: 0.4637
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.8213 - accuracy: 0.4617
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.8123 - accuracy: 0.4512
 4500/10000 [============>.................] - ETA: 3s - loss: 1.7583 - accuracy: 0.4631
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.7408 - accuracy: 0.4654
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.7378 - accuracy: 0.4711
 6000/10000 [=================>............] - ETA: 2s - loss: 1.7139 - accuracy: 0.4747
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.7123 - accuracy: 0.4691
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6838 - accuracy: 0.4777
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.6345 - accuracy: 0.4983
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.5801 - accuracy: 0.5163
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5629 - accuracy: 0.5202
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.6047 - accuracy: 0.5189
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6293 - accuracy: 0.5054
10000/10000 [==============================] - 6s 615us/step - loss: 1.6444 - accuracy: 0.5046 - val_loss: 1.4482 - val_accuracy: 0.5456
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.4144 - accuracy: 0.5800
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.2662 - accuracy: 0.6380
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.4404 - accuracy: 0.5607
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.5379 - accuracy: 0.5260
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.5397 - accuracy: 0.5288
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.4763 - accuracy: 0.5487
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.3664 - accuracy: 0.5869
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.2718 - accuracy: 0.6137
 4500/10000 [============>.................] - ETA: 3s - loss: 1.2078 - accuracy: 0.6309
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.1719 - accuracy: 0.6392
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.1882 - accuracy: 0.6329
 6000/10000 [=================>............] - ETA: 2s - loss: 1.2088 - accuracy: 0.6277
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.1911 - accuracy: 0.6358
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.1547 - accuracy: 0.6464
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.1189 - accuracy: 0.6580
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.0821 - accuracy: 0.6699
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.0490 - accuracy: 0.6802
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.0152 - accuracy: 0.6904
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9839 - accuracy: 0.7000
10000/10000 [==============================] - 6s 622us/step - loss: 0.9655 - accuracy: 0.7060 - val_loss: 1.0327 - val_accuracy: 0.6644
Epoch 4/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.9681 - accuracy: 0.6580
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.1041 - accuracy: 0.6490
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.1695 - accuracy: 0.6533
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.1264 - accuracy: 0.6685
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.0545 - accuracy: 0.6924
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.9718 - accuracy: 0.7160
 3500/10000 [=========>....................] - ETA: 4s - loss: 0.9010 - accuracy: 0.7366
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.8347 - accuracy: 0.7590
 4500/10000 [============>.................] - ETA: 3s - loss: 0.7759 - accuracy: 0.7749
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.7379 - accuracy: 0.7844
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.7093 - accuracy: 0.7927
 6000/10000 [=================>............] - ETA: 2s - loss: 0.6793 - accuracy: 0.8010
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.6529 - accuracy: 0.8095
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.6275 - accuracy: 0.8163
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.6092 - accuracy: 0.8216
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.5935 - accuracy: 0.8261
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5788 - accuracy: 0.8304
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5698 - accuracy: 0.8338
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5596 - accuracy: 0.8367
10000/10000 [==============================] - 6s 622us/step - loss: 0.5472 - accuracy: 0.8403 - val_loss: 0.4027 - val_accuracy: 0.8828
Epoch 5/5

  500/10000 [>.............................] - ETA: 7s - loss: 0.3368 - accuracy: 0.9040
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.3510 - accuracy: 0.8940
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.3951 - accuracy: 0.8773
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.4304 - accuracy: 0.8600
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.4754 - accuracy: 0.8468
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.4855 - accuracy: 0.8440
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.4783 - accuracy: 0.8480
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.4535 - accuracy: 0.8558
 4500/10000 [============>.................] - ETA: 3s - loss: 0.4340 - accuracy: 0.8633
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.4213 - accuracy: 0.8682
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4080 - accuracy: 0.8727
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4014 - accuracy: 0.8763
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3919 - accuracy: 0.8786
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3811 - accuracy: 0.8821
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3736 - accuracy: 0.8841
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3644 - accuracy: 0.8878
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3597 - accuracy: 0.8891
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3590 - accuracy: 0.8899
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3537 - accuracy: 0.8913
10000/10000 [==============================] - 6s 621us/step - loss: 0.3487 - accuracy: 0.8927 - val_loss: 0.3243 - val_accuracy: 0.9008
Latency --- 33.33176040649414 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 9
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_8/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3110 - accuracy: 0.1060
 1000/10000 [==>...........................] - ETA: 9s - loss: 2.2958 - accuracy: 0.1410 
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2821 - accuracy: 0.1613
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2673 - accuracy: 0.1735
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2536 - accuracy: 0.1736
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2375 - accuracy: 0.1957
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2244 - accuracy: 0.1931
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2286 - accuracy: 0.1867
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2185 - accuracy: 0.2064
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.1911 - accuracy: 0.2354
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.1602 - accuracy: 0.2480
 6000/10000 [=================>............] - ETA: 2s - loss: 2.1579 - accuracy: 0.2508
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.1809 - accuracy: 0.2429
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1788 - accuracy: 0.2384
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1656 - accuracy: 0.2540
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1485 - accuracy: 0.2660
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1262 - accuracy: 0.2754
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1522 - accuracy: 0.2673
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1537 - accuracy: 0.2618
10000/10000 [==============================] - 7s 705us/step - loss: 2.1385 - accuracy: 0.2681 - val_loss: 1.7143 - val_accuracy: 0.4024
Epoch 2/5

  500/10000 [>.............................] - ETA: 5s - loss: 1.6315 - accuracy: 0.4260
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.6836 - accuracy: 0.4390
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.7031 - accuracy: 0.4580
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.8347 - accuracy: 0.4095
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.8689 - accuracy: 0.4036
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.8065 - accuracy: 0.4217
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.7129 - accuracy: 0.4466
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.6565 - accuracy: 0.4647
 4500/10000 [============>.................] - ETA: 3s - loss: 1.7758 - accuracy: 0.4520
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.8084 - accuracy: 0.4314
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.8119 - accuracy: 0.4302
 6000/10000 [=================>............] - ETA: 2s - loss: 1.8131 - accuracy: 0.4192
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.8376 - accuracy: 0.4046
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.8435 - accuracy: 0.3996
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.8313 - accuracy: 0.4075
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.8043 - accuracy: 0.4169
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.7845 - accuracy: 0.4196
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.8171 - accuracy: 0.4109
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8182 - accuracy: 0.4137
10000/10000 [==============================] - 6s 610us/step - loss: 1.8053 - accuracy: 0.4168 - val_loss: 1.4859 - val_accuracy: 0.5584
Epoch 3/5

  500/10000 [>.............................] - ETA: 6s - loss: 1.3051 - accuracy: 0.6320
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.2155 - accuracy: 0.6310
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.1248 - accuracy: 0.6840
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.0463 - accuracy: 0.7050
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.9907 - accuracy: 0.7112
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.0135 - accuracy: 0.6993
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.0831 - accuracy: 0.6837
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.1365 - accuracy: 0.6538
 4500/10000 [============>.................] - ETA: 3s - loss: 1.1515 - accuracy: 0.6420
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.1419 - accuracy: 0.6420
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.1055 - accuracy: 0.6535
 6000/10000 [=================>............] - ETA: 2s - loss: 1.0650 - accuracy: 0.6687
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.0274 - accuracy: 0.6811
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.9926 - accuracy: 0.6923
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.9577 - accuracy: 0.7035
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.9283 - accuracy: 0.7132
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9022 - accuracy: 0.7214
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8891 - accuracy: 0.7242
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8988 - accuracy: 0.7238
10000/10000 [==============================] - 6s 620us/step - loss: 0.8952 - accuracy: 0.7243 - val_loss: 0.6958 - val_accuracy: 0.7784
Epoch 4/5

  500/10000 [>.............................] - ETA: 6s - loss: 0.6625 - accuracy: 0.7660
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.5727 - accuracy: 0.8120
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.5124 - accuracy: 0.8340
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.5038 - accuracy: 0.8400
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.4767 - accuracy: 0.8496
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.4564 - accuracy: 0.8567
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.4490 - accuracy: 0.8589
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.4352 - accuracy: 0.8643
 4500/10000 [============>.................] - ETA: 3s - loss: 0.4219 - accuracy: 0.8673
 5000/10000 [==============>...............] - ETA: 3s - loss: 0.4178 - accuracy: 0.8700
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4096 - accuracy: 0.8731
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4043 - accuracy: 0.8748
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3973 - accuracy: 0.8782
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3917 - accuracy: 0.8800
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3867 - accuracy: 0.8809
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3827 - accuracy: 0.8834
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3765 - accuracy: 0.8856
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3693 - accuracy: 0.8883
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3634 - accuracy: 0.8908
10000/10000 [==============================] - 6s 620us/step - loss: 0.3593 - accuracy: 0.8918 - val_loss: 0.4669 - val_accuracy: 0.8488
Epoch 5/5

  500/10000 [>.............................] - ETA: 6s - loss: 0.3615 - accuracy: 0.8780
 1000/10000 [==>...........................] - ETA: 6s - loss: 0.4541 - accuracy: 0.8630
 1500/10000 [===>..........................] - ETA: 5s - loss: 0.4995 - accuracy: 0.8507
 2000/10000 [=====>........................] - ETA: 5s - loss: 0.5641 - accuracy: 0.8160
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.6420 - accuracy: 0.8032
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.6209 - accuracy: 0.8100
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.5975 - accuracy: 0.8160
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.5723 - accuracy: 0.8235
 4500/10000 [============>.................] - ETA: 3s - loss: 0.5444 - accuracy: 0.8324
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.5176 - accuracy: 0.8424
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4929 - accuracy: 0.8505
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4748 - accuracy: 0.8565
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.4529 - accuracy: 0.8635
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4369 - accuracy: 0.8680
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.4232 - accuracy: 0.8724
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.4082 - accuracy: 0.8773
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3971 - accuracy: 0.8806
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3890 - accuracy: 0.8833
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3803 - accuracy: 0.8858
10000/10000 [==============================] - 6s 618us/step - loss: 0.3721 - accuracy: 0.8884 - val_loss: 0.3381 - val_accuracy: 0.8988
Latency --- 33.60871648788452 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 10
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_9/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 14s - loss: 2.3011 - accuracy: 0.1200
 1000/10000 [==>...........................] - ETA: 10s - loss: 2.2881 - accuracy: 0.1320
 1500/10000 [===>..........................] - ETA: 7s - loss: 2.2783 - accuracy: 0.1567 
 2000/10000 [=====>........................] - ETA: 6s - loss: 2.2658 - accuracy: 0.1930
 2500/10000 [======>.......................] - ETA: 5s - loss: 2.2494 - accuracy: 0.2180
 3000/10000 [========>.....................] - ETA: 5s - loss: 2.2321 - accuracy: 0.2150
 3500/10000 [=========>....................] - ETA: 4s - loss: 2.2430 - accuracy: 0.2131
 4000/10000 [===========>..................] - ETA: 4s - loss: 2.2515 - accuracy: 0.2080
 4500/10000 [============>.................] - ETA: 3s - loss: 2.2458 - accuracy: 0.2140
 5000/10000 [==============>...............] - ETA: 3s - loss: 2.2376 - accuracy: 0.2206
 5500/10000 [===============>..............] - ETA: 3s - loss: 2.2259 - accuracy: 0.2371
 6000/10000 [=================>............] - ETA: 2s - loss: 2.2108 - accuracy: 0.2410
 6500/10000 [==================>...........] - ETA: 2s - loss: 2.2026 - accuracy: 0.2406
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1842 - accuracy: 0.2477
 7500/10000 [=====================>........] - ETA: 1s - loss: 2.1660 - accuracy: 0.2545
 8000/10000 [=======================>......] - ETA: 1s - loss: 2.1504 - accuracy: 0.2592
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1172 - accuracy: 0.2761
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1217 - accuracy: 0.2747
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1221 - accuracy: 0.2704
10000/10000 [==============================] - 7s 705us/step - loss: 2.1130 - accuracy: 0.2769 - val_loss: 1.8608 - val_accuracy: 0.3976
Epoch 2/5

  500/10000 [>.............................] - ETA: 6s - loss: 1.8284 - accuracy: 0.4120
 1000/10000 [==>...........................] - ETA: 5s - loss: 1.7507 - accuracy: 0.4460
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.6927 - accuracy: 0.4460
 2000/10000 [=====>........................] - ETA: 4s - loss: 1.6389 - accuracy: 0.4570
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.5910 - accuracy: 0.4616
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.5380 - accuracy: 0.4830
 3500/10000 [=========>....................] - ETA: 3s - loss: 1.5522 - accuracy: 0.4766
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.5585 - accuracy: 0.4748
 4500/10000 [============>.................] - ETA: 3s - loss: 1.5827 - accuracy: 0.4618
 5000/10000 [==============>...............] - ETA: 2s - loss: 1.5825 - accuracy: 0.4566
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.5559 - accuracy: 0.4635
 6000/10000 [=================>............] - ETA: 2s - loss: 1.5192 - accuracy: 0.4780
 6500/10000 [==================>...........] - ETA: 2s - loss: 1.4829 - accuracy: 0.4922
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.4570 - accuracy: 0.4997
 7500/10000 [=====================>........] - ETA: 1s - loss: 1.4928 - accuracy: 0.4935
 8000/10000 [=======================>......] - ETA: 1s - loss: 1.5176 - accuracy: 0.4857
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5266 - accuracy: 0.4834
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.5210 - accuracy: 0.4868
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5131 - accuracy: 0.4899
10000/10000 [==============================] - 6s 608us/step - loss: 1.5106 - accuracy: 0.4903 - val_loss: 1.3738 - val_accuracy: 0.5148
Epoch 3/5

  500/10000 [>.............................] - ETA: 7s - loss: 1.3508 - accuracy: 0.5140
 1000/10000 [==>...........................] - ETA: 6s - loss: 1.2416 - accuracy: 0.5990
 1500/10000 [===>..........................] - ETA: 5s - loss: 1.1717 - accuracy: 0.6127
 2000/10000 [=====>........................] - ETA: 5s - loss: 1.1515 - accuracy: 0.6175
 2500/10000 [======>.......................] - ETA: 4s - loss: 1.1489 - accuracy: 0.6156
 3000/10000 [========>.....................] - ETA: 4s - loss: 1.1919 - accuracy: 0.6077
 3500/10000 [=========>....................] - ETA: 4s - loss: 1.1689 - accuracy: 0.6117
 4000/10000 [===========>..................] - ETA: 3s - loss: 1.1374 - accuracy: 0.6263
 4500/10000 [============>.................] - ETA: 3s - loss: 1.1004 - accuracy: 0.6387
 5000/10000 [==============>...............] - ETA: 3s - loss: 1.0592 - accuracy: 0.6528
 5500/10000 [===============>..............] - ETA: 2s - loss: 1.0263 - accuracy: 0.6647
 6000/10000 [=================>............] - ETA: 2s - loss: 0.9982 - accuracy: 0.6722
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.9774 - accuracy: 0.6788
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.9594 - accuracy: 0.6850
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.9289 - accuracy: 0.6955
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.8997 - accuracy: 0.7067
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8695 - accuracy: 0.7172
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8412 - accuracy: 0.7268
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8208 - accuracy: 0.7340
10000/10000 [==============================] - 6s 627us/step - loss: 0.8034 - accuracy: 0.7389 - val_loss: 0.8404 - val_accuracy: 0.7780
Epoch 4/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.6953 - accuracy: 0.8140
 1000/10000 [==>...........................] - ETA: 4s - loss: 0.5921 - accuracy: 0.8310
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.5164 - accuracy: 0.8527
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.4692 - accuracy: 0.8660
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.4372 - accuracy: 0.8700
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.4348 - accuracy: 0.8710
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.4424 - accuracy: 0.8671
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.4505 - accuracy: 0.8622
 4500/10000 [============>.................] - ETA: 3s - loss: 0.4398 - accuracy: 0.8662
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.4264 - accuracy: 0.8694
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.4131 - accuracy: 0.8744
 6000/10000 [=================>............] - ETA: 2s - loss: 0.4004 - accuracy: 0.8783
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.3899 - accuracy: 0.8814
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3781 - accuracy: 0.8847
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.3682 - accuracy: 0.8871
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.3620 - accuracy: 0.8898
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3628 - accuracy: 0.8889
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3714 - accuracy: 0.8857
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3952 - accuracy: 0.8800
10000/10000 [==============================] - 6s 606us/step - loss: 0.3973 - accuracy: 0.8796 - val_loss: 0.3743 - val_accuracy: 0.8972
Epoch 5/5

  500/10000 [>.............................] - ETA: 5s - loss: 0.2954 - accuracy: 0.9140
 1000/10000 [==>...........................] - ETA: 5s - loss: 0.2591 - accuracy: 0.9270
 1500/10000 [===>..........................] - ETA: 4s - loss: 0.2420 - accuracy: 0.9307
 2000/10000 [=====>........................] - ETA: 4s - loss: 0.2295 - accuracy: 0.9345
 2500/10000 [======>.......................] - ETA: 4s - loss: 0.2403 - accuracy: 0.9296
 3000/10000 [========>.....................] - ETA: 4s - loss: 0.2314 - accuracy: 0.9347
 3500/10000 [=========>....................] - ETA: 3s - loss: 0.2339 - accuracy: 0.9334
 4000/10000 [===========>..................] - ETA: 3s - loss: 0.2344 - accuracy: 0.9330
 4500/10000 [============>.................] - ETA: 3s - loss: 0.2436 - accuracy: 0.9298
 5000/10000 [==============>...............] - ETA: 2s - loss: 0.2584 - accuracy: 0.9236
 5500/10000 [===============>..............] - ETA: 2s - loss: 0.2691 - accuracy: 0.9204
 6000/10000 [=================>............] - ETA: 2s - loss: 0.2686 - accuracy: 0.9200
 6500/10000 [==================>...........] - ETA: 2s - loss: 0.2710 - accuracy: 0.9205
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2654 - accuracy: 0.9227
 7500/10000 [=====================>........] - ETA: 1s - loss: 0.2596 - accuracy: 0.9241
 8000/10000 [=======================>......] - ETA: 1s - loss: 0.2549 - accuracy: 0.9250
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2522 - accuracy: 0.9267
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2486 - accuracy: 0.9279
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2450 - accuracy: 0.9287
10000/10000 [==============================] - 6s 605us/step - loss: 0.2421 - accuracy: 0.9296 - val_loss: 0.2663 - val_accuracy: 0.9180
Latency --- 33.368191957473755 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9200000166893005 and present is 0.9296000003814697
Saved model to disk
