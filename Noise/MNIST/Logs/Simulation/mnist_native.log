We are using Tensorflow version 1.15.2
Keras API version: 2.3.1
=====================Iteration========================== 1
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
Downloading data from https://s3.amazonaws.com/img-datasets/mnist.npz

    8192/11490434 [..............................] - ETA: 2:29
   40960/11490434 [..............................] - ETA: 1:00
   90112/11490434 [..............................] - ETA: 41s 
  212992/11490434 [..............................] - ETA: 23s
  417792/11490434 [>.............................] - ETA: 14s
  753664/11490434 [>.............................] - ETA: 9s 
 1482752/11490434 [==>...........................] - ETA: 4s
 1515520/11490434 [==>...........................] - ETA: 5s
 1941504/11490434 [====>.........................] - ETA: 4s
 2695168/11490434 [======>.......................] - ETA: 3s
 3481600/11490434 [========>.....................] - ETA: 2s
 4268032/11490434 [==========>...................] - ETA: 2s
 5070848/11490434 [============>.................] - ETA: 1s
 5890048/11490434 [==============>...............] - ETA: 1s
 6397952/11490434 [===============>..............] - ETA: 1s
 6807552/11490434 [================>.............] - ETA: 1s
 7217152/11490434 [=================>............] - ETA: 1s
 7626752/11490434 [==================>...........] - ETA: 0s
 8052736/11490434 [====================>.........] - ETA: 0s
 8478720/11490434 [=====================>........] - ETA: 0s
 8904704/11490434 [======================>.......] - ETA: 0s
 9347072/11490434 [=======================>......] - ETA: 0s
 9773056/11490434 [========================>.....] - ETA: 0s
10215424/11490434 [=========================>....] - ETA: 0s
10657792/11490434 [==========================>...] - ETA: 0s
11116544/11490434 [============================>.] - ETA: 0s
11493376/11490434 [==============================] - 3s 0us/step
in grads Tensor("loss/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3068 - accuracy: 0.0740
 1000/10000 [==>...........................] - ETA: 4s - loss: 2.2975 - accuracy: 0.1100
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2847 - accuracy: 0.1580
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2710 - accuracy: 0.1700
 2500/10000 [======>.......................] - ETA: 3s - loss: 2.2596 - accuracy: 0.2040
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2518 - accuracy: 0.2050
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2510 - accuracy: 0.2020
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2620 - accuracy: 0.1898
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2570 - accuracy: 0.2067
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2439 - accuracy: 0.2294
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.2226 - accuracy: 0.2529
 6000/10000 [=================>............] - ETA: 1s - loss: 2.1944 - accuracy: 0.2700
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.2083 - accuracy: 0.2582
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2412 - accuracy: 0.2484
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2420 - accuracy: 0.2400
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.2409 - accuracy: 0.2355
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2362 - accuracy: 0.2440
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2298 - accuracy: 0.2474
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2207 - accuracy: 0.2532
10000/10000 [==============================] - 4s 395us/step - loss: 2.2090 - accuracy: 0.2586 - val_loss: 2.0874 - val_accuracy: 0.3464
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.0757 - accuracy: 0.3340
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.9498 - accuracy: 0.3730
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.8606 - accuracy: 0.4247
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.7961 - accuracy: 0.4335
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.1519 - accuracy: 0.3884
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.1720 - accuracy: 0.3473
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.1598 - accuracy: 0.3354
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.1328 - accuracy: 0.3330
 4500/10000 [============>.................] - ETA: 2s - loss: 2.1056 - accuracy: 0.3293
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.0936 - accuracy: 0.3406
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.0748 - accuracy: 0.3462
 6000/10000 [=================>............] - ETA: 1s - loss: 2.0235 - accuracy: 0.3737
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.9529 - accuracy: 0.3920
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9699 - accuracy: 0.3830
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.0288 - accuracy: 0.3681
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.0484 - accuracy: 0.3571
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0607 - accuracy: 0.3513
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0625 - accuracy: 0.3512
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0555 - accuracy: 0.3494
10000/10000 [==============================] - 4s 379us/step - loss: 2.0479 - accuracy: 0.3486 - val_loss: 1.8395 - val_accuracy: 0.3360
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.8939 - accuracy: 0.3260
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.8993 - accuracy: 0.3540
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.7745 - accuracy: 0.4007
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.6644 - accuracy: 0.4410
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.5665 - accuracy: 0.4804
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.5143 - accuracy: 0.5003
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.5938 - accuracy: 0.4820
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.7336 - accuracy: 0.4487
 4500/10000 [============>.................] - ETA: 2s - loss: 1.7637 - accuracy: 0.4367
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.7619 - accuracy: 0.4444
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.7373 - accuracy: 0.4502
 6000/10000 [=================>............] - ETA: 1s - loss: 1.6953 - accuracy: 0.4703
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.6496 - accuracy: 0.4857
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6682 - accuracy: 0.4816
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.6861 - accuracy: 0.4804
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.6933 - accuracy: 0.4741
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6742 - accuracy: 0.4761
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.6674 - accuracy: 0.4797
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6518 - accuracy: 0.4823
10000/10000 [==============================] - 4s 377us/step - loss: 1.6388 - accuracy: 0.4834 - val_loss: 0.9430 - val_accuracy: 0.6860
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.9035 - accuracy: 0.7200
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.8560 - accuracy: 0.7290
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.8352 - accuracy: 0.7307
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.9071 - accuracy: 0.7045
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.9892 - accuracy: 0.6824
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.0129 - accuracy: 0.6753
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.9979 - accuracy: 0.6737
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.9819 - accuracy: 0.6770
 4500/10000 [============>.................] - ETA: 2s - loss: 0.9535 - accuracy: 0.6838
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.9199 - accuracy: 0.6970
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.8856 - accuracy: 0.7105
 6000/10000 [=================>............] - ETA: 1s - loss: 0.8519 - accuracy: 0.7233
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.8249 - accuracy: 0.7335
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.8023 - accuracy: 0.7399
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.7798 - accuracy: 0.7467
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.7560 - accuracy: 0.7540
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7382 - accuracy: 0.7596
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.7252 - accuracy: 0.7643
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.7168 - accuracy: 0.7686
10000/10000 [==============================] - 4s 378us/step - loss: 0.7034 - accuracy: 0.7729 - val_loss: 0.4696 - val_accuracy: 0.8644
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.3524 - accuracy: 0.8880
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.3516 - accuracy: 0.8930
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3560 - accuracy: 0.8873
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3518 - accuracy: 0.8895
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.3566 - accuracy: 0.8860
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.3519 - accuracy: 0.8887
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.3461 - accuracy: 0.8911
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.3453 - accuracy: 0.8932
 4500/10000 [============>.................] - ETA: 2s - loss: 0.3444 - accuracy: 0.8920
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.3351 - accuracy: 0.8938
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.3339 - accuracy: 0.8938
 6000/10000 [=================>............] - ETA: 1s - loss: 0.3403 - accuracy: 0.8910
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.3445 - accuracy: 0.8894
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3778 - accuracy: 0.8794
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4220 - accuracy: 0.8639
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.4781 - accuracy: 0.8482
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5046 - accuracy: 0.8394
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5074 - accuracy: 0.8393
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5018 - accuracy: 0.8428
10000/10000 [==============================] - 4s 380us/step - loss: 0.4956 - accuracy: 0.8453 - val_loss: 0.4130 - val_accuracy: 0.8804
Latency --- 19.346840143203735 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0 and present is 0.845300018787384
Saved model to disk
=====================Iteration========================== 2
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_1/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3078 - accuracy: 0.0820
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.2945 - accuracy: 0.1310
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2839 - accuracy: 0.1600
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2745 - accuracy: 0.1575
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.2632 - accuracy: 0.1564
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2551 - accuracy: 0.1547
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2484 - accuracy: 0.1463
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2319 - accuracy: 0.1715
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2068 - accuracy: 0.2089
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.1728 - accuracy: 0.2308
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.1863 - accuracy: 0.2282
 6000/10000 [=================>............] - ETA: 1s - loss: 2.2045 - accuracy: 0.2277
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.2050 - accuracy: 0.2298
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1968 - accuracy: 0.2396
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1810 - accuracy: 0.2472
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1541 - accuracy: 0.2535
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1243 - accuracy: 0.2653
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1666 - accuracy: 0.2614
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1652 - accuracy: 0.2623
10000/10000 [==============================] - 4s 391us/step - loss: 2.1566 - accuracy: 0.2636 - val_loss: 1.9455 - val_accuracy: 0.2888
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.8627 - accuracy: 0.3400
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.8507 - accuracy: 0.3240
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.8822 - accuracy: 0.3320
 2000/10000 [=====>........................] - ETA: 3s - loss: 1.8202 - accuracy: 0.3680
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.8153 - accuracy: 0.3628
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.9398 - accuracy: 0.3340
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.9827 - accuracy: 0.3154
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.0072 - accuracy: 0.3178
 4500/10000 [============>.................] - ETA: 2s - loss: 2.0076 - accuracy: 0.3287
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.9999 - accuracy: 0.3338
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.9745 - accuracy: 0.3509
 6000/10000 [=================>............] - ETA: 1s - loss: 1.9395 - accuracy: 0.3655
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.9409 - accuracy: 0.3626
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9831 - accuracy: 0.3519
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.9954 - accuracy: 0.3423
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.9916 - accuracy: 0.3483
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9706 - accuracy: 0.3566
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9404 - accuracy: 0.3746
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9022 - accuracy: 0.3888
10000/10000 [==============================] - 4s 382us/step - loss: 1.8635 - accuracy: 0.4016 - val_loss: 1.1340 - val_accuracy: 0.6536
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.9190 - accuracy: 0.7180
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.3031 - accuracy: 0.5890
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.7565 - accuracy: 0.5193
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.8679 - accuracy: 0.4620
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.9024 - accuracy: 0.4648
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.8717 - accuracy: 0.4550
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.8248 - accuracy: 0.4691
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.7635 - accuracy: 0.4875
 4500/10000 [============>.................] - ETA: 2s - loss: 1.7411 - accuracy: 0.4840
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.8389 - accuracy: 0.4674
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.8502 - accuracy: 0.4555
 6000/10000 [=================>............] - ETA: 1s - loss: 1.8297 - accuracy: 0.4655
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.7850 - accuracy: 0.4778
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.7214 - accuracy: 0.4944
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.6573 - accuracy: 0.5127
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.5977 - accuracy: 0.5306
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.5597 - accuracy: 0.5372
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.5443 - accuracy: 0.5388
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.5343 - accuracy: 0.5391
10000/10000 [==============================] - 4s 380us/step - loss: 1.5130 - accuracy: 0.5398 - val_loss: 0.8800 - val_accuracy: 0.7504
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.8131 - accuracy: 0.7580
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.7089 - accuracy: 0.8040
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.6318 - accuracy: 0.8220
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.5811 - accuracy: 0.8345
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.5686 - accuracy: 0.8304
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.5900 - accuracy: 0.8210
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.7207 - accuracy: 0.7926
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.7525 - accuracy: 0.7803
 4500/10000 [============>.................] - ETA: 2s - loss: 0.7471 - accuracy: 0.7804
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.7244 - accuracy: 0.7898
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.7026 - accuracy: 0.7989
 6000/10000 [=================>............] - ETA: 1s - loss: 0.6787 - accuracy: 0.8070
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.6601 - accuracy: 0.8123
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.6452 - accuracy: 0.8146
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.6362 - accuracy: 0.8168
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.6329 - accuracy: 0.8166
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.6280 - accuracy: 0.8160
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.6316 - accuracy: 0.8130
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.6356 - accuracy: 0.8117
10000/10000 [==============================] - 4s 382us/step - loss: 0.6316 - accuracy: 0.8122 - val_loss: 0.4484 - val_accuracy: 0.8784
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.3421 - accuracy: 0.9020
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.3183 - accuracy: 0.9070
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3123 - accuracy: 0.9140
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3133 - accuracy: 0.9155
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.3034 - accuracy: 0.9168
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.3068 - accuracy: 0.9153
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.3019 - accuracy: 0.9157
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.2942 - accuracy: 0.9190
 4500/10000 [============>.................] - ETA: 2s - loss: 0.2963 - accuracy: 0.9156
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.3047 - accuracy: 0.9120
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.3114 - accuracy: 0.9069
 6000/10000 [=================>............] - ETA: 1s - loss: 0.3178 - accuracy: 0.9052
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.3232 - accuracy: 0.9028
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3196 - accuracy: 0.9046
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.3160 - accuracy: 0.9068
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.3135 - accuracy: 0.9071
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3097 - accuracy: 0.9079
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3041 - accuracy: 0.9091
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3008 - accuracy: 0.9097
10000/10000 [==============================] - 4s 382us/step - loss: 0.3006 - accuracy: 0.9105 - val_loss: 0.3330 - val_accuracy: 0.9064
Latency --- 19.412642002105713 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.845300018787384 and present is 0.9104999899864197
Saved model to disk
=====================Iteration========================== 3
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_2/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3133 - accuracy: 0.1240
 1000/10000 [==>...........................] - ETA: 4s - loss: 2.3026 - accuracy: 0.1940
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.3010 - accuracy: 0.1713
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2946 - accuracy: 0.1730
 2500/10000 [======>.......................] - ETA: 3s - loss: 2.2895 - accuracy: 0.1864
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2835 - accuracy: 0.2020
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2767 - accuracy: 0.2217
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2697 - accuracy: 0.2352
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2624 - accuracy: 0.2453
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2530 - accuracy: 0.2412
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.2468 - accuracy: 0.2435
 6000/10000 [=================>............] - ETA: 1s - loss: 2.2463 - accuracy: 0.2318
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.2418 - accuracy: 0.2291
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2285 - accuracy: 0.2420
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2094 - accuracy: 0.2493
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1869 - accuracy: 0.2601
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1687 - accuracy: 0.2676
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2375 - accuracy: 0.2582
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2420 - accuracy: 0.2532
10000/10000 [==============================] - 4s 393us/step - loss: 2.2417 - accuracy: 0.2553 - val_loss: 2.1990 - val_accuracy: 0.2824
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.2088 - accuracy: 0.2700
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.1819 - accuracy: 0.3050
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.1488 - accuracy: 0.3167
 2000/10000 [=====>........................] - ETA: 2s - loss: 2.1155 - accuracy: 0.3300
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.0911 - accuracy: 0.3264
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.0647 - accuracy: 0.3343
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.0420 - accuracy: 0.3440
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.0538 - accuracy: 0.3170
 4500/10000 [============>.................] - ETA: 2s - loss: 2.0485 - accuracy: 0.3053
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.0533 - accuracy: 0.2984
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.0473 - accuracy: 0.3029
 6000/10000 [=================>............] - ETA: 1s - loss: 2.0250 - accuracy: 0.3112
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.9943 - accuracy: 0.3212
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9704 - accuracy: 0.3270
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.9727 - accuracy: 0.3261
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.9679 - accuracy: 0.3355
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9401 - accuracy: 0.3461
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9021 - accuracy: 0.3572
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.8701 - accuracy: 0.3711
10000/10000 [==============================] - 4s 380us/step - loss: 1.8431 - accuracy: 0.3794 - val_loss: 2.1725 - val_accuracy: 0.3304
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.2067 - accuracy: 0.3160
 1000/10000 [==>...........................] - ETA: 3s - loss: 3.0096 - accuracy: 0.2510
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.7279 - accuracy: 0.2860
 2000/10000 [=====>........................] - ETA: 2s - loss: 2.5652 - accuracy: 0.3130
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.4560 - accuracy: 0.3328
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.3592 - accuracy: 0.3537
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2877 - accuracy: 0.3760
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2132 - accuracy: 0.3835
 4500/10000 [============>.................] - ETA: 2s - loss: 2.1578 - accuracy: 0.3889
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.0923 - accuracy: 0.3984
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.0492 - accuracy: 0.3995
 6000/10000 [=================>............] - ETA: 1s - loss: 2.0046 - accuracy: 0.4045
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.9750 - accuracy: 0.4129
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.9381 - accuracy: 0.4276
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.8829 - accuracy: 0.4453
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.8258 - accuracy: 0.4638
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.7769 - accuracy: 0.4787
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.7777 - accuracy: 0.4794
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7889 - accuracy: 0.4705
10000/10000 [==============================] - 4s 378us/step - loss: 1.7795 - accuracy: 0.4711 - val_loss: 1.6929 - val_accuracy: 0.3964
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.6172 - accuracy: 0.4580
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.3823 - accuracy: 0.5760
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.2369 - accuracy: 0.6300
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.1255 - accuracy: 0.6720
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.0450 - accuracy: 0.6916
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.0322 - accuracy: 0.6917
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.0612 - accuracy: 0.6869
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.0729 - accuracy: 0.6765
 4500/10000 [============>.................] - ETA: 2s - loss: 1.0791 - accuracy: 0.6698
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.0924 - accuracy: 0.6588
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.0775 - accuracy: 0.6636
 6000/10000 [=================>............] - ETA: 1s - loss: 1.0393 - accuracy: 0.6775
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.0004 - accuracy: 0.6906
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.9669 - accuracy: 0.7017
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9396 - accuracy: 0.7109
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.9147 - accuracy: 0.7181
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8929 - accuracy: 0.7249
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8718 - accuracy: 0.7313
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8589 - accuracy: 0.7346
10000/10000 [==============================] - 4s 379us/step - loss: 0.8411 - accuracy: 0.7397 - val_loss: 0.4602 - val_accuracy: 0.8684
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.3641 - accuracy: 0.8980
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.3534 - accuracy: 0.8990
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3482 - accuracy: 0.8967
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3399 - accuracy: 0.8985
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.3606 - accuracy: 0.8920
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.3636 - accuracy: 0.8927
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.3680 - accuracy: 0.8891
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.3635 - accuracy: 0.8905
 4500/10000 [============>.................] - ETA: 2s - loss: 0.3608 - accuracy: 0.8904
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.3525 - accuracy: 0.8932
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.3505 - accuracy: 0.8940
 6000/10000 [=================>............] - ETA: 1s - loss: 0.3504 - accuracy: 0.8953
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.3447 - accuracy: 0.8965
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3508 - accuracy: 0.8931
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.3604 - accuracy: 0.8908
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.3602 - accuracy: 0.8895
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3601 - accuracy: 0.8894
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3552 - accuracy: 0.8911
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3520 - accuracy: 0.8922
10000/10000 [==============================] - 4s 380us/step - loss: 0.3477 - accuracy: 0.8941 - val_loss: 0.3552 - val_accuracy: 0.8936
Latency --- 19.360130310058594 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 4
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_3/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3262 - accuracy: 0.1040
 1000/10000 [==>...........................] - ETA: 4s - loss: 2.3096 - accuracy: 0.1170
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.3032 - accuracy: 0.1227
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2928 - accuracy: 0.1545
 2500/10000 [======>.......................] - ETA: 3s - loss: 2.2853 - accuracy: 0.1552
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2799 - accuracy: 0.1620
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2758 - accuracy: 0.1569
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2707 - accuracy: 0.1635
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2626 - accuracy: 0.1700
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2502 - accuracy: 0.1904
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.2386 - accuracy: 0.2093
 6000/10000 [=================>............] - ETA: 1s - loss: 2.2390 - accuracy: 0.2108
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.2385 - accuracy: 0.2037
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2334 - accuracy: 0.2129
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2260 - accuracy: 0.2151
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.2211 - accuracy: 0.2173
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2236 - accuracy: 0.2241
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2192 - accuracy: 0.2257
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2067 - accuracy: 0.2377
10000/10000 [==============================] - 4s 398us/step - loss: 2.1892 - accuracy: 0.2469 - val_loss: 1.9462 - val_accuracy: 0.3424
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.9104 - accuracy: 0.3280
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.0989 - accuracy: 0.2510
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.0768 - accuracy: 0.2733
 2000/10000 [=====>........................] - ETA: 2s - loss: 2.0187 - accuracy: 0.3245
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.9330 - accuracy: 0.3708
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.8734 - accuracy: 0.3930
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.9721 - accuracy: 0.3637
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.9908 - accuracy: 0.3402
 4500/10000 [============>.................] - ETA: 2s - loss: 1.9792 - accuracy: 0.3587
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.9458 - accuracy: 0.3840
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.8886 - accuracy: 0.4113
 6000/10000 [=================>............] - ETA: 1s - loss: 1.8320 - accuracy: 0.4357
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.8381 - accuracy: 0.4331
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.8830 - accuracy: 0.4184
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.8817 - accuracy: 0.4163
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.8631 - accuracy: 0.4281
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8327 - accuracy: 0.4415
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.7990 - accuracy: 0.4538
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7677 - accuracy: 0.4606
10000/10000 [==============================] - 4s 381us/step - loss: 1.7550 - accuracy: 0.4632 - val_loss: 1.7354 - val_accuracy: 0.5048
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.6771 - accuracy: 0.5280
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.4913 - accuracy: 0.5860
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.3017 - accuracy: 0.6493
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.1666 - accuracy: 0.6800
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.1053 - accuracy: 0.6856
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.1862 - accuracy: 0.6640
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.2058 - accuracy: 0.6529
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.2022 - accuracy: 0.6440
 4500/10000 [============>.................] - ETA: 2s - loss: 1.1559 - accuracy: 0.6638
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.1068 - accuracy: 0.6802
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.0561 - accuracy: 0.6947
 6000/10000 [=================>............] - ETA: 1s - loss: 1.0136 - accuracy: 0.7075
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.9730 - accuracy: 0.7189
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.9412 - accuracy: 0.7280
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9058 - accuracy: 0.7380
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.8729 - accuracy: 0.7474
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8477 - accuracy: 0.7547
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8247 - accuracy: 0.7609
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8130 - accuracy: 0.7632
10000/10000 [==============================] - 4s 383us/step - loss: 0.8214 - accuracy: 0.7593 - val_loss: 1.0396 - val_accuracy: 0.6100
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.0441 - accuracy: 0.5880
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.9688 - accuracy: 0.6220
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.8531 - accuracy: 0.6873
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.7598 - accuracy: 0.7355
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.6904 - accuracy: 0.7688
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.6335 - accuracy: 0.7933
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.5834 - accuracy: 0.8123
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.5533 - accuracy: 0.8240
 4500/10000 [============>.................] - ETA: 2s - loss: 0.5321 - accuracy: 0.8327
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.5103 - accuracy: 0.8398
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.4963 - accuracy: 0.8449
 6000/10000 [=================>............] - ETA: 1s - loss: 0.4835 - accuracy: 0.8517
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.4646 - accuracy: 0.8582
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4495 - accuracy: 0.8631
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4372 - accuracy: 0.8676
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.4230 - accuracy: 0.8731
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4160 - accuracy: 0.8752
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4135 - accuracy: 0.8757
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4097 - accuracy: 0.8759
10000/10000 [==============================] - 4s 383us/step - loss: 0.4073 - accuracy: 0.8766 - val_loss: 0.4932 - val_accuracy: 0.8444
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.3327 - accuracy: 0.9020
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.3526 - accuracy: 0.9020
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3341 - accuracy: 0.9060
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3113 - accuracy: 0.9075
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.2932 - accuracy: 0.9140
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.2713 - accuracy: 0.9207
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.2664 - accuracy: 0.9220
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.2592 - accuracy: 0.9243
 4500/10000 [============>.................] - ETA: 2s - loss: 0.2557 - accuracy: 0.9249
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.2593 - accuracy: 0.9260
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.2611 - accuracy: 0.9242
 6000/10000 [=================>............] - ETA: 1s - loss: 0.2626 - accuracy: 0.9250
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.2589 - accuracy: 0.9262
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2629 - accuracy: 0.9251
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2612 - accuracy: 0.9259
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.2639 - accuracy: 0.9249
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2742 - accuracy: 0.9215
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3002 - accuracy: 0.9128
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3317 - accuracy: 0.9060
10000/10000 [==============================] - 4s 383us/step - loss: 0.3599 - accuracy: 0.8969 - val_loss: 0.5336 - val_accuracy: 0.8584
Latency --- 19.561976432800293 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 5
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_4/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3482 - accuracy: 0.1060
 1000/10000 [==>...........................] - ETA: 4s - loss: 2.3250 - accuracy: 0.0970
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.3102 - accuracy: 0.1433
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2982 - accuracy: 0.1760
 2500/10000 [======>.......................] - ETA: 3s - loss: 2.2849 - accuracy: 0.2100
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2704 - accuracy: 0.2360
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2551 - accuracy: 0.2360
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2410 - accuracy: 0.2428
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2284 - accuracy: 0.2364
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2359 - accuracy: 0.2262
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.2303 - accuracy: 0.2287
 6000/10000 [=================>............] - ETA: 1s - loss: 2.2097 - accuracy: 0.2495
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.1752 - accuracy: 0.2695
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1665 - accuracy: 0.2699
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1644 - accuracy: 0.2732
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1523 - accuracy: 0.2814
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1250 - accuracy: 0.2953
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1693 - accuracy: 0.2877
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1823 - accuracy: 0.2815
10000/10000 [==============================] - 4s 394us/step - loss: 2.1849 - accuracy: 0.2809 - val_loss: 2.1694 - val_accuracy: 0.3300
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.1592 - accuracy: 0.3420
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.1068 - accuracy: 0.3380
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.0512 - accuracy: 0.3640
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.9557 - accuracy: 0.3860
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.8881 - accuracy: 0.4040
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.8217 - accuracy: 0.4333
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.7557 - accuracy: 0.4566
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.7883 - accuracy: 0.4380
 4500/10000 [============>.................] - ETA: 2s - loss: 1.8644 - accuracy: 0.4111
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.8997 - accuracy: 0.3886
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.9104 - accuracy: 0.3836
 6000/10000 [=================>............] - ETA: 1s - loss: 1.8869 - accuracy: 0.3910
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.8523 - accuracy: 0.4000
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.8107 - accuracy: 0.4123
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7776 - accuracy: 0.4207
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.7635 - accuracy: 0.4221
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.7654 - accuracy: 0.4191
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.7437 - accuracy: 0.4274
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7142 - accuracy: 0.4376
10000/10000 [==============================] - 4s 377us/step - loss: 1.6836 - accuracy: 0.4472 - val_loss: 2.0275 - val_accuracy: 0.3204
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.0882 - accuracy: 0.3080
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.7209 - accuracy: 0.4520
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.5007 - accuracy: 0.5107
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.3712 - accuracy: 0.5520
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.2726 - accuracy: 0.5844
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.2293 - accuracy: 0.6027
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.2564 - accuracy: 0.5917
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.2450 - accuracy: 0.5955
 4500/10000 [============>.................] - ETA: 2s - loss: 1.1990 - accuracy: 0.6133
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.1554 - accuracy: 0.6328
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.1063 - accuracy: 0.6449
 6000/10000 [=================>............] - ETA: 1s - loss: 1.0852 - accuracy: 0.6513
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.0626 - accuracy: 0.6586
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.0604 - accuracy: 0.6586
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.0269 - accuracy: 0.6687
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.9959 - accuracy: 0.6786
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9604 - accuracy: 0.6907
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.9302 - accuracy: 0.7008
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.9095 - accuracy: 0.7074
10000/10000 [==============================] - 4s 380us/step - loss: 0.8942 - accuracy: 0.7112 - val_loss: 0.7564 - val_accuracy: 0.7604
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.5456 - accuracy: 0.8160
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.5150 - accuracy: 0.8400
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.5013 - accuracy: 0.8387
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.4921 - accuracy: 0.8480
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.4858 - accuracy: 0.8492
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.5341 - accuracy: 0.8390
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.5476 - accuracy: 0.8331
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.5538 - accuracy: 0.8282
 4500/10000 [============>.................] - ETA: 2s - loss: 0.5538 - accuracy: 0.8273
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.5461 - accuracy: 0.8290
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.5325 - accuracy: 0.8338
 6000/10000 [=================>............] - ETA: 1s - loss: 0.5200 - accuracy: 0.8387
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.5065 - accuracy: 0.8429
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4929 - accuracy: 0.8471
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4803 - accuracy: 0.8523
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.4699 - accuracy: 0.8554
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4582 - accuracy: 0.8588
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4519 - accuracy: 0.8608
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4466 - accuracy: 0.8625
10000/10000 [==============================] - 4s 380us/step - loss: 0.4477 - accuracy: 0.8618 - val_loss: 0.6882 - val_accuracy: 0.7692
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.4200 - accuracy: 0.8540
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.4684 - accuracy: 0.8400
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.4267 - accuracy: 0.8613
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3957 - accuracy: 0.8755
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.3617 - accuracy: 0.8860
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.3497 - accuracy: 0.8910
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.3464 - accuracy: 0.8926
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.3489 - accuracy: 0.8915
 4500/10000 [============>.................] - ETA: 2s - loss: 0.3543 - accuracy: 0.8907
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.3690 - accuracy: 0.8850
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.3715 - accuracy: 0.8842
 6000/10000 [=================>............] - ETA: 1s - loss: 0.3735 - accuracy: 0.8835
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.3675 - accuracy: 0.8862
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3617 - accuracy: 0.8890
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.3501 - accuracy: 0.8932
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.3455 - accuracy: 0.8951
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.3395 - accuracy: 0.8972
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.3309 - accuracy: 0.8997
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.3257 - accuracy: 0.9018
10000/10000 [==============================] - 4s 381us/step - loss: 0.3201 - accuracy: 0.9037 - val_loss: 0.2956 - val_accuracy: 0.9120
Latency --- 19.420061111450195 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 6
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_5/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.2836 - accuracy: 0.1600
 1000/10000 [==>...........................] - ETA: 4s - loss: 2.2636 - accuracy: 0.2090
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2475 - accuracy: 0.2060
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2360 - accuracy: 0.2025
 2500/10000 [======>.......................] - ETA: 3s - loss: 2.2408 - accuracy: 0.1940
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2563 - accuracy: 0.1813
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2517 - accuracy: 0.1691
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2370 - accuracy: 0.1972
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2107 - accuracy: 0.2256
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.1813 - accuracy: 0.2400
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.1642 - accuracy: 0.2471
 6000/10000 [=================>............] - ETA: 1s - loss: 2.1600 - accuracy: 0.2378
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.1806 - accuracy: 0.2352
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1791 - accuracy: 0.2296
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1677 - accuracy: 0.2409
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1479 - accuracy: 0.2504
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1173 - accuracy: 0.2656
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0826 - accuracy: 0.2800
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0992 - accuracy: 0.2782
10000/10000 [==============================] - 4s 394us/step - loss: 2.1047 - accuracy: 0.2719 - val_loss: 2.0379 - val_accuracy: 0.2648
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.0367 - accuracy: 0.2680
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.8700 - accuracy: 0.3640
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.7441 - accuracy: 0.3840
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.7531 - accuracy: 0.3810
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.8054 - accuracy: 0.3860
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.7975 - accuracy: 0.3747
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.7365 - accuracy: 0.4169
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.6572 - accuracy: 0.4420
 4500/10000 [============>.................] - ETA: 2s - loss: 1.5989 - accuracy: 0.4647
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.6665 - accuracy: 0.4538
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.7101 - accuracy: 0.4438
 6000/10000 [=================>............] - ETA: 1s - loss: 1.7329 - accuracy: 0.4293
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.7469 - accuracy: 0.4262
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.7344 - accuracy: 0.4276
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7113 - accuracy: 0.4383
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.6782 - accuracy: 0.4540
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.6394 - accuracy: 0.4709
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.6188 - accuracy: 0.4749
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6399 - accuracy: 0.4687
10000/10000 [==============================] - 4s 378us/step - loss: 1.6418 - accuracy: 0.4736 - val_loss: 1.3318 - val_accuracy: 0.5112
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.3001 - accuracy: 0.5600
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.1778 - accuracy: 0.6160
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.0589 - accuracy: 0.6487
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.0037 - accuracy: 0.6645
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.1642 - accuracy: 0.6416
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.1843 - accuracy: 0.6330
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.1462 - accuracy: 0.6434
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.1103 - accuracy: 0.6582
 4500/10000 [============>.................] - ETA: 2s - loss: 1.0522 - accuracy: 0.6738
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.0017 - accuracy: 0.6898
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.9599 - accuracy: 0.7025
 6000/10000 [=================>............] - ETA: 1s - loss: 0.9204 - accuracy: 0.7145
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.8827 - accuracy: 0.7268
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.8531 - accuracy: 0.7340
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.8358 - accuracy: 0.7373
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.8496 - accuracy: 0.7310
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9286 - accuracy: 0.7188
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.0326 - accuracy: 0.7004
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0698 - accuracy: 0.6861
10000/10000 [==============================] - 4s 380us/step - loss: 1.0889 - accuracy: 0.6792 - val_loss: 1.2526 - val_accuracy: 0.5840
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.2535 - accuracy: 0.6020
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.1896 - accuracy: 0.6300
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.2631 - accuracy: 0.5933
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.2401 - accuracy: 0.6270
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.1470 - accuracy: 0.6576
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.0579 - accuracy: 0.6860
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.9821 - accuracy: 0.7066
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.9491 - accuracy: 0.7128
 4500/10000 [============>.................] - ETA: 2s - loss: 0.9451 - accuracy: 0.7096
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.9414 - accuracy: 0.7036
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.9145 - accuracy: 0.7138
 6000/10000 [=================>............] - ETA: 1s - loss: 0.8758 - accuracy: 0.7278
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.8350 - accuracy: 0.7408
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.8036 - accuracy: 0.7520
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.7696 - accuracy: 0.7623
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.7451 - accuracy: 0.7699
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.7225 - accuracy: 0.7771
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.7036 - accuracy: 0.7834
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.6862 - accuracy: 0.7891
10000/10000 [==============================] - 4s 382us/step - loss: 0.6709 - accuracy: 0.7932 - val_loss: 0.4510 - val_accuracy: 0.8472
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.3250 - accuracy: 0.8960
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.3782 - accuracy: 0.8810
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3588 - accuracy: 0.8880
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3315 - accuracy: 0.8990
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.3291 - accuracy: 0.8976
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.3192 - accuracy: 0.9017
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.3110 - accuracy: 0.9023
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.3083 - accuracy: 0.9040
 4500/10000 [============>.................] - ETA: 2s - loss: 0.3136 - accuracy: 0.9020
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.3141 - accuracy: 0.9022
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.3132 - accuracy: 0.9024
 6000/10000 [=================>............] - ETA: 1s - loss: 0.3093 - accuracy: 0.9032
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.3068 - accuracy: 0.9037
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.3045 - accuracy: 0.9043
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.3006 - accuracy: 0.9056
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.2986 - accuracy: 0.9059
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2952 - accuracy: 0.9073
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2915 - accuracy: 0.9088
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2875 - accuracy: 0.9098
10000/10000 [==============================] - 4s 380us/step - loss: 0.2824 - accuracy: 0.9120 - val_loss: 0.2878 - val_accuracy: 0.9128
Latency --- 19.460880041122437 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9104999899864197 and present is 0.9120000004768372
Saved model to disk
=====================Iteration========================== 7
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_6/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3192 - accuracy: 0.0780
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.3080 - accuracy: 0.0780
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2977 - accuracy: 0.0847
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2898 - accuracy: 0.0995
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.2815 - accuracy: 0.1088
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2726 - accuracy: 0.1130
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2659 - accuracy: 0.1146
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2581 - accuracy: 0.1198
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2517 - accuracy: 0.1256
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2534 - accuracy: 0.1266
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.2541 - accuracy: 0.1284
 6000/10000 [=================>............] - ETA: 1s - loss: 2.2485 - accuracy: 0.1492
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.2380 - accuracy: 0.1575
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2230 - accuracy: 0.1661
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.2145 - accuracy: 0.1656
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.2438 - accuracy: 0.1630
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.2450 - accuracy: 0.1692
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2442 - accuracy: 0.1789
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2405 - accuracy: 0.1886
10000/10000 [==============================] - 4s 391us/step - loss: 2.2337 - accuracy: 0.1977 - val_loss: 2.0251 - val_accuracy: 0.4120
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.0346 - accuracy: 0.3880
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.9521 - accuracy: 0.4830
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.8668 - accuracy: 0.4647
 2000/10000 [=====>........................] - ETA: 3s - loss: 1.8321 - accuracy: 0.4555
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.9233 - accuracy: 0.4256
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.9291 - accuracy: 0.4390
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.9012 - accuracy: 0.4471
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.8978 - accuracy: 0.4347
 4500/10000 [============>.................] - ETA: 2s - loss: 1.8906 - accuracy: 0.4300
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.8630 - accuracy: 0.4482
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.8112 - accuracy: 0.4675
 6000/10000 [=================>............] - ETA: 1s - loss: 1.7520 - accuracy: 0.4847
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.7320 - accuracy: 0.4855
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.8463 - accuracy: 0.4724
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.8583 - accuracy: 0.4703
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.8549 - accuracy: 0.4700
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.8352 - accuracy: 0.4756
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.8083 - accuracy: 0.4793
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.7718 - accuracy: 0.4898
10000/10000 [==============================] - 4s 380us/step - loss: 1.7342 - accuracy: 0.4980 - val_loss: 1.0253 - val_accuracy: 0.6724
Epoch 3/5

  500/10000 [>.............................] - ETA: 2s - loss: 1.0092 - accuracy: 0.6420
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.0093 - accuracy: 0.6520
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.1603 - accuracy: 0.5967
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.2707 - accuracy: 0.5545
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.2376 - accuracy: 0.5772
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.1823 - accuracy: 0.6003
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.1159 - accuracy: 0.6254
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.0767 - accuracy: 0.6375
 4500/10000 [============>.................] - ETA: 2s - loss: 1.2026 - accuracy: 0.6160
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.3223 - accuracy: 0.5940
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.4184 - accuracy: 0.5622
 6000/10000 [=================>............] - ETA: 1s - loss: 1.4676 - accuracy: 0.5565
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.4886 - accuracy: 0.5543
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.4808 - accuracy: 0.5596
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.4690 - accuracy: 0.5671
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.4563 - accuracy: 0.5683
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.4533 - accuracy: 0.5702
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.4509 - accuracy: 0.5654
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.4281 - accuracy: 0.5717
10000/10000 [==============================] - 4s 376us/step - loss: 1.3975 - accuracy: 0.5817 - val_loss: 0.8360 - val_accuracy: 0.7148
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.7082 - accuracy: 0.7640
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.8890 - accuracy: 0.7270
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.8535 - accuracy: 0.7340
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.7874 - accuracy: 0.7615
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.7364 - accuracy: 0.7788
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.7257 - accuracy: 0.7817
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.7281 - accuracy: 0.7797
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.7293 - accuracy: 0.7763
 4500/10000 [============>.................] - ETA: 2s - loss: 0.6966 - accuracy: 0.7904
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.6649 - accuracy: 0.7998
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.6358 - accuracy: 0.8085
 6000/10000 [=================>............] - ETA: 1s - loss: 0.6170 - accuracy: 0.8152
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.5986 - accuracy: 0.8206
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5837 - accuracy: 0.8244
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.5756 - accuracy: 0.8257
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.5715 - accuracy: 0.8274
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.5636 - accuracy: 0.8295
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.5510 - accuracy: 0.8341
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.5393 - accuracy: 0.8375
10000/10000 [==============================] - 4s 380us/step - loss: 0.5251 - accuracy: 0.8413 - val_loss: 0.3662 - val_accuracy: 0.8940
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.2673 - accuracy: 0.9160
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.2587 - accuracy: 0.9290
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.2620 - accuracy: 0.9247
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.2584 - accuracy: 0.9245
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.2834 - accuracy: 0.9188
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.2819 - accuracy: 0.9210
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.2863 - accuracy: 0.9194
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.2881 - accuracy: 0.9187
 4500/10000 [============>.................] - ETA: 2s - loss: 0.2843 - accuracy: 0.9171
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.2796 - accuracy: 0.9180
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.2760 - accuracy: 0.9193
 6000/10000 [=================>............] - ETA: 1s - loss: 0.2732 - accuracy: 0.9193
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.2708 - accuracy: 0.9202
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2667 - accuracy: 0.9223
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2631 - accuracy: 0.9236
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.2638 - accuracy: 0.9231
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2644 - accuracy: 0.9233
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2639 - accuracy: 0.9232
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2666 - accuracy: 0.9226
10000/10000 [==============================] - 4s 381us/step - loss: 0.2671 - accuracy: 0.9219 - val_loss: 0.3311 - val_accuracy: 0.8960
Latency --- 19.422215461730957 seconds ---
Trained with vanilla non-private SGD optimizer
Saving model with new accuracy, previous accuracy was 0.9120000004768372 and present is 0.9218999743461609
Saved model to disk
=====================Iteration========================== 8
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_7/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3021 - accuracy: 0.0880
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.2954 - accuracy: 0.1300
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2855 - accuracy: 0.1727
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2778 - accuracy: 0.1715
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.2693 - accuracy: 0.1812
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2566 - accuracy: 0.2003
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2427 - accuracy: 0.2300
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2300 - accuracy: 0.2268
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2339 - accuracy: 0.2142
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2294 - accuracy: 0.2242
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.2192 - accuracy: 0.2275
 6000/10000 [=================>............] - ETA: 1s - loss: 2.2086 - accuracy: 0.2217
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.2082 - accuracy: 0.2140
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.2022 - accuracy: 0.2124
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1855 - accuracy: 0.2269
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1575 - accuracy: 0.2491
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1273 - accuracy: 0.2625
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.2062 - accuracy: 0.2522
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.2170 - accuracy: 0.2456
10000/10000 [==============================] - 4s 391us/step - loss: 2.2198 - accuracy: 0.2401 - val_loss: 2.2474 - val_accuracy: 0.2464
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 2.2447 - accuracy: 0.2340
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.2297 - accuracy: 0.2650
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2076 - accuracy: 0.2767
 2000/10000 [=====>........................] - ETA: 2s - loss: 2.1909 - accuracy: 0.2710
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.1644 - accuracy: 0.2932
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.1264 - accuracy: 0.2983
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.0935 - accuracy: 0.3171
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.0753 - accuracy: 0.3128
 4500/10000 [============>.................] - ETA: 2s - loss: 2.0872 - accuracy: 0.3049
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.0873 - accuracy: 0.2936
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.0838 - accuracy: 0.2965
 6000/10000 [=================>............] - ETA: 1s - loss: 2.0526 - accuracy: 0.3135
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.0285 - accuracy: 0.3238
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0268 - accuracy: 0.3266
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.0073 - accuracy: 0.3276
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.9843 - accuracy: 0.3371
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.9716 - accuracy: 0.3355
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.9886 - accuracy: 0.3324
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.9946 - accuracy: 0.3366
10000/10000 [==============================] - 4s 377us/step - loss: 1.9855 - accuracy: 0.3409 - val_loss: 1.5410 - val_accuracy: 0.5768
Epoch 3/5

  500/10000 [>.............................] - ETA: 2s - loss: 1.5247 - accuracy: 0.6120
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.4603 - accuracy: 0.5400
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.7191 - accuracy: 0.4400
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.7888 - accuracy: 0.4035
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.7614 - accuracy: 0.4120
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.7073 - accuracy: 0.4303
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.6405 - accuracy: 0.4509
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.5762 - accuracy: 0.4742
 4500/10000 [============>.................] - ETA: 1s - loss: 1.5337 - accuracy: 0.4853
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.5744 - accuracy: 0.4786
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.5729 - accuracy: 0.4758
 6000/10000 [=================>............] - ETA: 1s - loss: 1.5404 - accuracy: 0.4845
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.5217 - accuracy: 0.4885
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.4899 - accuracy: 0.4986
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.4726 - accuracy: 0.5043
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.4868 - accuracy: 0.5039
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.4874 - accuracy: 0.5088
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.4572 - accuracy: 0.5193
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.4325 - accuracy: 0.5264
10000/10000 [==============================] - 4s 375us/step - loss: 1.3993 - accuracy: 0.5383 - val_loss: 0.8209 - val_accuracy: 0.7592
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.7365 - accuracy: 0.8060
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.7158 - accuracy: 0.7880
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.7474 - accuracy: 0.7627
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.9456 - accuracy: 0.7015
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.1493 - accuracy: 0.6348
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.1655 - accuracy: 0.6270
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.1231 - accuracy: 0.6403
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.0912 - accuracy: 0.6430
 4500/10000 [============>.................] - ETA: 2s - loss: 1.0709 - accuracy: 0.6482
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.0852 - accuracy: 0.6430
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.0919 - accuracy: 0.6418
 6000/10000 [=================>............] - ETA: 1s - loss: 1.0797 - accuracy: 0.6463
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.0460 - accuracy: 0.6595
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.0107 - accuracy: 0.6730
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.9801 - accuracy: 0.6821
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.9514 - accuracy: 0.6926
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.9213 - accuracy: 0.7026
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8994 - accuracy: 0.7101
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8840 - accuracy: 0.7155
10000/10000 [==============================] - 4s 379us/step - loss: 0.8851 - accuracy: 0.7149 - val_loss: 1.0134 - val_accuracy: 0.6400
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.9098 - accuracy: 0.6520
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.7701 - accuracy: 0.7350
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.6758 - accuracy: 0.7773
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.5910 - accuracy: 0.8095
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.5484 - accuracy: 0.8236
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.5267 - accuracy: 0.8340
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.5137 - accuracy: 0.8386
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.5000 - accuracy: 0.8413
 4500/10000 [============>.................] - ETA: 2s - loss: 0.5019 - accuracy: 0.8424
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.4922 - accuracy: 0.8466
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.4860 - accuracy: 0.8493
 6000/10000 [=================>............] - ETA: 1s - loss: 0.4799 - accuracy: 0.8512
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.4882 - accuracy: 0.8482
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.4820 - accuracy: 0.8506
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.4741 - accuracy: 0.8539
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.4644 - accuracy: 0.8572
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4571 - accuracy: 0.8612
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4497 - accuracy: 0.8636
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4438 - accuracy: 0.8648
10000/10000 [==============================] - 4s 379us/step - loss: 0.4424 - accuracy: 0.8652 - val_loss: 0.5921 - val_accuracy: 0.8268
Latency --- 19.37008762359619 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 9
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_8/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3177 - accuracy: 0.1120
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.2975 - accuracy: 0.1520
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2819 - accuracy: 0.2087
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2677 - accuracy: 0.2365
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.2534 - accuracy: 0.2572
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2494 - accuracy: 0.2337
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2468 - accuracy: 0.2151
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2392 - accuracy: 0.2083
 4500/10000 [============>.................] - ETA: 2s - loss: 2.2274 - accuracy: 0.2007
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.2082 - accuracy: 0.2128
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.1970 - accuracy: 0.2240
 6000/10000 [=================>............] - ETA: 1s - loss: 2.1947 - accuracy: 0.2277
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.1795 - accuracy: 0.2351
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1483 - accuracy: 0.2500
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1390 - accuracy: 0.2545
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1420 - accuracy: 0.2539
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.1400 - accuracy: 0.2607
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.1288 - accuracy: 0.2678
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.1131 - accuracy: 0.2724
10000/10000 [==============================] - 4s 393us/step - loss: 2.1219 - accuracy: 0.2755 - val_loss: 1.9854 - val_accuracy: 0.2412
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.9656 - accuracy: 0.2700
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.7906 - accuracy: 0.4190
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.5921 - accuracy: 0.5067
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.4446 - accuracy: 0.5520
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.7154 - accuracy: 0.4752
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.0461 - accuracy: 0.4503
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.0879 - accuracy: 0.4057
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.1076 - accuracy: 0.3770
 4500/10000 [============>.................] - ETA: 2s - loss: 2.1174 - accuracy: 0.3618
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.1227 - accuracy: 0.3536
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.1182 - accuracy: 0.3607
 6000/10000 [=================>............] - ETA: 1s - loss: 2.1084 - accuracy: 0.3658
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.1108 - accuracy: 0.3526
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.0968 - accuracy: 0.3579
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.0736 - accuracy: 0.3663
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.0375 - accuracy: 0.3783
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0296 - accuracy: 0.3740
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0295 - accuracy: 0.3710
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0253 - accuracy: 0.3633
10000/10000 [==============================] - 4s 377us/step - loss: 2.0086 - accuracy: 0.3702 - val_loss: 1.3621 - val_accuracy: 0.5488
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.3006 - accuracy: 0.6080
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.2325 - accuracy: 0.6210
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.1313 - accuracy: 0.6513
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.1047 - accuracy: 0.6460
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.2935 - accuracy: 0.5944
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.3550 - accuracy: 0.5680
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.4186 - accuracy: 0.5349
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.4410 - accuracy: 0.5257
 4500/10000 [============>.................] - ETA: 2s - loss: 1.4119 - accuracy: 0.5378
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.3684 - accuracy: 0.5508
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.3335 - accuracy: 0.5618
 6000/10000 [=================>............] - ETA: 1s - loss: 1.2927 - accuracy: 0.5802
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.2618 - accuracy: 0.5892
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.2192 - accuracy: 0.6054
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.1770 - accuracy: 0.6193
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.1392 - accuracy: 0.6316
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.1073 - accuracy: 0.6422
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.0781 - accuracy: 0.6523
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.0536 - accuracy: 0.6598
10000/10000 [==============================] - 4s 380us/step - loss: 1.0342 - accuracy: 0.6667 - val_loss: 0.9166 - val_accuracy: 0.6956
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.7865 - accuracy: 0.7520
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.8888 - accuracy: 0.7490
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.7578 - accuracy: 0.7947
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.6740 - accuracy: 0.8190
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.6085 - accuracy: 0.8344
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.5664 - accuracy: 0.8437
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.5355 - accuracy: 0.8474
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.5183 - accuracy: 0.8518
 4500/10000 [============>.................] - ETA: 2s - loss: 0.5322 - accuracy: 0.8438
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.5376 - accuracy: 0.8412
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.5565 - accuracy: 0.8336
 6000/10000 [=================>............] - ETA: 1s - loss: 0.5456 - accuracy: 0.8377
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.5380 - accuracy: 0.8395
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5294 - accuracy: 0.8411
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.5171 - accuracy: 0.8453
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.5077 - accuracy: 0.8469
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4961 - accuracy: 0.8499
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4853 - accuracy: 0.8533
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4815 - accuracy: 0.8536
10000/10000 [==============================] - 4s 380us/step - loss: 0.4736 - accuracy: 0.8563 - val_loss: 0.4539 - val_accuracy: 0.8412
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.2983 - accuracy: 0.8980
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.2946 - accuracy: 0.9040
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.2858 - accuracy: 0.9113
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.2693 - accuracy: 0.9180
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.2620 - accuracy: 0.9192
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.2761 - accuracy: 0.9160
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.2828 - accuracy: 0.9143
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.2936 - accuracy: 0.9122
 4500/10000 [============>.................] - ETA: 2s - loss: 0.2888 - accuracy: 0.9142
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.2878 - accuracy: 0.9134
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.2922 - accuracy: 0.9144
 6000/10000 [=================>............] - ETA: 1s - loss: 0.2974 - accuracy: 0.9123
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.2966 - accuracy: 0.9112
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2942 - accuracy: 0.9127
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2907 - accuracy: 0.9136
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.2883 - accuracy: 0.9150
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2857 - accuracy: 0.9159
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2800 - accuracy: 0.9174
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2743 - accuracy: 0.9192
10000/10000 [==============================] - 4s 380us/step - loss: 0.2723 - accuracy: 0.9204 - val_loss: 0.2710 - val_accuracy: 0.9120
Latency --- 19.480454444885254 seconds ---
Trained with vanilla non-private SGD optimizer
=====================Iteration========================== 10
For delta=0.000100, the current epsilon is: 10.6490
Noise Mutiplier 0.645
in grads Tensor("loss_9/mul:0", shape=(), dtype=float32)
Train on 10000 samples, validate on 2500 samples
Epoch 1/5

  500/10000 [>.............................] - ETA: 4s - loss: 2.3136 - accuracy: 0.0800
 1000/10000 [==>...........................] - ETA: 3s - loss: 2.2983 - accuracy: 0.1090
 1500/10000 [===>..........................] - ETA: 3s - loss: 2.2842 - accuracy: 0.1167
 2000/10000 [=====>........................] - ETA: 3s - loss: 2.2762 - accuracy: 0.1140
 2500/10000 [======>.......................] - ETA: 2s - loss: 2.2686 - accuracy: 0.1172
 3000/10000 [========>.....................] - ETA: 2s - loss: 2.2530 - accuracy: 0.1337
 3500/10000 [=========>....................] - ETA: 2s - loss: 2.2303 - accuracy: 0.1783
 4000/10000 [===========>..................] - ETA: 2s - loss: 2.2056 - accuracy: 0.1990
 4500/10000 [============>.................] - ETA: 2s - loss: 2.1989 - accuracy: 0.1973
 5000/10000 [==============>...............] - ETA: 1s - loss: 2.1960 - accuracy: 0.1980
 5500/10000 [===============>..............] - ETA: 1s - loss: 2.1924 - accuracy: 0.1942
 6000/10000 [=================>............] - ETA: 1s - loss: 2.1742 - accuracy: 0.2110
 6500/10000 [==================>...........] - ETA: 1s - loss: 2.1463 - accuracy: 0.2258
 7000/10000 [====================>.........] - ETA: 1s - loss: 2.1354 - accuracy: 0.2243
 7500/10000 [=====================>........] - ETA: 0s - loss: 2.1299 - accuracy: 0.2176
 8000/10000 [=======================>......] - ETA: 0s - loss: 2.1170 - accuracy: 0.2288
 8500/10000 [========================>.....] - ETA: 0s - loss: 2.0948 - accuracy: 0.2371
 9000/10000 [==========================>...] - ETA: 0s - loss: 2.0960 - accuracy: 0.2347
 9500/10000 [===========================>..] - ETA: 0s - loss: 2.0981 - accuracy: 0.2360
10000/10000 [==============================] - 4s 391us/step - loss: 2.0940 - accuracy: 0.2440 - val_loss: 1.6963 - val_accuracy: 0.4860
Epoch 2/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.6998 - accuracy: 0.5040
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.5288 - accuracy: 0.5300
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.4328 - accuracy: 0.5520
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.8301 - accuracy: 0.4830
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.8734 - accuracy: 0.4444
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.8815 - accuracy: 0.4247
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.8792 - accuracy: 0.4091
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.8457 - accuracy: 0.4155
 4500/10000 [============>.................] - ETA: 2s - loss: 1.8463 - accuracy: 0.4133
 5000/10000 [==============>...............] - ETA: 1s - loss: 1.8393 - accuracy: 0.4038
 5500/10000 [===============>..............] - ETA: 1s - loss: 1.8165 - accuracy: 0.4095
 6000/10000 [=================>............] - ETA: 1s - loss: 1.7735 - accuracy: 0.4205
 6500/10000 [==================>...........] - ETA: 1s - loss: 1.7287 - accuracy: 0.4377
 7000/10000 [====================>.........] - ETA: 1s - loss: 1.6998 - accuracy: 0.4427
 7500/10000 [=====================>........] - ETA: 0s - loss: 1.7274 - accuracy: 0.4421
 8000/10000 [=======================>......] - ETA: 0s - loss: 1.7400 - accuracy: 0.4444
 8500/10000 [========================>.....] - ETA: 0s - loss: 1.7293 - accuracy: 0.4507
 9000/10000 [==========================>...] - ETA: 0s - loss: 1.7105 - accuracy: 0.4589
 9500/10000 [===========================>..] - ETA: 0s - loss: 1.6850 - accuracy: 0.4641
10000/10000 [==============================] - 4s 378us/step - loss: 1.6699 - accuracy: 0.4635 - val_loss: 1.5048 - val_accuracy: 0.4972
Epoch 3/5

  500/10000 [>.............................] - ETA: 3s - loss: 1.4741 - accuracy: 0.5040
 1000/10000 [==>...........................] - ETA: 3s - loss: 1.3142 - accuracy: 0.5940
 1500/10000 [===>..........................] - ETA: 3s - loss: 1.2019 - accuracy: 0.6460
 2000/10000 [=====>........................] - ETA: 2s - loss: 1.1282 - accuracy: 0.6715
 2500/10000 [======>.......................] - ETA: 2s - loss: 1.0767 - accuracy: 0.6780
 3000/10000 [========>.....................] - ETA: 2s - loss: 1.0710 - accuracy: 0.6837
 3500/10000 [=========>....................] - ETA: 2s - loss: 1.0427 - accuracy: 0.6817
 4000/10000 [===========>..................] - ETA: 2s - loss: 1.0210 - accuracy: 0.6898
 4500/10000 [============>.................] - ETA: 2s - loss: 0.9972 - accuracy: 0.7002
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.9604 - accuracy: 0.7140
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.9459 - accuracy: 0.7196
 6000/10000 [=================>............] - ETA: 1s - loss: 0.9324 - accuracy: 0.7232
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.9210 - accuracy: 0.7286
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.8930 - accuracy: 0.7373
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.8606 - accuracy: 0.7464
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.8377 - accuracy: 0.7523
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.8427 - accuracy: 0.7516
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.8558 - accuracy: 0.7477
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.8470 - accuracy: 0.7516
10000/10000 [==============================] - 4s 381us/step - loss: 0.8269 - accuracy: 0.7591 - val_loss: 0.5011 - val_accuracy: 0.8664
Epoch 4/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.4296 - accuracy: 0.8980
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.4082 - accuracy: 0.8920
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3714 - accuracy: 0.9033
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3972 - accuracy: 0.8965
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.4299 - accuracy: 0.8816
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.5616 - accuracy: 0.8530
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.6418 - accuracy: 0.8171
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.6443 - accuracy: 0.8177
 4500/10000 [============>.................] - ETA: 2s - loss: 0.6325 - accuracy: 0.8187
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.6114 - accuracy: 0.8238
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.5941 - accuracy: 0.8293
 6000/10000 [=================>............] - ETA: 1s - loss: 0.5712 - accuracy: 0.8352
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.5493 - accuracy: 0.8426
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.5338 - accuracy: 0.8466
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.5238 - accuracy: 0.8493
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.5108 - accuracy: 0.8520
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.4973 - accuracy: 0.8553
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.4869 - accuracy: 0.8574
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.4794 - accuracy: 0.8599
10000/10000 [==============================] - 4s 380us/step - loss: 0.4743 - accuracy: 0.8621 - val_loss: 0.4810 - val_accuracy: 0.8468
Epoch 5/5

  500/10000 [>.............................] - ETA: 3s - loss: 0.3886 - accuracy: 0.8740
 1000/10000 [==>...........................] - ETA: 3s - loss: 0.3595 - accuracy: 0.8840
 1500/10000 [===>..........................] - ETA: 3s - loss: 0.3489 - accuracy: 0.8880
 2000/10000 [=====>........................] - ETA: 2s - loss: 0.3502 - accuracy: 0.8885
 2500/10000 [======>.......................] - ETA: 2s - loss: 0.3306 - accuracy: 0.8984
 3000/10000 [========>.....................] - ETA: 2s - loss: 0.3096 - accuracy: 0.9060
 3500/10000 [=========>....................] - ETA: 2s - loss: 0.2972 - accuracy: 0.9103
 4000/10000 [===========>..................] - ETA: 2s - loss: 0.2887 - accuracy: 0.9120
 4500/10000 [============>.................] - ETA: 2s - loss: 0.2905 - accuracy: 0.9124
 5000/10000 [==============>...............] - ETA: 1s - loss: 0.2951 - accuracy: 0.9120
 5500/10000 [===============>..............] - ETA: 1s - loss: 0.2904 - accuracy: 0.9125
 6000/10000 [=================>............] - ETA: 1s - loss: 0.2819 - accuracy: 0.9152
 6500/10000 [==================>...........] - ETA: 1s - loss: 0.2766 - accuracy: 0.9163
 7000/10000 [====================>.........] - ETA: 1s - loss: 0.2760 - accuracy: 0.9169
 7500/10000 [=====================>........] - ETA: 0s - loss: 0.2701 - accuracy: 0.9188
 8000/10000 [=======================>......] - ETA: 0s - loss: 0.2695 - accuracy: 0.9189
 8500/10000 [========================>.....] - ETA: 0s - loss: 0.2728 - accuracy: 0.9189
 9000/10000 [==========================>...] - ETA: 0s - loss: 0.2749 - accuracy: 0.9183
 9500/10000 [===========================>..] - ETA: 0s - loss: 0.2753 - accuracy: 0.9186
10000/10000 [==============================] - 4s 381us/step - loss: 0.2769 - accuracy: 0.9174 - val_loss: 0.3266 - val_accuracy: 0.8960
Latency --- 19.514397859573364 seconds ---
Trained with vanilla non-private SGD optimizer
